(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();function Jp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Z0={exports:{}},Yl={},em={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ka=Symbol.for("react.element"),Zp=Symbol.for("react.portal"),eh=Symbol.for("react.fragment"),th=Symbol.for("react.strict_mode"),sh=Symbol.for("react.profiler"),rh=Symbol.for("react.provider"),nh=Symbol.for("react.context"),ah=Symbol.for("react.forward_ref"),lh=Symbol.for("react.suspense"),ih=Symbol.for("react.memo"),oh=Symbol.for("react.lazy"),gu=Symbol.iterator;function ch(e){return e===null||typeof e!="object"?null:(e=gu&&e[gu]||e["@@iterator"],typeof e=="function"?e:null)}var tm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},sm=Object.assign,rm={};function Nn(e,s,r){this.props=e,this.context=s,this.refs=rm,this.updater=r||tm}Nn.prototype.isReactComponent={};Nn.prototype.setState=function(e,s){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,s,"setState")};Nn.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function nm(){}nm.prototype=Nn.prototype;function ac(e,s,r){this.props=e,this.context=s,this.refs=rm,this.updater=r||tm}var lc=ac.prototype=new nm;lc.constructor=ac;sm(lc,Nn.prototype);lc.isPureReactComponent=!0;var fu=Array.isArray,am=Object.prototype.hasOwnProperty,ic={current:null},lm={key:!0,ref:!0,__self:!0,__source:!0};function im(e,s,r){var n,a={},l=null,i=null;if(s!=null)for(n in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(l=""+s.key),s)am.call(s,n)&&!lm.hasOwnProperty(n)&&(a[n]=s[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var d=Array(o),c=0;c<o;c++)d[c]=arguments[c+2];a.children=d}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:ka,type:e,key:l,ref:i,props:a,_owner:ic.current}}function dh(e,s){return{$$typeof:ka,type:e.type,key:s,ref:e.ref,props:e.props,_owner:e._owner}}function oc(e){return typeof e=="object"&&e!==null&&e.$$typeof===ka}function uh(e){var s={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return s[r]})}var yu=/\/+/g;function ji(e,s){return typeof e=="object"&&e!==null&&e.key!=null?uh(""+e.key):s.toString(36)}function rl(e,s,r,n,a){var l=typeof e;(l==="undefined"||l==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ka:case Zp:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+ji(i,0):n,fu(a)?(r="",e!=null&&(r=e.replace(yu,"$&/")+"/"),rl(a,s,r,"",function(c){return c})):a!=null&&(oc(a)&&(a=dh(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(yu,"$&/")+"/")+e)),s.push(a)),1;if(i=0,n=n===""?".":n+":",fu(e))for(var o=0;o<e.length;o++){l=e[o];var d=n+ji(l,o);i+=rl(l,s,r,d,a)}else if(d=ch(e),typeof d=="function")for(e=d.call(e),o=0;!(l=e.next()).done;)l=l.value,d=n+ji(l,o++),i+=rl(l,s,r,d,a);else if(l==="object")throw s=String(e),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function Da(e,s,r){if(e==null)return e;var n=[],a=0;return rl(e,n,"","",function(l){return s.call(r,l,a++)}),n}function mh(e){if(e._status===-1){var s=e._result;s=s(),s.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=s)}if(e._status===1)return e._result.default;throw e._result}var wt={current:null},nl={transition:null},xh={ReactCurrentDispatcher:wt,ReactCurrentBatchConfig:nl,ReactCurrentOwner:ic};function om(){throw Error("act(...) is not supported in production builds of React.")}ye.Children={map:Da,forEach:function(e,s,r){Da(e,function(){s.apply(this,arguments)},r)},count:function(e){var s=0;return Da(e,function(){s++}),s},toArray:function(e){return Da(e,function(s){return s})||[]},only:function(e){if(!oc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ye.Component=Nn;ye.Fragment=eh;ye.Profiler=sh;ye.PureComponent=ac;ye.StrictMode=th;ye.Suspense=lh;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xh;ye.act=om;ye.cloneElement=function(e,s,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=sm({},e.props),a=e.key,l=e.ref,i=e._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,i=ic.current),s.key!==void 0&&(a=""+s.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(d in s)am.call(s,d)&&!lm.hasOwnProperty(d)&&(n[d]=s[d]===void 0&&o!==void 0?o[d]:s[d])}var d=arguments.length-2;if(d===1)n.children=r;else if(1<d){o=Array(d);for(var c=0;c<d;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:ka,type:e.type,key:a,ref:l,props:n,_owner:i}};ye.createContext=function(e){return e={$$typeof:nh,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rh,_context:e},e.Consumer=e};ye.createElement=im;ye.createFactory=function(e){var s=im.bind(null,e);return s.type=e,s};ye.createRef=function(){return{current:null}};ye.forwardRef=function(e){return{$$typeof:ah,render:e}};ye.isValidElement=oc;ye.lazy=function(e){return{$$typeof:oh,_payload:{_status:-1,_result:e},_init:mh}};ye.memo=function(e,s){return{$$typeof:ih,type:e,compare:s===void 0?null:s}};ye.startTransition=function(e){var s=nl.transition;nl.transition={};try{e()}finally{nl.transition=s}};ye.unstable_act=om;ye.useCallback=function(e,s){return wt.current.useCallback(e,s)};ye.useContext=function(e){return wt.current.useContext(e)};ye.useDebugValue=function(){};ye.useDeferredValue=function(e){return wt.current.useDeferredValue(e)};ye.useEffect=function(e,s){return wt.current.useEffect(e,s)};ye.useId=function(){return wt.current.useId()};ye.useImperativeHandle=function(e,s,r){return wt.current.useImperativeHandle(e,s,r)};ye.useInsertionEffect=function(e,s){return wt.current.useInsertionEffect(e,s)};ye.useLayoutEffect=function(e,s){return wt.current.useLayoutEffect(e,s)};ye.useMemo=function(e,s){return wt.current.useMemo(e,s)};ye.useReducer=function(e,s,r){return wt.current.useReducer(e,s,r)};ye.useRef=function(e){return wt.current.useRef(e)};ye.useState=function(e){return wt.current.useState(e)};ye.useSyncExternalStore=function(e,s,r){return wt.current.useSyncExternalStore(e,s,r)};ye.useTransition=function(){return wt.current.useTransition()};ye.version="18.3.1";em.exports=ye;var k=em.exports;const bs=Jp(k);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ph=k,hh=Symbol.for("react.element"),gh=Symbol.for("react.fragment"),fh=Object.prototype.hasOwnProperty,yh=ph.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bh={key:!0,ref:!0,__self:!0,__source:!0};function cm(e,s,r){var n,a={},l=null,i=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(i=s.ref);for(n in s)fh.call(s,n)&&!bh.hasOwnProperty(n)&&(a[n]=s[n]);if(e&&e.defaultProps)for(n in s=e.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:hh,type:e,key:l,ref:i,props:a,_owner:yh.current}}Yl.Fragment=gh;Yl.jsx=cm;Yl.jsxs=cm;Z0.exports=Yl;var t=Z0.exports,Zi={},dm={exports:{}},Bt={},um={exports:{}},mm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function s(_,I){var E=_.length;_.push(I);e:for(;0<E;){var F=E-1>>>1,J=_[F];if(0<a(J,I))_[F]=I,_[E]=J,E=F;else break e}}function r(_){return _.length===0?null:_[0]}function n(_){if(_.length===0)return null;var I=_[0],E=_.pop();if(E!==I){_[0]=E;e:for(var F=0,J=_.length,R=J>>>1;F<R;){var A=2*(F+1)-1,D=_[A],q=A+1,T=_[q];if(0>a(D,E))q<J&&0>a(T,D)?(_[F]=T,_[q]=E,F=q):(_[F]=D,_[A]=E,F=A);else if(q<J&&0>a(T,E))_[F]=T,_[q]=E,F=q;else break e}}return I}function a(_,I){var E=_.sortIndex-I.sortIndex;return E!==0?E:_.id-I.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var d=[],c=[],u=1,h=null,b=3,w=!1,f=!1,y=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(_){for(var I=r(c);I!==null;){if(I.callback===null)n(c);else if(I.startTime<=_)n(c),I.sortIndex=I.expirationTime,s(d,I);else break;I=r(c)}}function N(_){if(y=!1,x(_),!f)if(r(d)!==null)f=!0,se(j);else{var I=r(c);I!==null&&ke(N,I.startTime-_)}}function j(_,I){f=!1,y&&(y=!1,g(P),P=-1),w=!0;var E=b;try{for(x(I),h=r(d);h!==null&&(!(h.expirationTime>I)||_&&!B());){var F=h.callback;if(typeof F=="function"){h.callback=null,b=h.priorityLevel;var J=F(h.expirationTime<=I);I=e.unstable_now(),typeof J=="function"?h.callback=J:h===r(d)&&n(d),x(I)}else n(d);h=r(d)}if(h!==null)var R=!0;else{var A=r(c);A!==null&&ke(N,A.startTime-I),R=!1}return R}finally{h=null,b=E,w=!1}}var S=!1,C=null,P=-1,$=5,z=-1;function B(){return!(e.unstable_now()-z<$)}function de(){if(C!==null){var _=e.unstable_now();z=_;var I=!0;try{I=C(!0,_)}finally{I?xe():(S=!1,C=null)}}else S=!1}var xe;if(typeof p=="function")xe=function(){p(de)};else if(typeof MessageChannel<"u"){var be=new MessageChannel,ue=be.port2;be.port1.onmessage=de,xe=function(){ue.postMessage(null)}}else xe=function(){v(de,0)};function se(_){C=_,S||(S=!0,xe())}function ke(_,I){P=v(function(){_(e.unstable_now())},I)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(_){_.callback=null},e.unstable_continueExecution=function(){f||w||(f=!0,se(j))},e.unstable_forceFrameRate=function(_){0>_||125<_?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<_?Math.floor(1e3/_):5},e.unstable_getCurrentPriorityLevel=function(){return b},e.unstable_getFirstCallbackNode=function(){return r(d)},e.unstable_next=function(_){switch(b){case 1:case 2:case 3:var I=3;break;default:I=b}var E=b;b=I;try{return _()}finally{b=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(_,I){switch(_){case 1:case 2:case 3:case 4:case 5:break;default:_=3}var E=b;b=_;try{return I()}finally{b=E}},e.unstable_scheduleCallback=function(_,I,E){var F=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?F+E:F):E=F,_){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=E+J,_={id:u++,callback:I,priorityLevel:_,startTime:E,expirationTime:J,sortIndex:-1},E>F?(_.sortIndex=E,s(c,_),r(d)===null&&_===r(c)&&(y?(g(P),P=-1):y=!0,ke(N,E-F))):(_.sortIndex=J,s(d,_),f||w||(f=!0,se(j))),_},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(_){var I=b;return function(){var E=b;b=I;try{return _.apply(this,arguments)}finally{b=E}}}})(mm);um.exports=mm;var jh=um.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh=k,Ft=jh;function U(e){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var xm=new Set,oa={};function Vr(e,s){mn(e,s),mn(e+"Capture",s)}function mn(e,s){for(oa[e]=s,e=0;e<s.length;e++)xm.add(s[e])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),eo=Object.prototype.hasOwnProperty,Nh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bu={},ju={};function wh(e){return eo.call(ju,e)?!0:eo.call(bu,e)?!1:Nh.test(e)?ju[e]=!0:(bu[e]=!0,!1)}function _h(e,s,r,n){if(r!==null&&r.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kh(e,s,r,n){if(s===null||typeof s>"u"||_h(e,s,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function _t(e,s,r,n,a,l,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=s,this.sanitizeURL=l,this.removeEmptyString=i}var dt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){dt[e]=new _t(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var s=e[0];dt[s]=new _t(s,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){dt[e]=new _t(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){dt[e]=new _t(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){dt[e]=new _t(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){dt[e]=new _t(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){dt[e]=new _t(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){dt[e]=new _t(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){dt[e]=new _t(e,5,!1,e.toLowerCase(),null,!1,!1)});var cc=/[\-:]([a-z])/g;function dc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var s=e.replace(cc,dc);dt[s]=new _t(s,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var s=e.replace(cc,dc);dt[s]=new _t(s,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var s=e.replace(cc,dc);dt[s]=new _t(s,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){dt[e]=new _t(e,1,!1,e.toLowerCase(),null,!1,!1)});dt.xlinkHref=new _t("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){dt[e]=new _t(e,1,!1,e.toLowerCase(),null,!0,!0)});function uc(e,s,r,n){var a=dt.hasOwnProperty(s)?dt[s]:null;(a!==null?a.type!==0:n||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(kh(s,r,a,n)&&(r=null),n||a===null?wh(s)&&(r===null?e.removeAttribute(s):e.setAttribute(s,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(s=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(s):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,s,r):e.setAttribute(s,r))))}var Is=vh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ia=Symbol.for("react.element"),Kr=Symbol.for("react.portal"),Qr=Symbol.for("react.fragment"),mc=Symbol.for("react.strict_mode"),to=Symbol.for("react.profiler"),pm=Symbol.for("react.provider"),hm=Symbol.for("react.context"),xc=Symbol.for("react.forward_ref"),so=Symbol.for("react.suspense"),ro=Symbol.for("react.suspense_list"),pc=Symbol.for("react.memo"),er=Symbol.for("react.lazy"),gm=Symbol.for("react.offscreen"),vu=Symbol.iterator;function Un(e){return e===null||typeof e!="object"?null:(e=vu&&e[vu]||e["@@iterator"],typeof e=="function"?e:null)}var Be=Object.assign,vi;function Gn(e){if(vi===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);vi=s&&s[1]||""}return`
`+vi+e}var Ni=!1;function wi(e,s){if(!e||Ni)return"";Ni=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(c){var n=c}Reflect.construct(e,[],s)}else{try{s.call()}catch(c){n=c}e.call(s.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),l=n.stack.split(`
`),i=a.length-1,o=l.length-1;1<=i&&0<=o&&a[i]!==l[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==l[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==l[o]){var d=`
`+a[i].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=i&&0<=o);break}}}finally{Ni=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Gn(e):""}function Sh(e){switch(e.tag){case 5:return Gn(e.type);case 16:return Gn("Lazy");case 13:return Gn("Suspense");case 19:return Gn("SuspenseList");case 0:case 2:case 15:return e=wi(e.type,!1),e;case 11:return e=wi(e.type.render,!1),e;case 1:return e=wi(e.type,!0),e;default:return""}}function no(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Qr:return"Fragment";case Kr:return"Portal";case to:return"Profiler";case mc:return"StrictMode";case so:return"Suspense";case ro:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case hm:return(e.displayName||"Context")+".Consumer";case pm:return(e._context.displayName||"Context")+".Provider";case xc:var s=e.render;return e=e.displayName,e||(e=s.displayName||s.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case pc:return s=e.displayName||null,s!==null?s:no(e.type)||"Memo";case er:s=e._payload,e=e._init;try{return no(e(s))}catch{}}return null}function Ch(e){var s=e.type;switch(e.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=s.render,e=e.displayName||e.name||"",s.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return no(s);case 8:return s===mc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function gr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function fm(e){var s=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Eh(e){var s=fm(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,s),n=""+e[s];if(!e.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(e,s,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,l.call(this,i)}}),Object.defineProperty(e,s,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[s]}}}}function Oa(e){e._valueTracker||(e._valueTracker=Eh(e))}function ym(e){if(!e)return!1;var s=e._valueTracker;if(!s)return!0;var r=s.getValue(),n="";return e&&(n=fm(e)?e.checked?"true":"false":e.value),e=n,e!==r?(s.setValue(e),!0):!1}function Nl(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function ao(e,s){var r=s.checked;return Be({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Nu(e,s){var r=s.defaultValue==null?"":s.defaultValue,n=s.checked!=null?s.checked:s.defaultChecked;r=gr(s.value!=null?s.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function bm(e,s){s=s.checked,s!=null&&uc(e,"checked",s,!1)}function lo(e,s){bm(e,s);var r=gr(s.value),n=s.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}s.hasOwnProperty("value")?io(e,s.type,r):s.hasOwnProperty("defaultValue")&&io(e,s.type,gr(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(e.defaultChecked=!!s.defaultChecked)}function wu(e,s,r){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var n=s.type;if(!(n!=="submit"&&n!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+e._wrapperState.initialValue,r||s===e.value||(e.value=s),e.defaultValue=s}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function io(e,s,r){(s!=="number"||Nl(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Xn=Array.isArray;function an(e,s,r,n){if(e=e.options,s){s={};for(var a=0;a<r.length;a++)s["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=s.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+gr(r),s=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}s!==null||e[a].disabled||(s=e[a])}s!==null&&(s.selected=!0)}}function oo(e,s){if(s.dangerouslySetInnerHTML!=null)throw Error(U(91));return Be({},s,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function _u(e,s){var r=s.value;if(r==null){if(r=s.children,s=s.defaultValue,r!=null){if(s!=null)throw Error(U(92));if(Xn(r)){if(1<r.length)throw Error(U(93));r=r[0]}s=r}s==null&&(s=""),r=s}e._wrapperState={initialValue:gr(r)}}function jm(e,s){var r=gr(s.value),n=gr(s.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),s.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function ku(e){var s=e.textContent;s===e._wrapperState.initialValue&&s!==""&&s!==null&&(e.value=s)}function vm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function co(e,s){return e==null||e==="http://www.w3.org/1999/xhtml"?vm(s):e==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var za,Nm=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(s,r,n,a)})}:e}(function(e,s){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=s;else{for(za=za||document.createElement("div"),za.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=za.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;s.firstChild;)e.appendChild(s.firstChild)}});function ca(e,s){if(s){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=s;return}}e.textContent=s}var Zn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Th=["Webkit","ms","Moz","O"];Object.keys(Zn).forEach(function(e){Th.forEach(function(s){s=s+e.charAt(0).toUpperCase()+e.substring(1),Zn[s]=Zn[e]})});function wm(e,s,r){return s==null||typeof s=="boolean"||s===""?"":r||typeof s!="number"||s===0||Zn.hasOwnProperty(e)&&Zn[e]?(""+s).trim():s+"px"}function _m(e,s){e=e.style;for(var r in s)if(s.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=wm(r,s[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var Ah=Be({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uo(e,s){if(s){if(Ah[e]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(U(137,e));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(U(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(U(61))}if(s.style!=null&&typeof s.style!="object")throw Error(U(62))}}function mo(e,s){if(e.indexOf("-")===-1)return typeof s.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xo=null;function hc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var po=null,ln=null,on=null;function Su(e){if(e=Ea(e)){if(typeof po!="function")throw Error(U(280));var s=e.stateNode;s&&(s=si(s),po(e.stateNode,e.type,s))}}function km(e){ln?on?on.push(e):on=[e]:ln=e}function Sm(){if(ln){var e=ln,s=on;if(on=ln=null,Su(e),s)for(e=0;e<s.length;e++)Su(s[e])}}function Cm(e,s){return e(s)}function Em(){}var _i=!1;function Tm(e,s,r){if(_i)return e(s,r);_i=!0;try{return Cm(e,s,r)}finally{_i=!1,(ln!==null||on!==null)&&(Em(),Sm())}}function da(e,s){var r=e.stateNode;if(r===null)return null;var n=si(r);if(n===null)return null;r=n[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(U(231,s,typeof r));return r}var ho=!1;if(Ls)try{var Fn={};Object.defineProperty(Fn,"passive",{get:function(){ho=!0}}),window.addEventListener("test",Fn,Fn),window.removeEventListener("test",Fn,Fn)}catch{ho=!1}function Rh(e,s,r,n,a,l,i,o,d){var c=Array.prototype.slice.call(arguments,3);try{s.apply(r,c)}catch(u){this.onError(u)}}var ea=!1,wl=null,_l=!1,go=null,Lh={onError:function(e){ea=!0,wl=e}};function Ph(e,s,r,n,a,l,i,o,d){ea=!1,wl=null,Rh.apply(Lh,arguments)}function Mh(e,s,r,n,a,l,i,o,d){if(Ph.apply(this,arguments),ea){if(ea){var c=wl;ea=!1,wl=null}else throw Error(U(198));_l||(_l=!0,go=c)}}function qr(e){var s=e,r=e;if(e.alternate)for(;s.return;)s=s.return;else{e=s;do s=e,s.flags&4098&&(r=s.return),e=s.return;while(e)}return s.tag===3?r:null}function Am(e){if(e.tag===13){var s=e.memoizedState;if(s===null&&(e=e.alternate,e!==null&&(s=e.memoizedState)),s!==null)return s.dehydrated}return null}function Cu(e){if(qr(e)!==e)throw Error(U(188))}function $h(e){var s=e.alternate;if(!s){if(s=qr(e),s===null)throw Error(U(188));return s!==e?null:e}for(var r=e,n=s;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return Cu(a),e;if(l===n)return Cu(a),s;l=l.sibling}throw Error(U(188))}if(r.return!==n.return)r=a,n=l;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=l;break}if(o===n){i=!0,n=a,r=l;break}o=o.sibling}if(!i){for(o=l.child;o;){if(o===r){i=!0,r=l,n=a;break}if(o===n){i=!0,n=l,r=a;break}o=o.sibling}if(!i)throw Error(U(189))}}if(r.alternate!==n)throw Error(U(190))}if(r.tag!==3)throw Error(U(188));return r.stateNode.current===r?e:s}function Rm(e){return e=$h(e),e!==null?Lm(e):null}function Lm(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var s=Lm(e);if(s!==null)return s;e=e.sibling}return null}var Pm=Ft.unstable_scheduleCallback,Eu=Ft.unstable_cancelCallback,Dh=Ft.unstable_shouldYield,Ih=Ft.unstable_requestPaint,qe=Ft.unstable_now,Oh=Ft.unstable_getCurrentPriorityLevel,gc=Ft.unstable_ImmediatePriority,Mm=Ft.unstable_UserBlockingPriority,kl=Ft.unstable_NormalPriority,zh=Ft.unstable_LowPriority,$m=Ft.unstable_IdlePriority,Jl=null,js=null;function Uh(e){if(js&&typeof js.onCommitFiberRoot=="function")try{js.onCommitFiberRoot(Jl,e,void 0,(e.current.flags&128)===128)}catch{}}var ls=Math.clz32?Math.clz32:Hh,Fh=Math.log,Bh=Math.LN2;function Hh(e){return e>>>=0,e===0?32:31-(Fh(e)/Bh|0)|0}var Ua=64,Fa=4194304;function Yn(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Sl(e,s){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,l=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Yn(o):(l&=i,l!==0&&(n=Yn(l)))}else i=r&~a,i!==0?n=Yn(i):l!==0&&(n=Yn(l));if(n===0)return 0;if(s!==0&&s!==n&&!(s&a)&&(a=n&-n,l=s&-s,a>=l||a===16&&(l&4194240)!==0))return s;if(n&4&&(n|=r&16),s=e.entangledLanes,s!==0)for(e=e.entanglements,s&=n;0<s;)r=31-ls(s),a=1<<r,n|=e[r],s&=~a;return n}function Vh(e,s){switch(e){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qh(e,s){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,l=e.pendingLanes;0<l;){var i=31-ls(l),o=1<<i,d=a[i];d===-1?(!(o&r)||o&n)&&(a[i]=Vh(o,s)):d<=s&&(e.expiredLanes|=o),l&=~o}}function fo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Dm(){var e=Ua;return Ua<<=1,!(Ua&4194240)&&(Ua=64),e}function ki(e){for(var s=[],r=0;31>r;r++)s.push(e);return s}function Sa(e,s,r){e.pendingLanes|=s,s!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,s=31-ls(s),e[s]=r}function Wh(e,s){var r=e.pendingLanes&~s;e.pendingLanes=s,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=s,e.mutableReadLanes&=s,e.entangledLanes&=s,s=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-ls(r),l=1<<a;s[a]=0,n[a]=-1,e[a]=-1,r&=~l}}function fc(e,s){var r=e.entangledLanes|=s;for(e=e.entanglements;r;){var n=31-ls(r),a=1<<n;a&s|e[n]&s&&(e[n]|=s),r&=~a}}var Te=0;function Im(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Om,yc,zm,Um,Fm,yo=!1,Ba=[],ir=null,or=null,cr=null,ua=new Map,ma=new Map,sr=[],Kh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Tu(e,s){switch(e){case"focusin":case"focusout":ir=null;break;case"dragenter":case"dragleave":or=null;break;case"mouseover":case"mouseout":cr=null;break;case"pointerover":case"pointerout":ua.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ma.delete(s.pointerId)}}function Bn(e,s,r,n,a,l){return e===null||e.nativeEvent!==l?(e={blockedOn:s,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},s!==null&&(s=Ea(s),s!==null&&yc(s)),e):(e.eventSystemFlags|=n,s=e.targetContainers,a!==null&&s.indexOf(a)===-1&&s.push(a),e)}function Qh(e,s,r,n,a){switch(s){case"focusin":return ir=Bn(ir,e,s,r,n,a),!0;case"dragenter":return or=Bn(or,e,s,r,n,a),!0;case"mouseover":return cr=Bn(cr,e,s,r,n,a),!0;case"pointerover":var l=a.pointerId;return ua.set(l,Bn(ua.get(l)||null,e,s,r,n,a)),!0;case"gotpointercapture":return l=a.pointerId,ma.set(l,Bn(ma.get(l)||null,e,s,r,n,a)),!0}return!1}function Bm(e){var s=Tr(e.target);if(s!==null){var r=qr(s);if(r!==null){if(s=r.tag,s===13){if(s=Am(r),s!==null){e.blockedOn=s,Fm(e.priority,function(){zm(r)});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function al(e){if(e.blockedOn!==null)return!1;for(var s=e.targetContainers;0<s.length;){var r=bo(e.domEventName,e.eventSystemFlags,s[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);xo=n,r.target.dispatchEvent(n),xo=null}else return s=Ea(r),s!==null&&yc(s),e.blockedOn=r,!1;s.shift()}return!0}function Au(e,s,r){al(e)&&r.delete(s)}function Gh(){yo=!1,ir!==null&&al(ir)&&(ir=null),or!==null&&al(or)&&(or=null),cr!==null&&al(cr)&&(cr=null),ua.forEach(Au),ma.forEach(Au)}function Hn(e,s){e.blockedOn===s&&(e.blockedOn=null,yo||(yo=!0,Ft.unstable_scheduleCallback(Ft.unstable_NormalPriority,Gh)))}function xa(e){function s(a){return Hn(a,e)}if(0<Ba.length){Hn(Ba[0],e);for(var r=1;r<Ba.length;r++){var n=Ba[r];n.blockedOn===e&&(n.blockedOn=null)}}for(ir!==null&&Hn(ir,e),or!==null&&Hn(or,e),cr!==null&&Hn(cr,e),ua.forEach(s),ma.forEach(s),r=0;r<sr.length;r++)n=sr[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<sr.length&&(r=sr[0],r.blockedOn===null);)Bm(r),r.blockedOn===null&&sr.shift()}var cn=Is.ReactCurrentBatchConfig,Cl=!0;function Xh(e,s,r,n){var a=Te,l=cn.transition;cn.transition=null;try{Te=1,bc(e,s,r,n)}finally{Te=a,cn.transition=l}}function Yh(e,s,r,n){var a=Te,l=cn.transition;cn.transition=null;try{Te=4,bc(e,s,r,n)}finally{Te=a,cn.transition=l}}function bc(e,s,r,n){if(Cl){var a=bo(e,s,r,n);if(a===null)$i(e,s,n,El,r),Tu(e,n);else if(Qh(a,e,s,r,n))n.stopPropagation();else if(Tu(e,n),s&4&&-1<Kh.indexOf(e)){for(;a!==null;){var l=Ea(a);if(l!==null&&Om(l),l=bo(e,s,r,n),l===null&&$i(e,s,n,El,r),l===a)break;a=l}a!==null&&n.stopPropagation()}else $i(e,s,n,null,r)}}var El=null;function bo(e,s,r,n){if(El=null,e=hc(n),e=Tr(e),e!==null)if(s=qr(e),s===null)e=null;else if(r=s.tag,r===13){if(e=Am(s),e!==null)return e;e=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;e=null}else s!==e&&(e=null);return El=e,null}function Hm(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Oh()){case gc:return 1;case Mm:return 4;case kl:case zh:return 16;case $m:return 536870912;default:return 16}default:return 16}}var ar=null,jc=null,ll=null;function Vm(){if(ll)return ll;var e,s=jc,r=s.length,n,a="value"in ar?ar.value:ar.textContent,l=a.length;for(e=0;e<r&&s[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&s[r-n]===a[l-n];n++);return ll=a.slice(e,1<n?1-n:void 0)}function il(e){var s=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&s===13&&(e=13)):e=s,e===10&&(e=13),32<=e||e===13?e:0}function Ha(){return!0}function Ru(){return!1}function Ht(e){function s(r,n,a,l,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(l):l[o]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?Ha:Ru,this.isPropagationStopped=Ru,this}return Be(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ha)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ha)},persist:function(){},isPersistent:Ha}),s}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vc=Ht(wn),Ca=Be({},wn,{view:0,detail:0}),Jh=Ht(Ca),Si,Ci,Vn,Zl=Be({},Ca,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Vn&&(Vn&&e.type==="mousemove"?(Si=e.screenX-Vn.screenX,Ci=e.screenY-Vn.screenY):Ci=Si=0,Vn=e),Si)},movementY:function(e){return"movementY"in e?e.movementY:Ci}}),Lu=Ht(Zl),Zh=Be({},Zl,{dataTransfer:0}),eg=Ht(Zh),tg=Be({},Ca,{relatedTarget:0}),Ei=Ht(tg),sg=Be({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),rg=Ht(sg),ng=Be({},wn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ag=Ht(ng),lg=Be({},wn,{data:0}),Pu=Ht(lg),ig={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},og={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dg(e){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(e):(e=cg[e])?!!s[e]:!1}function Nc(){return dg}var ug=Be({},Ca,{key:function(e){if(e.key){var s=ig[e.key]||e.key;if(s!=="Unidentified")return s}return e.type==="keypress"?(e=il(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?og[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nc,charCode:function(e){return e.type==="keypress"?il(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?il(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),mg=Ht(ug),xg=Be({},Zl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mu=Ht(xg),pg=Be({},Ca,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nc}),hg=Ht(pg),gg=Be({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),fg=Ht(gg),yg=Be({},Zl,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bg=Ht(yg),jg=[9,13,27,32],wc=Ls&&"CompositionEvent"in window,ta=null;Ls&&"documentMode"in document&&(ta=document.documentMode);var vg=Ls&&"TextEvent"in window&&!ta,qm=Ls&&(!wc||ta&&8<ta&&11>=ta),$u=" ",Du=!1;function Wm(e,s){switch(e){case"keyup":return jg.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Km(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gr=!1;function Ng(e,s){switch(e){case"compositionend":return Km(s);case"keypress":return s.which!==32?null:(Du=!0,$u);case"textInput":return e=s.data,e===$u&&Du?null:e;default:return null}}function wg(e,s){if(Gr)return e==="compositionend"||!wc&&Wm(e,s)?(e=Vm(),ll=jc=ar=null,Gr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return qm&&s.locale!=="ko"?null:s.data;default:return null}}var _g={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iu(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s==="input"?!!_g[e.type]:s==="textarea"}function Qm(e,s,r,n){km(n),s=Tl(s,"onChange"),0<s.length&&(r=new vc("onChange","change",null,r,n),e.push({event:r,listeners:s}))}var sa=null,pa=null;function kg(e){ax(e,0)}function ei(e){var s=Jr(e);if(ym(s))return e}function Sg(e,s){if(e==="change")return s}var Gm=!1;if(Ls){var Ti;if(Ls){var Ai="oninput"in document;if(!Ai){var Ou=document.createElement("div");Ou.setAttribute("oninput","return;"),Ai=typeof Ou.oninput=="function"}Ti=Ai}else Ti=!1;Gm=Ti&&(!document.documentMode||9<document.documentMode)}function zu(){sa&&(sa.detachEvent("onpropertychange",Xm),pa=sa=null)}function Xm(e){if(e.propertyName==="value"&&ei(pa)){var s=[];Qm(s,pa,e,hc(e)),Tm(kg,s)}}function Cg(e,s,r){e==="focusin"?(zu(),sa=s,pa=r,sa.attachEvent("onpropertychange",Xm)):e==="focusout"&&zu()}function Eg(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ei(pa)}function Tg(e,s){if(e==="click")return ei(s)}function Ag(e,s){if(e==="input"||e==="change")return ei(s)}function Rg(e,s){return e===s&&(e!==0||1/e===1/s)||e!==e&&s!==s}var cs=typeof Object.is=="function"?Object.is:Rg;function ha(e,s){if(cs(e,s))return!0;if(typeof e!="object"||e===null||typeof s!="object"||s===null)return!1;var r=Object.keys(e),n=Object.keys(s);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!eo.call(s,a)||!cs(e[a],s[a]))return!1}return!0}function Uu(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Fu(e,s){var r=Uu(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=s&&n>=s)return{node:r,offset:s-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Uu(r)}}function Ym(e,s){return e&&s?e===s?!0:e&&e.nodeType===3?!1:s&&s.nodeType===3?Ym(e,s.parentNode):"contains"in e?e.contains(s):e.compareDocumentPosition?!!(e.compareDocumentPosition(s)&16):!1:!1}function Jm(){for(var e=window,s=Nl();s instanceof e.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)e=s.contentWindow;else break;s=Nl(e.document)}return s}function _c(e){var s=e&&e.nodeName&&e.nodeName.toLowerCase();return s&&(s==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||s==="textarea"||e.contentEditable==="true")}function Lg(e){var s=Jm(),r=e.focusedElem,n=e.selectionRange;if(s!==r&&r&&r.ownerDocument&&Ym(r.ownerDocument.documentElement,r)){if(n!==null&&_c(r)){if(s=n.start,e=n.end,e===void 0&&(e=s),"selectionStart"in r)r.selectionStart=s,r.selectionEnd=Math.min(e,r.value.length);else if(e=(s=r.ownerDocument||document)&&s.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,l=Math.min(n.start,a);n=n.end===void 0?l:Math.min(n.end,a),!e.extend&&l>n&&(a=n,n=l,l=a),a=Fu(r,l);var i=Fu(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(a.node,a.offset),e.removeAllRanges(),l>n?(e.addRange(s),e.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),e.addRange(s)))}}for(s=[],e=r;e=e.parentNode;)e.nodeType===1&&s.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<s.length;r++)e=s[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pg=Ls&&"documentMode"in document&&11>=document.documentMode,Xr=null,jo=null,ra=null,vo=!1;function Bu(e,s,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;vo||Xr==null||Xr!==Nl(n)||(n=Xr,"selectionStart"in n&&_c(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),ra&&ha(ra,n)||(ra=n,n=Tl(jo,"onSelect"),0<n.length&&(s=new vc("onSelect","select",null,s,r),e.push({event:s,listeners:n}),s.target=Xr)))}function Va(e,s){var r={};return r[e.toLowerCase()]=s.toLowerCase(),r["Webkit"+e]="webkit"+s,r["Moz"+e]="moz"+s,r}var Yr={animationend:Va("Animation","AnimationEnd"),animationiteration:Va("Animation","AnimationIteration"),animationstart:Va("Animation","AnimationStart"),transitionend:Va("Transition","TransitionEnd")},Ri={},Zm={};Ls&&(Zm=document.createElement("div").style,"AnimationEvent"in window||(delete Yr.animationend.animation,delete Yr.animationiteration.animation,delete Yr.animationstart.animation),"TransitionEvent"in window||delete Yr.transitionend.transition);function ti(e){if(Ri[e])return Ri[e];if(!Yr[e])return e;var s=Yr[e],r;for(r in s)if(s.hasOwnProperty(r)&&r in Zm)return Ri[e]=s[r];return e}var ex=ti("animationend"),tx=ti("animationiteration"),sx=ti("animationstart"),rx=ti("transitionend"),nx=new Map,Hu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function br(e,s){nx.set(e,s),Vr(s,[e])}for(var Li=0;Li<Hu.length;Li++){var Pi=Hu[Li],Mg=Pi.toLowerCase(),$g=Pi[0].toUpperCase()+Pi.slice(1);br(Mg,"on"+$g)}br(ex,"onAnimationEnd");br(tx,"onAnimationIteration");br(sx,"onAnimationStart");br("dblclick","onDoubleClick");br("focusin","onFocus");br("focusout","onBlur");br(rx,"onTransitionEnd");mn("onMouseEnter",["mouseout","mouseover"]);mn("onMouseLeave",["mouseout","mouseover"]);mn("onPointerEnter",["pointerout","pointerover"]);mn("onPointerLeave",["pointerout","pointerover"]);Vr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Vr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Vr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Vr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Vr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Vr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dg=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jn));function Vu(e,s,r){var n=e.type||"unknown-event";e.currentTarget=r,Mh(n,s,void 0,e),e.currentTarget=null}function ax(e,s){s=(s&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var l=void 0;if(s)for(var i=n.length-1;0<=i;i--){var o=n[i],d=o.instance,c=o.currentTarget;if(o=o.listener,d!==l&&a.isPropagationStopped())break e;Vu(a,o,c),l=d}else for(i=0;i<n.length;i++){if(o=n[i],d=o.instance,c=o.currentTarget,o=o.listener,d!==l&&a.isPropagationStopped())break e;Vu(a,o,c),l=d}}}if(_l)throw e=go,_l=!1,go=null,e}function $e(e,s){var r=s[So];r===void 0&&(r=s[So]=new Set);var n=e+"__bubble";r.has(n)||(lx(s,e,2,!1),r.add(n))}function Mi(e,s,r){var n=0;s&&(n|=4),lx(r,e,n,s)}var qa="_reactListening"+Math.random().toString(36).slice(2);function ga(e){if(!e[qa]){e[qa]=!0,xm.forEach(function(r){r!=="selectionchange"&&(Dg.has(r)||Mi(r,!1,e),Mi(r,!0,e))});var s=e.nodeType===9?e:e.ownerDocument;s===null||s[qa]||(s[qa]=!0,Mi("selectionchange",!1,s))}}function lx(e,s,r,n){switch(Hm(s)){case 1:var a=Xh;break;case 4:a=Yh;break;default:a=bc}r=a.bind(null,s,r,e),a=void 0,!ho||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(s,r,{capture:!0,passive:a}):e.addEventListener(s,r,!0):a!==void 0?e.addEventListener(s,r,{passive:a}):e.addEventListener(s,r,!1)}function $i(e,s,r,n,a){var l=n;if(!(s&1)&&!(s&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var d=i.tag;if((d===3||d===4)&&(d=i.stateNode.containerInfo,d===a||d.nodeType===8&&d.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Tr(o),i===null)return;if(d=i.tag,d===5||d===6){n=l=i;continue e}o=o.parentNode}}n=n.return}Tm(function(){var c=l,u=hc(r),h=[];e:{var b=nx.get(e);if(b!==void 0){var w=vc,f=e;switch(e){case"keypress":if(il(r)===0)break e;case"keydown":case"keyup":w=mg;break;case"focusin":f="focus",w=Ei;break;case"focusout":f="blur",w=Ei;break;case"beforeblur":case"afterblur":w=Ei;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=Lu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=eg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=hg;break;case ex:case tx:case sx:w=rg;break;case rx:w=fg;break;case"scroll":w=Jh;break;case"wheel":w=bg;break;case"copy":case"cut":case"paste":w=ag;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Mu}var y=(s&4)!==0,v=!y&&e==="scroll",g=y?b!==null?b+"Capture":null:b;y=[];for(var p=c,x;p!==null;){x=p;var N=x.stateNode;if(x.tag===5&&N!==null&&(x=N,g!==null&&(N=da(p,g),N!=null&&y.push(fa(p,N,x)))),v)break;p=p.return}0<y.length&&(b=new w(b,f,null,r,u),h.push({event:b,listeners:y}))}}if(!(s&7)){e:{if(b=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",b&&r!==xo&&(f=r.relatedTarget||r.fromElement)&&(Tr(f)||f[Ps]))break e;if((w||b)&&(b=u.window===u?u:(b=u.ownerDocument)?b.defaultView||b.parentWindow:window,w?(f=r.relatedTarget||r.toElement,w=c,f=f?Tr(f):null,f!==null&&(v=qr(f),f!==v||f.tag!==5&&f.tag!==6)&&(f=null)):(w=null,f=c),w!==f)){if(y=Lu,N="onMouseLeave",g="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(y=Mu,N="onPointerLeave",g="onPointerEnter",p="pointer"),v=w==null?b:Jr(w),x=f==null?b:Jr(f),b=new y(N,p+"leave",w,r,u),b.target=v,b.relatedTarget=x,N=null,Tr(u)===c&&(y=new y(g,p+"enter",f,r,u),y.target=x,y.relatedTarget=v,N=y),v=N,w&&f)t:{for(y=w,g=f,p=0,x=y;x;x=Wr(x))p++;for(x=0,N=g;N;N=Wr(N))x++;for(;0<p-x;)y=Wr(y),p--;for(;0<x-p;)g=Wr(g),x--;for(;p--;){if(y===g||g!==null&&y===g.alternate)break t;y=Wr(y),g=Wr(g)}y=null}else y=null;w!==null&&qu(h,b,w,y,!1),f!==null&&v!==null&&qu(h,v,f,y,!0)}}e:{if(b=c?Jr(c):window,w=b.nodeName&&b.nodeName.toLowerCase(),w==="select"||w==="input"&&b.type==="file")var j=Sg;else if(Iu(b))if(Gm)j=Ag;else{j=Eg;var S=Cg}else(w=b.nodeName)&&w.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(j=Tg);if(j&&(j=j(e,c))){Qm(h,j,r,u);break e}S&&S(e,b,c),e==="focusout"&&(S=b._wrapperState)&&S.controlled&&b.type==="number"&&io(b,"number",b.value)}switch(S=c?Jr(c):window,e){case"focusin":(Iu(S)||S.contentEditable==="true")&&(Xr=S,jo=c,ra=null);break;case"focusout":ra=jo=Xr=null;break;case"mousedown":vo=!0;break;case"contextmenu":case"mouseup":case"dragend":vo=!1,Bu(h,r,u);break;case"selectionchange":if(Pg)break;case"keydown":case"keyup":Bu(h,r,u)}var C;if(wc)e:{switch(e){case"compositionstart":var P="onCompositionStart";break e;case"compositionend":P="onCompositionEnd";break e;case"compositionupdate":P="onCompositionUpdate";break e}P=void 0}else Gr?Wm(e,r)&&(P="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(P="onCompositionStart");P&&(qm&&r.locale!=="ko"&&(Gr||P!=="onCompositionStart"?P==="onCompositionEnd"&&Gr&&(C=Vm()):(ar=u,jc="value"in ar?ar.value:ar.textContent,Gr=!0)),S=Tl(c,P),0<S.length&&(P=new Pu(P,e,null,r,u),h.push({event:P,listeners:S}),C?P.data=C:(C=Km(r),C!==null&&(P.data=C)))),(C=vg?Ng(e,r):wg(e,r))&&(c=Tl(c,"onBeforeInput"),0<c.length&&(u=new Pu("onBeforeInput","beforeinput",null,r,u),h.push({event:u,listeners:c}),u.data=C))}ax(h,s)})}function fa(e,s,r){return{instance:e,listener:s,currentTarget:r}}function Tl(e,s){for(var r=s+"Capture",n=[];e!==null;){var a=e,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=da(e,r),l!=null&&n.unshift(fa(e,l,a)),l=da(e,s),l!=null&&n.push(fa(e,l,a))),e=e.return}return n}function Wr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function qu(e,s,r,n,a){for(var l=s._reactName,i=[];r!==null&&r!==n;){var o=r,d=o.alternate,c=o.stateNode;if(d!==null&&d===n)break;o.tag===5&&c!==null&&(o=c,a?(d=da(r,l),d!=null&&i.unshift(fa(r,d,o))):a||(d=da(r,l),d!=null&&i.push(fa(r,d,o)))),r=r.return}i.length!==0&&e.push({event:s,listeners:i})}var Ig=/\r\n?/g,Og=/\u0000|\uFFFD/g;function Wu(e){return(typeof e=="string"?e:""+e).replace(Ig,`
`).replace(Og,"")}function Wa(e,s,r){if(s=Wu(s),Wu(e)!==s&&r)throw Error(U(425))}function Al(){}var No=null,wo=null;function _o(e,s){return e==="textarea"||e==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var ko=typeof setTimeout=="function"?setTimeout:void 0,zg=typeof clearTimeout=="function"?clearTimeout:void 0,Ku=typeof Promise=="function"?Promise:void 0,Ug=typeof queueMicrotask=="function"?queueMicrotask:typeof Ku<"u"?function(e){return Ku.resolve(null).then(e).catch(Fg)}:ko;function Fg(e){setTimeout(function(){throw e})}function Di(e,s){var r=s,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),xa(s);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);xa(s)}function dr(e){for(;e!=null;e=e.nextSibling){var s=e.nodeType;if(s===1||s===3)break;if(s===8){if(s=e.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return e}function Qu(e){e=e.previousSibling;for(var s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return e;s--}else r==="/$"&&s++}e=e.previousSibling}return null}var _n=Math.random().toString(36).slice(2),gs="__reactFiber$"+_n,ya="__reactProps$"+_n,Ps="__reactContainer$"+_n,So="__reactEvents$"+_n,Bg="__reactListeners$"+_n,Hg="__reactHandles$"+_n;function Tr(e){var s=e[gs];if(s)return s;for(var r=e.parentNode;r;){if(s=r[Ps]||r[gs]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(e=Qu(e);e!==null;){if(r=e[gs])return r;e=Qu(e)}return s}e=r,r=e.parentNode}return null}function Ea(e){return e=e[gs]||e[Ps],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(U(33))}function si(e){return e[ya]||null}var Co=[],Zr=-1;function jr(e){return{current:e}}function Oe(e){0>Zr||(e.current=Co[Zr],Co[Zr]=null,Zr--)}function Re(e,s){Zr++,Co[Zr]=e.current,e.current=s}var fr={},yt=jr(fr),Tt=jr(!1),Dr=fr;function xn(e,s){var r=e.type.contextTypes;if(!r)return fr;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===s)return n.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=s[l];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),a}function At(e){return e=e.childContextTypes,e!=null}function Rl(){Oe(Tt),Oe(yt)}function Gu(e,s,r){if(yt.current!==fr)throw Error(U(168));Re(yt,s),Re(Tt,r)}function ix(e,s,r){var n=e.stateNode;if(s=s.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in s))throw Error(U(108,Ch(e)||"Unknown",a));return Be({},r,n)}function Ll(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||fr,Dr=yt.current,Re(yt,e),Re(Tt,Tt.current),!0}function Xu(e,s,r){var n=e.stateNode;if(!n)throw Error(U(169));r?(e=ix(e,s,Dr),n.__reactInternalMemoizedMergedChildContext=e,Oe(Tt),Oe(yt),Re(yt,e)):Oe(Tt),Re(Tt,r)}var Ss=null,ri=!1,Ii=!1;function ox(e){Ss===null?Ss=[e]:Ss.push(e)}function Vg(e){ri=!0,ox(e)}function vr(){if(!Ii&&Ss!==null){Ii=!0;var e=0,s=Te;try{var r=Ss;for(Te=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Ss=null,ri=!1}catch(a){throw Ss!==null&&(Ss=Ss.slice(e+1)),Pm(gc,vr),a}finally{Te=s,Ii=!1}}return null}var en=[],tn=0,Pl=null,Ml=0,Wt=[],Kt=0,Ir=null,Cs=1,Es="";function Sr(e,s){en[tn++]=Ml,en[tn++]=Pl,Pl=e,Ml=s}function cx(e,s,r){Wt[Kt++]=Cs,Wt[Kt++]=Es,Wt[Kt++]=Ir,Ir=e;var n=Cs;e=Es;var a=32-ls(n)-1;n&=~(1<<a),r+=1;var l=32-ls(s)+a;if(30<l){var i=a-a%5;l=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Cs=1<<32-ls(s)+a|r<<a|n,Es=l+e}else Cs=1<<l|r<<a|n,Es=e}function kc(e){e.return!==null&&(Sr(e,1),cx(e,1,0))}function Sc(e){for(;e===Pl;)Pl=en[--tn],en[tn]=null,Ml=en[--tn],en[tn]=null;for(;e===Ir;)Ir=Wt[--Kt],Wt[Kt]=null,Es=Wt[--Kt],Wt[Kt]=null,Cs=Wt[--Kt],Wt[Kt]=null}var zt=null,It=null,ze=!1,as=null;function dx(e,s){var r=Gt(5,null,null,0);r.elementType="DELETED",r.stateNode=s,r.return=e,s=e.deletions,s===null?(e.deletions=[r],e.flags|=16):s.push(r)}function Yu(e,s){switch(e.tag){case 5:var r=e.type;return s=s.nodeType!==1||r.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(e.stateNode=s,zt=e,It=dr(s.firstChild),!0):!1;case 6:return s=e.pendingProps===""||s.nodeType!==3?null:s,s!==null?(e.stateNode=s,zt=e,It=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(r=Ir!==null?{id:Cs,overflow:Es}:null,e.memoizedState={dehydrated:s,treeContext:r,retryLane:1073741824},r=Gt(18,null,null,0),r.stateNode=s,r.return=e,e.child=r,zt=e,It=null,!0):!1;default:return!1}}function Eo(e){return(e.mode&1)!==0&&(e.flags&128)===0}function To(e){if(ze){var s=It;if(s){var r=s;if(!Yu(e,s)){if(Eo(e))throw Error(U(418));s=dr(r.nextSibling);var n=zt;s&&Yu(e,s)?dx(n,r):(e.flags=e.flags&-4097|2,ze=!1,zt=e)}}else{if(Eo(e))throw Error(U(418));e.flags=e.flags&-4097|2,ze=!1,zt=e}}}function Ju(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;zt=e}function Ka(e){if(e!==zt)return!1;if(!ze)return Ju(e),ze=!0,!1;var s;if((s=e.tag!==3)&&!(s=e.tag!==5)&&(s=e.type,s=s!=="head"&&s!=="body"&&!_o(e.type,e.memoizedProps)),s&&(s=It)){if(Eo(e))throw ux(),Error(U(418));for(;s;)dx(e,s),s=dr(s.nextSibling)}if(Ju(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(U(317));e:{for(e=e.nextSibling,s=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(s===0){It=dr(e.nextSibling);break e}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++}e=e.nextSibling}It=null}}else It=zt?dr(e.stateNode.nextSibling):null;return!0}function ux(){for(var e=It;e;)e=dr(e.nextSibling)}function pn(){It=zt=null,ze=!1}function Cc(e){as===null?as=[e]:as.push(e)}var qg=Is.ReactCurrentBatchConfig;function qn(e,s,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(U(309));var n=r.stateNode}if(!n)throw Error(U(147,e));var a=n,l=""+e;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(i){var o=a.refs;i===null?delete o[l]:o[l]=i},s._stringRef=l,s)}if(typeof e!="string")throw Error(U(284));if(!r._owner)throw Error(U(290,e))}return e}function Qa(e,s){throw e=Object.prototype.toString.call(s),Error(U(31,e==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":e))}function Zu(e){var s=e._init;return s(e._payload)}function mx(e){function s(g,p){if(e){var x=g.deletions;x===null?(g.deletions=[p],g.flags|=16):x.push(p)}}function r(g,p){if(!e)return null;for(;p!==null;)s(g,p),p=p.sibling;return null}function n(g,p){for(g=new Map;p!==null;)p.key!==null?g.set(p.key,p):g.set(p.index,p),p=p.sibling;return g}function a(g,p){return g=pr(g,p),g.index=0,g.sibling=null,g}function l(g,p,x){return g.index=x,e?(x=g.alternate,x!==null?(x=x.index,x<p?(g.flags|=2,p):x):(g.flags|=2,p)):(g.flags|=1048576,p)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,p,x,N){return p===null||p.tag!==6?(p=Vi(x,g.mode,N),p.return=g,p):(p=a(p,x),p.return=g,p)}function d(g,p,x,N){var j=x.type;return j===Qr?u(g,p,x.props.children,N,x.key):p!==null&&(p.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===er&&Zu(j)===p.type)?(N=a(p,x.props),N.ref=qn(g,p,x),N.return=g,N):(N=pl(x.type,x.key,x.props,null,g.mode,N),N.ref=qn(g,p,x),N.return=g,N)}function c(g,p,x,N){return p===null||p.tag!==4||p.stateNode.containerInfo!==x.containerInfo||p.stateNode.implementation!==x.implementation?(p=qi(x,g.mode,N),p.return=g,p):(p=a(p,x.children||[]),p.return=g,p)}function u(g,p,x,N,j){return p===null||p.tag!==7?(p=Mr(x,g.mode,N,j),p.return=g,p):(p=a(p,x),p.return=g,p)}function h(g,p,x){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Vi(""+p,g.mode,x),p.return=g,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Ia:return x=pl(p.type,p.key,p.props,null,g.mode,x),x.ref=qn(g,null,p),x.return=g,x;case Kr:return p=qi(p,g.mode,x),p.return=g,p;case er:var N=p._init;return h(g,N(p._payload),x)}if(Xn(p)||Un(p))return p=Mr(p,g.mode,x,null),p.return=g,p;Qa(g,p)}return null}function b(g,p,x,N){var j=p!==null?p.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return j!==null?null:o(g,p,""+x,N);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ia:return x.key===j?d(g,p,x,N):null;case Kr:return x.key===j?c(g,p,x,N):null;case er:return j=x._init,b(g,p,j(x._payload),N)}if(Xn(x)||Un(x))return j!==null?null:u(g,p,x,N,null);Qa(g,x)}return null}function w(g,p,x,N,j){if(typeof N=="string"&&N!==""||typeof N=="number")return g=g.get(x)||null,o(p,g,""+N,j);if(typeof N=="object"&&N!==null){switch(N.$$typeof){case Ia:return g=g.get(N.key===null?x:N.key)||null,d(p,g,N,j);case Kr:return g=g.get(N.key===null?x:N.key)||null,c(p,g,N,j);case er:var S=N._init;return w(g,p,x,S(N._payload),j)}if(Xn(N)||Un(N))return g=g.get(x)||null,u(p,g,N,j,null);Qa(p,N)}return null}function f(g,p,x,N){for(var j=null,S=null,C=p,P=p=0,$=null;C!==null&&P<x.length;P++){C.index>P?($=C,C=null):$=C.sibling;var z=b(g,C,x[P],N);if(z===null){C===null&&(C=$);break}e&&C&&z.alternate===null&&s(g,C),p=l(z,p,P),S===null?j=z:S.sibling=z,S=z,C=$}if(P===x.length)return r(g,C),ze&&Sr(g,P),j;if(C===null){for(;P<x.length;P++)C=h(g,x[P],N),C!==null&&(p=l(C,p,P),S===null?j=C:S.sibling=C,S=C);return ze&&Sr(g,P),j}for(C=n(g,C);P<x.length;P++)$=w(C,g,P,x[P],N),$!==null&&(e&&$.alternate!==null&&C.delete($.key===null?P:$.key),p=l($,p,P),S===null?j=$:S.sibling=$,S=$);return e&&C.forEach(function(B){return s(g,B)}),ze&&Sr(g,P),j}function y(g,p,x,N){var j=Un(x);if(typeof j!="function")throw Error(U(150));if(x=j.call(x),x==null)throw Error(U(151));for(var S=j=null,C=p,P=p=0,$=null,z=x.next();C!==null&&!z.done;P++,z=x.next()){C.index>P?($=C,C=null):$=C.sibling;var B=b(g,C,z.value,N);if(B===null){C===null&&(C=$);break}e&&C&&B.alternate===null&&s(g,C),p=l(B,p,P),S===null?j=B:S.sibling=B,S=B,C=$}if(z.done)return r(g,C),ze&&Sr(g,P),j;if(C===null){for(;!z.done;P++,z=x.next())z=h(g,z.value,N),z!==null&&(p=l(z,p,P),S===null?j=z:S.sibling=z,S=z);return ze&&Sr(g,P),j}for(C=n(g,C);!z.done;P++,z=x.next())z=w(C,g,P,z.value,N),z!==null&&(e&&z.alternate!==null&&C.delete(z.key===null?P:z.key),p=l(z,p,P),S===null?j=z:S.sibling=z,S=z);return e&&C.forEach(function(de){return s(g,de)}),ze&&Sr(g,P),j}function v(g,p,x,N){if(typeof x=="object"&&x!==null&&x.type===Qr&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ia:e:{for(var j=x.key,S=p;S!==null;){if(S.key===j){if(j=x.type,j===Qr){if(S.tag===7){r(g,S.sibling),p=a(S,x.props.children),p.return=g,g=p;break e}}else if(S.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===er&&Zu(j)===S.type){r(g,S.sibling),p=a(S,x.props),p.ref=qn(g,S,x),p.return=g,g=p;break e}r(g,S);break}else s(g,S);S=S.sibling}x.type===Qr?(p=Mr(x.props.children,g.mode,N,x.key),p.return=g,g=p):(N=pl(x.type,x.key,x.props,null,g.mode,N),N.ref=qn(g,p,x),N.return=g,g=N)}return i(g);case Kr:e:{for(S=x.key;p!==null;){if(p.key===S)if(p.tag===4&&p.stateNode.containerInfo===x.containerInfo&&p.stateNode.implementation===x.implementation){r(g,p.sibling),p=a(p,x.children||[]),p.return=g,g=p;break e}else{r(g,p);break}else s(g,p);p=p.sibling}p=qi(x,g.mode,N),p.return=g,g=p}return i(g);case er:return S=x._init,v(g,p,S(x._payload),N)}if(Xn(x))return f(g,p,x,N);if(Un(x))return y(g,p,x,N);Qa(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,p!==null&&p.tag===6?(r(g,p.sibling),p=a(p,x),p.return=g,g=p):(r(g,p),p=Vi(x,g.mode,N),p.return=g,g=p),i(g)):r(g,p)}return v}var hn=mx(!0),xx=mx(!1),$l=jr(null),Dl=null,sn=null,Ec=null;function Tc(){Ec=sn=Dl=null}function Ac(e){var s=$l.current;Oe($l),e._currentValue=s}function Ao(e,s,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&s)!==s?(e.childLanes|=s,n!==null&&(n.childLanes|=s)):n!==null&&(n.childLanes&s)!==s&&(n.childLanes|=s),e===r)break;e=e.return}}function dn(e,s){Dl=e,Ec=sn=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&s&&(Et=!0),e.firstContext=null)}function Jt(e){var s=e._currentValue;if(Ec!==e)if(e={context:e,memoizedValue:s,next:null},sn===null){if(Dl===null)throw Error(U(308));sn=e,Dl.dependencies={lanes:0,firstContext:e}}else sn=sn.next=e;return s}var Ar=null;function Rc(e){Ar===null?Ar=[e]:Ar.push(e)}function px(e,s,r,n){var a=s.interleaved;return a===null?(r.next=r,Rc(s)):(r.next=a.next,a.next=r),s.interleaved=r,Ms(e,n)}function Ms(e,s){e.lanes|=s;var r=e.alternate;for(r!==null&&(r.lanes|=s),r=e,e=e.return;e!==null;)e.childLanes|=s,r=e.alternate,r!==null&&(r.childLanes|=s),r=e,e=e.return;return r.tag===3?r.stateNode:null}var tr=!1;function Lc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function hx(e,s){e=e.updateQueue,s.updateQueue===e&&(s.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function As(e,s){return{eventTime:e,lane:s,tag:0,payload:null,callback:null,next:null}}function ur(e,s,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,_e&2){var a=n.pending;return a===null?s.next=s:(s.next=a.next,a.next=s),n.pending=s,Ms(e,r)}return a=n.interleaved,a===null?(s.next=s,Rc(n)):(s.next=a.next,a.next=s),n.interleaved=s,Ms(e,r)}function ol(e,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194240)!==0)){var n=s.lanes;n&=e.pendingLanes,r|=n,s.lanes=r,fc(e,r)}}function e0(e,s){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=i:l=l.next=i,r=r.next}while(r!==null);l===null?a=l=s:l=l.next=s}else a=l=s;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=s:e.next=s,r.lastBaseUpdate=s}function Il(e,s,r,n){var a=e.updateQueue;tr=!1;var l=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var d=o,c=d.next;d.next=null,i===null?l=c:i.next=c,i=d;var u=e.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==i&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=d))}if(l!==null){var h=a.baseState;i=0,u=c=d=null,o=l;do{var b=o.lane,w=o.eventTime;if((n&b)===b){u!==null&&(u=u.next={eventTime:w,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,y=o;switch(b=s,w=r,y.tag){case 1:if(f=y.payload,typeof f=="function"){h=f.call(w,h,b);break e}h=f;break e;case 3:f.flags=f.flags&-65537|128;case 0:if(f=y.payload,b=typeof f=="function"?f.call(w,h,b):f,b==null)break e;h=Be({},h,b);break e;case 2:tr=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,b=a.effects,b===null?a.effects=[o]:b.push(o))}else w={eventTime:w,lane:b,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=w,d=h):u=u.next=w,i|=b;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;b=o,o=b.next,b.next=null,a.lastBaseUpdate=b,a.shared.pending=null}}while(!0);if(u===null&&(d=h),a.baseState=d,a.firstBaseUpdate=c,a.lastBaseUpdate=u,s=a.shared.interleaved,s!==null){a=s;do i|=a.lane,a=a.next;while(a!==s)}else l===null&&(a.shared.lanes=0);zr|=i,e.lanes=i,e.memoizedState=h}}function t0(e,s,r){if(e=s.effects,s.effects=null,e!==null)for(s=0;s<e.length;s++){var n=e[s],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(U(191,a));a.call(n)}}}var Ta={},vs=jr(Ta),ba=jr(Ta),ja=jr(Ta);function Rr(e){if(e===Ta)throw Error(U(174));return e}function Pc(e,s){switch(Re(ja,s),Re(ba,e),Re(vs,Ta),e=s.nodeType,e){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:co(null,"");break;default:e=e===8?s.parentNode:s,s=e.namespaceURI||null,e=e.tagName,s=co(s,e)}Oe(vs),Re(vs,s)}function gn(){Oe(vs),Oe(ba),Oe(ja)}function gx(e){Rr(ja.current);var s=Rr(vs.current),r=co(s,e.type);s!==r&&(Re(ba,e),Re(vs,r))}function Mc(e){ba.current===e&&(Oe(vs),Oe(ba))}var Ue=jr(0);function Ol(e){for(var s=e;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Oi=[];function $c(){for(var e=0;e<Oi.length;e++)Oi[e]._workInProgressVersionPrimary=null;Oi.length=0}var cl=Is.ReactCurrentDispatcher,zi=Is.ReactCurrentBatchConfig,Or=0,Fe=null,Je=null,rt=null,zl=!1,na=!1,va=0,Wg=0;function xt(){throw Error(U(321))}function Dc(e,s){if(s===null)return!1;for(var r=0;r<s.length&&r<e.length;r++)if(!cs(e[r],s[r]))return!1;return!0}function Ic(e,s,r,n,a,l){if(Or=l,Fe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,cl.current=e===null||e.memoizedState===null?Xg:Yg,e=r(n,a),na){l=0;do{if(na=!1,va=0,25<=l)throw Error(U(301));l+=1,rt=Je=null,s.updateQueue=null,cl.current=Jg,e=r(n,a)}while(na)}if(cl.current=Ul,s=Je!==null&&Je.next!==null,Or=0,rt=Je=Fe=null,zl=!1,s)throw Error(U(300));return e}function Oc(){var e=va!==0;return va=0,e}function hs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return rt===null?Fe.memoizedState=rt=e:rt=rt.next=e,rt}function Zt(){if(Je===null){var e=Fe.alternate;e=e!==null?e.memoizedState:null}else e=Je.next;var s=rt===null?Fe.memoizedState:rt.next;if(s!==null)rt=s,Je=e;else{if(e===null)throw Error(U(310));Je=e,e={memoizedState:Je.memoizedState,baseState:Je.baseState,baseQueue:Je.baseQueue,queue:Je.queue,next:null},rt===null?Fe.memoizedState=rt=e:rt=rt.next=e}return rt}function Na(e,s){return typeof s=="function"?s(e):s}function Ui(e){var s=Zt(),r=s.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var n=Je,a=n.baseQueue,l=r.pending;if(l!==null){if(a!==null){var i=a.next;a.next=l.next,l.next=i}n.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,n=n.baseState;var o=i=null,d=null,c=l;do{var u=c.lane;if((Or&u)===u)d!==null&&(d=d.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};d===null?(o=d=h,i=n):d=d.next=h,Fe.lanes|=u,zr|=u}c=c.next}while(c!==null&&c!==l);d===null?i=n:d.next=o,cs(n,s.memoizedState)||(Et=!0),s.memoizedState=n,s.baseState=i,s.baseQueue=d,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do l=a.lane,Fe.lanes|=l,zr|=l,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[s.memoizedState,r.dispatch]}function Fi(e){var s=Zt(),r=s.queue;if(r===null)throw Error(U(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,l=s.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do l=e(l,i.action),i=i.next;while(i!==a);cs(l,s.memoizedState)||(Et=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),r.lastRenderedState=l}return[l,n]}function fx(){}function yx(e,s){var r=Fe,n=Zt(),a=s(),l=!cs(n.memoizedState,a);if(l&&(n.memoizedState=a,Et=!0),n=n.queue,zc(vx.bind(null,r,n,e),[e]),n.getSnapshot!==s||l||rt!==null&&rt.memoizedState.tag&1){if(r.flags|=2048,wa(9,jx.bind(null,r,n,a,s),void 0,null),lt===null)throw Error(U(349));Or&30||bx(r,s,a)}return a}function bx(e,s,r){e.flags|=16384,e={getSnapshot:s,value:r},s=Fe.updateQueue,s===null?(s={lastEffect:null,stores:null},Fe.updateQueue=s,s.stores=[e]):(r=s.stores,r===null?s.stores=[e]:r.push(e))}function jx(e,s,r,n){s.value=r,s.getSnapshot=n,Nx(s)&&wx(e)}function vx(e,s,r){return r(function(){Nx(s)&&wx(e)})}function Nx(e){var s=e.getSnapshot;e=e.value;try{var r=s();return!cs(e,r)}catch{return!0}}function wx(e){var s=Ms(e,1);s!==null&&is(s,e,1,-1)}function s0(e){var s=hs();return typeof e=="function"&&(e=e()),s.memoizedState=s.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:e},s.queue=e,e=e.dispatch=Gg.bind(null,Fe,e),[s.memoizedState,e]}function wa(e,s,r,n){return e={tag:e,create:s,destroy:r,deps:n,next:null},s=Fe.updateQueue,s===null?(s={lastEffect:null,stores:null},Fe.updateQueue=s,s.lastEffect=e.next=e):(r=s.lastEffect,r===null?s.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,s.lastEffect=e)),e}function _x(){return Zt().memoizedState}function dl(e,s,r,n){var a=hs();Fe.flags|=e,a.memoizedState=wa(1|s,r,void 0,n===void 0?null:n)}function ni(e,s,r,n){var a=Zt();n=n===void 0?null:n;var l=void 0;if(Je!==null){var i=Je.memoizedState;if(l=i.destroy,n!==null&&Dc(n,i.deps)){a.memoizedState=wa(s,r,l,n);return}}Fe.flags|=e,a.memoizedState=wa(1|s,r,l,n)}function r0(e,s){return dl(8390656,8,e,s)}function zc(e,s){return ni(2048,8,e,s)}function kx(e,s){return ni(4,2,e,s)}function Sx(e,s){return ni(4,4,e,s)}function Cx(e,s){if(typeof s=="function")return e=e(),s(e),function(){s(null)};if(s!=null)return e=e(),s.current=e,function(){s.current=null}}function Ex(e,s,r){return r=r!=null?r.concat([e]):null,ni(4,4,Cx.bind(null,s,e),r)}function Uc(){}function Tx(e,s){var r=Zt();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&Dc(s,n[1])?n[0]:(r.memoizedState=[e,s],e)}function Ax(e,s){var r=Zt();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&Dc(s,n[1])?n[0]:(e=e(),r.memoizedState=[e,s],e)}function Rx(e,s,r){return Or&21?(cs(r,s)||(r=Dm(),Fe.lanes|=r,zr|=r,e.baseState=!0),s):(e.baseState&&(e.baseState=!1,Et=!0),e.memoizedState=r)}function Kg(e,s){var r=Te;Te=r!==0&&4>r?r:4,e(!0);var n=zi.transition;zi.transition={};try{e(!1),s()}finally{Te=r,zi.transition=n}}function Lx(){return Zt().memoizedState}function Qg(e,s,r){var n=xr(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Px(e))Mx(s,r);else if(r=px(e,s,r,n),r!==null){var a=Nt();is(r,e,n,a),$x(r,s,n)}}function Gg(e,s,r){var n=xr(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Px(e))Mx(s,a);else{var l=e.alternate;if(e.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var i=s.lastRenderedState,o=l(i,r);if(a.hasEagerState=!0,a.eagerState=o,cs(o,i)){var d=s.interleaved;d===null?(a.next=a,Rc(s)):(a.next=d.next,d.next=a),s.interleaved=a;return}}catch{}finally{}r=px(e,s,a,n),r!==null&&(a=Nt(),is(r,e,n,a),$x(r,s,n))}}function Px(e){var s=e.alternate;return e===Fe||s!==null&&s===Fe}function Mx(e,s){na=zl=!0;var r=e.pending;r===null?s.next=s:(s.next=r.next,r.next=s),e.pending=s}function $x(e,s,r){if(r&4194240){var n=s.lanes;n&=e.pendingLanes,r|=n,s.lanes=r,fc(e,r)}}var Ul={readContext:Jt,useCallback:xt,useContext:xt,useEffect:xt,useImperativeHandle:xt,useInsertionEffect:xt,useLayoutEffect:xt,useMemo:xt,useReducer:xt,useRef:xt,useState:xt,useDebugValue:xt,useDeferredValue:xt,useTransition:xt,useMutableSource:xt,useSyncExternalStore:xt,useId:xt,unstable_isNewReconciler:!1},Xg={readContext:Jt,useCallback:function(e,s){return hs().memoizedState=[e,s===void 0?null:s],e},useContext:Jt,useEffect:r0,useImperativeHandle:function(e,s,r){return r=r!=null?r.concat([e]):null,dl(4194308,4,Cx.bind(null,s,e),r)},useLayoutEffect:function(e,s){return dl(4194308,4,e,s)},useInsertionEffect:function(e,s){return dl(4,2,e,s)},useMemo:function(e,s){var r=hs();return s=s===void 0?null:s,e=e(),r.memoizedState=[e,s],e},useReducer:function(e,s,r){var n=hs();return s=r!==void 0?r(s):s,n.memoizedState=n.baseState=s,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:s},n.queue=e,e=e.dispatch=Qg.bind(null,Fe,e),[n.memoizedState,e]},useRef:function(e){var s=hs();return e={current:e},s.memoizedState=e},useState:s0,useDebugValue:Uc,useDeferredValue:function(e){return hs().memoizedState=e},useTransition:function(){var e=s0(!1),s=e[0];return e=Kg.bind(null,e[1]),hs().memoizedState=e,[s,e]},useMutableSource:function(){},useSyncExternalStore:function(e,s,r){var n=Fe,a=hs();if(ze){if(r===void 0)throw Error(U(407));r=r()}else{if(r=s(),lt===null)throw Error(U(349));Or&30||bx(n,s,r)}a.memoizedState=r;var l={value:r,getSnapshot:s};return a.queue=l,r0(vx.bind(null,n,l,e),[e]),n.flags|=2048,wa(9,jx.bind(null,n,l,r,s),void 0,null),r},useId:function(){var e=hs(),s=lt.identifierPrefix;if(ze){var r=Es,n=Cs;r=(n&~(1<<32-ls(n)-1)).toString(32)+r,s=":"+s+"R"+r,r=va++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=Wg++,s=":"+s+"r"+r.toString(32)+":";return e.memoizedState=s},unstable_isNewReconciler:!1},Yg={readContext:Jt,useCallback:Tx,useContext:Jt,useEffect:zc,useImperativeHandle:Ex,useInsertionEffect:kx,useLayoutEffect:Sx,useMemo:Ax,useReducer:Ui,useRef:_x,useState:function(){return Ui(Na)},useDebugValue:Uc,useDeferredValue:function(e){var s=Zt();return Rx(s,Je.memoizedState,e)},useTransition:function(){var e=Ui(Na)[0],s=Zt().memoizedState;return[e,s]},useMutableSource:fx,useSyncExternalStore:yx,useId:Lx,unstable_isNewReconciler:!1},Jg={readContext:Jt,useCallback:Tx,useContext:Jt,useEffect:zc,useImperativeHandle:Ex,useInsertionEffect:kx,useLayoutEffect:Sx,useMemo:Ax,useReducer:Fi,useRef:_x,useState:function(){return Fi(Na)},useDebugValue:Uc,useDeferredValue:function(e){var s=Zt();return Je===null?s.memoizedState=e:Rx(s,Je.memoizedState,e)},useTransition:function(){var e=Fi(Na)[0],s=Zt().memoizedState;return[e,s]},useMutableSource:fx,useSyncExternalStore:yx,useId:Lx,unstable_isNewReconciler:!1};function rs(e,s){if(e&&e.defaultProps){s=Be({},s),e=e.defaultProps;for(var r in e)s[r]===void 0&&(s[r]=e[r]);return s}return s}function Ro(e,s,r,n){s=e.memoizedState,r=r(n,s),r=r==null?s:Be({},s,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ai={isMounted:function(e){return(e=e._reactInternals)?qr(e)===e:!1},enqueueSetState:function(e,s,r){e=e._reactInternals;var n=Nt(),a=xr(e),l=As(n,a);l.payload=s,r!=null&&(l.callback=r),s=ur(e,l,a),s!==null&&(is(s,e,a,n),ol(s,e,a))},enqueueReplaceState:function(e,s,r){e=e._reactInternals;var n=Nt(),a=xr(e),l=As(n,a);l.tag=1,l.payload=s,r!=null&&(l.callback=r),s=ur(e,l,a),s!==null&&(is(s,e,a,n),ol(s,e,a))},enqueueForceUpdate:function(e,s){e=e._reactInternals;var r=Nt(),n=xr(e),a=As(r,n);a.tag=2,s!=null&&(a.callback=s),s=ur(e,a,n),s!==null&&(is(s,e,n,r),ol(s,e,n))}};function n0(e,s,r,n,a,l,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,l,i):s.prototype&&s.prototype.isPureReactComponent?!ha(r,n)||!ha(a,l):!0}function Dx(e,s,r){var n=!1,a=fr,l=s.contextType;return typeof l=="object"&&l!==null?l=Jt(l):(a=At(s)?Dr:yt.current,n=s.contextTypes,l=(n=n!=null)?xn(e,a):fr),s=new s(r,l),e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=ai,e.stateNode=s,s._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=l),s}function a0(e,s,r,n){e=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,n),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,n),s.state!==e&&ai.enqueueReplaceState(s,s.state,null)}function Lo(e,s,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Lc(e);var l=s.contextType;typeof l=="object"&&l!==null?a.context=Jt(l):(l=At(s)?Dr:yt.current,a.context=xn(e,l)),a.state=e.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(Ro(e,s,l,r),a.state=e.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(s=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),s!==a.state&&ai.enqueueReplaceState(a,a.state,null),Il(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function fn(e,s){try{var r="",n=s;do r+=Sh(n),n=n.return;while(n);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:e,source:s,stack:a,digest:null}}function Bi(e,s,r){return{value:e,source:null,stack:r??null,digest:s??null}}function Po(e,s){try{console.error(s.value)}catch(r){setTimeout(function(){throw r})}}var Zg=typeof WeakMap=="function"?WeakMap:Map;function Ix(e,s,r){r=As(-1,r),r.tag=3,r.payload={element:null};var n=s.value;return r.callback=function(){Bl||(Bl=!0,Ho=n),Po(e,s)},r}function Ox(e,s,r){r=As(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=s.value;r.payload=function(){return n(a)},r.callback=function(){Po(e,s)}}var l=e.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){Po(e,s),typeof n!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),r}function l0(e,s,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Zg;var a=new Set;n.set(s,a)}else a=n.get(s),a===void 0&&(a=new Set,n.set(s,a));a.has(r)||(a.add(r),e=pf.bind(null,e,s,r),s.then(e,e))}function i0(e){do{var s;if((s=e.tag===13)&&(s=e.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return e;e=e.return}while(e!==null);return null}function o0(e,s,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===s?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(s=As(-1,1),s.tag=2,ur(r,s,1))),r.lanes|=1),e)}var ef=Is.ReactCurrentOwner,Et=!1;function bt(e,s,r,n){s.child=e===null?xx(s,null,r,n):hn(s,e.child,r,n)}function c0(e,s,r,n,a){r=r.render;var l=s.ref;return dn(s,a),n=Ic(e,s,r,n,l,a),r=Oc(),e!==null&&!Et?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~a,$s(e,s,a)):(ze&&r&&kc(s),s.flags|=1,bt(e,s,n,a),s.child)}function d0(e,s,r,n,a){if(e===null){var l=r.type;return typeof l=="function"&&!Qc(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(s.tag=15,s.type=l,zx(e,s,l,n,a)):(e=pl(r.type,null,n,s,s.mode,a),e.ref=s.ref,e.return=s,s.child=e)}if(l=e.child,!(e.lanes&a)){var i=l.memoizedProps;if(r=r.compare,r=r!==null?r:ha,r(i,n)&&e.ref===s.ref)return $s(e,s,a)}return s.flags|=1,e=pr(l,n),e.ref=s.ref,e.return=s,s.child=e}function zx(e,s,r,n,a){if(e!==null){var l=e.memoizedProps;if(ha(l,n)&&e.ref===s.ref)if(Et=!1,s.pendingProps=n=l,(e.lanes&a)!==0)e.flags&131072&&(Et=!0);else return s.lanes=e.lanes,$s(e,s,a)}return Mo(e,s,r,n,a)}function Ux(e,s,r){var n=s.pendingProps,a=n.children,l=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Re(nn,Dt),Dt|=r;else{if(!(r&1073741824))return e=l!==null?l.baseLanes|r:r,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:e,cachePool:null,transitions:null},s.updateQueue=null,Re(nn,Dt),Dt|=e,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,Re(nn,Dt),Dt|=n}else l!==null?(n=l.baseLanes|r,s.memoizedState=null):n=r,Re(nn,Dt),Dt|=n;return bt(e,s,a,r),s.child}function Fx(e,s){var r=s.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(s.flags|=512,s.flags|=2097152)}function Mo(e,s,r,n,a){var l=At(r)?Dr:yt.current;return l=xn(s,l),dn(s,a),r=Ic(e,s,r,n,l,a),n=Oc(),e!==null&&!Et?(s.updateQueue=e.updateQueue,s.flags&=-2053,e.lanes&=~a,$s(e,s,a)):(ze&&n&&kc(s),s.flags|=1,bt(e,s,r,a),s.child)}function u0(e,s,r,n,a){if(At(r)){var l=!0;Ll(s)}else l=!1;if(dn(s,a),s.stateNode===null)ul(e,s),Dx(s,r,n),Lo(s,r,n,a),n=!0;else if(e===null){var i=s.stateNode,o=s.memoizedProps;i.props=o;var d=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Jt(c):(c=At(r)?Dr:yt.current,c=xn(s,c));var u=r.getDerivedStateFromProps,h=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||d!==c)&&a0(s,i,n,c),tr=!1;var b=s.memoizedState;i.state=b,Il(s,n,i,a),d=s.memoizedState,o!==n||b!==d||Tt.current||tr?(typeof u=="function"&&(Ro(s,r,u,n),d=s.memoizedState),(o=tr||n0(s,r,o,n,b,d,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=n,s.memoizedState=d),i.props=n,i.state=d,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),n=!1)}else{i=s.stateNode,hx(e,s),o=s.memoizedProps,c=s.type===s.elementType?o:rs(s.type,o),i.props=c,h=s.pendingProps,b=i.context,d=r.contextType,typeof d=="object"&&d!==null?d=Jt(d):(d=At(r)?Dr:yt.current,d=xn(s,d));var w=r.getDerivedStateFromProps;(u=typeof w=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==h||b!==d)&&a0(s,i,n,d),tr=!1,b=s.memoizedState,i.state=b,Il(s,n,i,a);var f=s.memoizedState;o!==h||b!==f||Tt.current||tr?(typeof w=="function"&&(Ro(s,r,w,n),f=s.memoizedState),(c=tr||n0(s,r,c,n,b,f,d)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,f,d),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,f,d)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&b===e.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&b===e.memoizedState||(s.flags|=1024),s.memoizedProps=n,s.memoizedState=f),i.props=n,i.state=f,i.context=d,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&b===e.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&b===e.memoizedState||(s.flags|=1024),n=!1)}return $o(e,s,r,n,l,a)}function $o(e,s,r,n,a,l){Fx(e,s);var i=(s.flags&128)!==0;if(!n&&!i)return a&&Xu(s,r,!1),$s(e,s,l);n=s.stateNode,ef.current=s;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return s.flags|=1,e!==null&&i?(s.child=hn(s,e.child,null,l),s.child=hn(s,null,o,l)):bt(e,s,o,l),s.memoizedState=n.state,a&&Xu(s,r,!0),s.child}function Bx(e){var s=e.stateNode;s.pendingContext?Gu(e,s.pendingContext,s.pendingContext!==s.context):s.context&&Gu(e,s.context,!1),Pc(e,s.containerInfo)}function m0(e,s,r,n,a){return pn(),Cc(a),s.flags|=256,bt(e,s,r,n),s.child}var Do={dehydrated:null,treeContext:null,retryLane:0};function Io(e){return{baseLanes:e,cachePool:null,transitions:null}}function Hx(e,s,r){var n=s.pendingProps,a=Ue.current,l=!1,i=(s.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(l=!0,s.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),Re(Ue,a&1),e===null)return To(s),e=s.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(s.mode&1?e.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=n.children,e=n.fallback,l?(n=s.mode,l=s.child,i={mode:"hidden",children:i},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=oi(i,n,0,null),e=Mr(e,n,r,null),l.return=s,e.return=s,l.sibling=e,s.child=l,s.child.memoizedState=Io(r),s.memoizedState=Do,e):Fc(s,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return tf(e,s,i,n,o,a,r);if(l){l=n.fallback,i=s.mode,a=e.child,o=a.sibling;var d={mode:"hidden",children:n.children};return!(i&1)&&s.child!==a?(n=s.child,n.childLanes=0,n.pendingProps=d,s.deletions=null):(n=pr(a,d),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?l=pr(o,l):(l=Mr(l,i,r,null),l.flags|=2),l.return=s,n.return=s,n.sibling=l,s.child=n,n=l,l=s.child,i=e.child.memoizedState,i=i===null?Io(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=e.childLanes&~r,s.memoizedState=Do,n}return l=e.child,e=l.sibling,n=pr(l,{mode:"visible",children:n.children}),!(s.mode&1)&&(n.lanes=r),n.return=s,n.sibling=null,e!==null&&(r=s.deletions,r===null?(s.deletions=[e],s.flags|=16):r.push(e)),s.child=n,s.memoizedState=null,n}function Fc(e,s){return s=oi({mode:"visible",children:s},e.mode,0,null),s.return=e,e.child=s}function Ga(e,s,r,n){return n!==null&&Cc(n),hn(s,e.child,null,r),e=Fc(s,s.pendingProps.children),e.flags|=2,s.memoizedState=null,e}function tf(e,s,r,n,a,l,i){if(r)return s.flags&256?(s.flags&=-257,n=Bi(Error(U(422))),Ga(e,s,i,n)):s.memoizedState!==null?(s.child=e.child,s.flags|=128,null):(l=n.fallback,a=s.mode,n=oi({mode:"visible",children:n.children},a,0,null),l=Mr(l,a,i,null),l.flags|=2,n.return=s,l.return=s,n.sibling=l,s.child=n,s.mode&1&&hn(s,e.child,null,i),s.child.memoizedState=Io(i),s.memoizedState=Do,l);if(!(s.mode&1))return Ga(e,s,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,l=Error(U(419)),n=Bi(l,n,void 0),Ga(e,s,i,n)}if(o=(i&e.childLanes)!==0,Et||o){if(n=lt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Ms(e,a),is(n,e,a,-1))}return Kc(),n=Bi(Error(U(421))),Ga(e,s,i,n)}return a.data==="$?"?(s.flags|=128,s.child=e.child,s=hf.bind(null,e),a._reactRetry=s,null):(e=l.treeContext,It=dr(a.nextSibling),zt=s,ze=!0,as=null,e!==null&&(Wt[Kt++]=Cs,Wt[Kt++]=Es,Wt[Kt++]=Ir,Cs=e.id,Es=e.overflow,Ir=s),s=Fc(s,n.children),s.flags|=4096,s)}function x0(e,s,r){e.lanes|=s;var n=e.alternate;n!==null&&(n.lanes|=s),Ao(e.return,s,r)}function Hi(e,s,r,n,a){var l=e.memoizedState;l===null?e.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=a)}function Vx(e,s,r){var n=s.pendingProps,a=n.revealOrder,l=n.tail;if(bt(e,s,n.children,r),n=Ue.current,n&2)n=n&1|2,s.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=s.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&x0(e,r,s);else if(e.tag===19)x0(e,r,s);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===s)break e;for(;e.sibling===null;){if(e.return===null||e.return===s)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Re(Ue,n),!(s.mode&1))s.memoizedState=null;else switch(a){case"forwards":for(r=s.child,a=null;r!==null;)e=r.alternate,e!==null&&Ol(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=s.child,s.child=null):(a=r.sibling,r.sibling=null),Hi(s,!1,a,r,l);break;case"backwards":for(r=null,a=s.child,s.child=null;a!==null;){if(e=a.alternate,e!==null&&Ol(e)===null){s.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Hi(s,!0,r,null,l);break;case"together":Hi(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ul(e,s){!(s.mode&1)&&e!==null&&(e.alternate=null,s.alternate=null,s.flags|=2)}function $s(e,s,r){if(e!==null&&(s.dependencies=e.dependencies),zr|=s.lanes,!(r&s.childLanes))return null;if(e!==null&&s.child!==e.child)throw Error(U(153));if(s.child!==null){for(e=s.child,r=pr(e,e.pendingProps),s.child=r,r.return=s;e.sibling!==null;)e=e.sibling,r=r.sibling=pr(e,e.pendingProps),r.return=s;r.sibling=null}return s.child}function sf(e,s,r){switch(s.tag){case 3:Bx(s),pn();break;case 5:gx(s);break;case 1:At(s.type)&&Ll(s);break;case 4:Pc(s,s.stateNode.containerInfo);break;case 10:var n=s.type._context,a=s.memoizedProps.value;Re($l,n._currentValue),n._currentValue=a;break;case 13:if(n=s.memoizedState,n!==null)return n.dehydrated!==null?(Re(Ue,Ue.current&1),s.flags|=128,null):r&s.child.childLanes?Hx(e,s,r):(Re(Ue,Ue.current&1),e=$s(e,s,r),e!==null?e.sibling:null);Re(Ue,Ue.current&1);break;case 19:if(n=(r&s.childLanes)!==0,e.flags&128){if(n)return Vx(e,s,r);s.flags|=128}if(a=s.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Re(Ue,Ue.current),n)break;return null;case 22:case 23:return s.lanes=0,Ux(e,s,r)}return $s(e,s,r)}var qx,Oo,Wx,Kx;qx=function(e,s){for(var r=s.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Oo=function(){};Wx=function(e,s,r,n){var a=e.memoizedProps;if(a!==n){e=s.stateNode,Rr(vs.current);var l=null;switch(r){case"input":a=ao(e,a),n=ao(e,n),l=[];break;case"select":a=Be({},a,{value:void 0}),n=Be({},n,{value:void 0}),l=[];break;case"textarea":a=oo(e,a),n=oo(e,n),l=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Al)}uo(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(oa.hasOwnProperty(c)?l||(l=[]):(l=l||[]).push(c,null));for(c in n){var d=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&d!==o&&(d!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||d&&d.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in d)d.hasOwnProperty(i)&&o[i]!==d[i]&&(r||(r={}),r[i]=d[i])}else r||(l||(l=[]),l.push(c,r)),r=d;else c==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,o=o?o.__html:void 0,d!=null&&o!==d&&(l=l||[]).push(c,d)):c==="children"?typeof d!="string"&&typeof d!="number"||(l=l||[]).push(c,""+d):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(oa.hasOwnProperty(c)?(d!=null&&c==="onScroll"&&$e("scroll",e),l||o===d||(l=[])):(l=l||[]).push(c,d))}r&&(l=l||[]).push("style",r);var c=l;(s.updateQueue=c)&&(s.flags|=4)}};Kx=function(e,s,r,n){r!==n&&(s.flags|=4)};function Wn(e,s){if(!ze)switch(e.tailMode){case"hidden":s=e.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?s||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function pt(e){var s=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(s)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,s}function rf(e,s,r){var n=s.pendingProps;switch(Sc(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return pt(s),null;case 1:return At(s.type)&&Rl(),pt(s),null;case 3:return n=s.stateNode,gn(),Oe(Tt),Oe(yt),$c(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Ka(s)?s.flags|=4:e===null||e.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,as!==null&&(Wo(as),as=null))),Oo(e,s),pt(s),null;case 5:Mc(s);var a=Rr(ja.current);if(r=s.type,e!==null&&s.stateNode!=null)Wx(e,s,r,n,a),e.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!n){if(s.stateNode===null)throw Error(U(166));return pt(s),null}if(e=Rr(vs.current),Ka(s)){n=s.stateNode,r=s.type;var l=s.memoizedProps;switch(n[gs]=s,n[ya]=l,e=(s.mode&1)!==0,r){case"dialog":$e("cancel",n),$e("close",n);break;case"iframe":case"object":case"embed":$e("load",n);break;case"video":case"audio":for(a=0;a<Jn.length;a++)$e(Jn[a],n);break;case"source":$e("error",n);break;case"img":case"image":case"link":$e("error",n),$e("load",n);break;case"details":$e("toggle",n);break;case"input":Nu(n,l),$e("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},$e("invalid",n);break;case"textarea":_u(n,l),$e("invalid",n)}uo(r,l),a=null;for(var i in l)if(l.hasOwnProperty(i)){var o=l[i];i==="children"?typeof o=="string"?n.textContent!==o&&(l.suppressHydrationWarning!==!0&&Wa(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(l.suppressHydrationWarning!==!0&&Wa(n.textContent,o,e),a=["children",""+o]):oa.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&$e("scroll",n)}switch(r){case"input":Oa(n),wu(n,l,!0);break;case"textarea":Oa(n),ku(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=Al)}n=a,s.updateQueue=n,n!==null&&(s.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=vm(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[gs]=s,e[ya]=n,qx(e,s,!1,!1),s.stateNode=e;e:{switch(i=mo(r,n),r){case"dialog":$e("cancel",e),$e("close",e),a=n;break;case"iframe":case"object":case"embed":$e("load",e),a=n;break;case"video":case"audio":for(a=0;a<Jn.length;a++)$e(Jn[a],e);a=n;break;case"source":$e("error",e),a=n;break;case"img":case"image":case"link":$e("error",e),$e("load",e),a=n;break;case"details":$e("toggle",e),a=n;break;case"input":Nu(e,n),a=ao(e,n),$e("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Be({},n,{value:void 0}),$e("invalid",e);break;case"textarea":_u(e,n),a=oo(e,n),$e("invalid",e);break;default:a=n}uo(r,a),o=a;for(l in o)if(o.hasOwnProperty(l)){var d=o[l];l==="style"?_m(e,d):l==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&Nm(e,d)):l==="children"?typeof d=="string"?(r!=="textarea"||d!=="")&&ca(e,d):typeof d=="number"&&ca(e,""+d):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(oa.hasOwnProperty(l)?d!=null&&l==="onScroll"&&$e("scroll",e):d!=null&&uc(e,l,d,i))}switch(r){case"input":Oa(e),wu(e,n,!1);break;case"textarea":Oa(e),ku(e);break;case"option":n.value!=null&&e.setAttribute("value",""+gr(n.value));break;case"select":e.multiple=!!n.multiple,l=n.value,l!=null?an(e,!!n.multiple,l,!1):n.defaultValue!=null&&an(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=Al)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return pt(s),null;case 6:if(e&&s.stateNode!=null)Kx(e,s,e.memoizedProps,n);else{if(typeof n!="string"&&s.stateNode===null)throw Error(U(166));if(r=Rr(ja.current),Rr(vs.current),Ka(s)){if(n=s.stateNode,r=s.memoizedProps,n[gs]=s,(l=n.nodeValue!==r)&&(e=zt,e!==null))switch(e.tag){case 3:Wa(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Wa(n.nodeValue,r,(e.mode&1)!==0)}l&&(s.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[gs]=s,s.stateNode=n}return pt(s),null;case 13:if(Oe(Ue),n=s.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(ze&&It!==null&&s.mode&1&&!(s.flags&128))ux(),pn(),s.flags|=98560,l=!1;else if(l=Ka(s),n!==null&&n.dehydrated!==null){if(e===null){if(!l)throw Error(U(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(U(317));l[gs]=s}else pn(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;pt(s),l=!1}else as!==null&&(Wo(as),as=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=r,s):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(s.child.flags|=8192,s.mode&1&&(e===null||Ue.current&1?tt===0&&(tt=3):Kc())),s.updateQueue!==null&&(s.flags|=4),pt(s),null);case 4:return gn(),Oo(e,s),e===null&&ga(s.stateNode.containerInfo),pt(s),null;case 10:return Ac(s.type._context),pt(s),null;case 17:return At(s.type)&&Rl(),pt(s),null;case 19:if(Oe(Ue),l=s.memoizedState,l===null)return pt(s),null;if(n=(s.flags&128)!==0,i=l.rendering,i===null)if(n)Wn(l,!1);else{if(tt!==0||e!==null&&e.flags&128)for(e=s.child;e!==null;){if(i=Ol(e),i!==null){for(s.flags|=128,Wn(l,!1),n=i.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),s.subtreeFlags=0,n=r,r=s.child;r!==null;)l=r,e=n,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,e=i.dependencies,l.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Re(Ue,Ue.current&1|2),s.child}e=e.sibling}l.tail!==null&&qe()>yn&&(s.flags|=128,n=!0,Wn(l,!1),s.lanes=4194304)}else{if(!n)if(e=Ol(i),e!==null){if(s.flags|=128,n=!0,r=e.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),Wn(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!ze)return pt(s),null}else 2*qe()-l.renderingStartTime>yn&&r!==1073741824&&(s.flags|=128,n=!0,Wn(l,!1),s.lanes=4194304);l.isBackwards?(i.sibling=s.child,s.child=i):(r=l.last,r!==null?r.sibling=i:s.child=i,l.last=i)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=qe(),s.sibling=null,r=Ue.current,Re(Ue,n?r&1|2:r&1),s):(pt(s),null);case 22:case 23:return Wc(),n=s.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(s.flags|=8192),n&&s.mode&1?Dt&1073741824&&(pt(s),s.subtreeFlags&6&&(s.flags|=8192)):pt(s),null;case 24:return null;case 25:return null}throw Error(U(156,s.tag))}function nf(e,s){switch(Sc(s),s.tag){case 1:return At(s.type)&&Rl(),e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 3:return gn(),Oe(Tt),Oe(yt),$c(),e=s.flags,e&65536&&!(e&128)?(s.flags=e&-65537|128,s):null;case 5:return Mc(s),null;case 13:if(Oe(Ue),e=s.memoizedState,e!==null&&e.dehydrated!==null){if(s.alternate===null)throw Error(U(340));pn()}return e=s.flags,e&65536?(s.flags=e&-65537|128,s):null;case 19:return Oe(Ue),null;case 4:return gn(),null;case 10:return Ac(s.type._context),null;case 22:case 23:return Wc(),null;case 24:return null;default:return null}}var Xa=!1,ht=!1,af=typeof WeakSet=="function"?WeakSet:Set,X=null;function rn(e,s){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Ve(e,s,n)}else r.current=null}function zo(e,s,r){try{r()}catch(n){Ve(e,s,n)}}var p0=!1;function lf(e,s){if(No=Cl,e=Jm(),_c(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var i=0,o=-1,d=-1,c=0,u=0,h=e,b=null;t:for(;;){for(var w;h!==r||a!==0&&h.nodeType!==3||(o=i+a),h!==l||n!==0&&h.nodeType!==3||(d=i+n),h.nodeType===3&&(i+=h.nodeValue.length),(w=h.firstChild)!==null;)b=h,h=w;for(;;){if(h===e)break t;if(b===r&&++c===a&&(o=i),b===l&&++u===n&&(d=i),(w=h.nextSibling)!==null)break;h=b,b=h.parentNode}h=w}r=o===-1||d===-1?null:{start:o,end:d}}else r=null}r=r||{start:0,end:0}}else r=null;for(wo={focusedElem:e,selectionRange:r},Cl=!1,X=s;X!==null;)if(s=X,e=s.child,(s.subtreeFlags&1028)!==0&&e!==null)e.return=s,X=e;else for(;X!==null;){s=X;try{var f=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var y=f.memoizedProps,v=f.memoizedState,g=s.stateNode,p=g.getSnapshotBeforeUpdate(s.elementType===s.type?y:rs(s.type,y),v);g.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var x=s.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(N){Ve(s,s.return,N)}if(e=s.sibling,e!==null){e.return=s.return,X=e;break}X=s.return}return f=p0,p0=!1,f}function aa(e,s,r){var n=s.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var l=a.destroy;a.destroy=void 0,l!==void 0&&zo(s,r,l)}a=a.next}while(a!==n)}}function li(e,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==s)}}function Uo(e){var s=e.ref;if(s!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof s=="function"?s(e):s.current=e}}function Qx(e){var s=e.alternate;s!==null&&(e.alternate=null,Qx(s)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(s=e.stateNode,s!==null&&(delete s[gs],delete s[ya],delete s[So],delete s[Bg],delete s[Hg])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Gx(e){return e.tag===5||e.tag===3||e.tag===4}function h0(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Gx(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Fo(e,s,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(e,s):r.insertBefore(e,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(e,r)):(s=r,s.appendChild(e)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=Al));else if(n!==4&&(e=e.child,e!==null))for(Fo(e,s,r),e=e.sibling;e!==null;)Fo(e,s,r),e=e.sibling}function Bo(e,s,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,s?r.insertBefore(e,s):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Bo(e,s,r),e=e.sibling;e!==null;)Bo(e,s,r),e=e.sibling}var ot=null,ns=!1;function Js(e,s,r){for(r=r.child;r!==null;)Xx(e,s,r),r=r.sibling}function Xx(e,s,r){if(js&&typeof js.onCommitFiberUnmount=="function")try{js.onCommitFiberUnmount(Jl,r)}catch{}switch(r.tag){case 5:ht||rn(r,s);case 6:var n=ot,a=ns;ot=null,Js(e,s,r),ot=n,ns=a,ot!==null&&(ns?(e=ot,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ot.removeChild(r.stateNode));break;case 18:ot!==null&&(ns?(e=ot,r=r.stateNode,e.nodeType===8?Di(e.parentNode,r):e.nodeType===1&&Di(e,r),xa(e)):Di(ot,r.stateNode));break;case 4:n=ot,a=ns,ot=r.stateNode.containerInfo,ns=!0,Js(e,s,r),ot=n,ns=a;break;case 0:case 11:case 14:case 15:if(!ht&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var l=a,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&zo(r,s,i),a=a.next}while(a!==n)}Js(e,s,r);break;case 1:if(!ht&&(rn(r,s),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Ve(r,s,o)}Js(e,s,r);break;case 21:Js(e,s,r);break;case 22:r.mode&1?(ht=(n=ht)||r.memoizedState!==null,Js(e,s,r),ht=n):Js(e,s,r);break;default:Js(e,s,r)}}function g0(e){var s=e.updateQueue;if(s!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new af),s.forEach(function(n){var a=gf.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function ts(e,s){var r=s.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var l=e,i=s,o=i;e:for(;o!==null;){switch(o.tag){case 5:ot=o.stateNode,ns=!1;break e;case 3:ot=o.stateNode.containerInfo,ns=!0;break e;case 4:ot=o.stateNode.containerInfo,ns=!0;break e}o=o.return}if(ot===null)throw Error(U(160));Xx(l,i,a),ot=null,ns=!1;var d=a.alternate;d!==null&&(d.return=null),a.return=null}catch(c){Ve(a,s,c)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Yx(s,e),s=s.sibling}function Yx(e,s){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ts(s,e),ms(e),n&4){try{aa(3,e,e.return),li(3,e)}catch(y){Ve(e,e.return,y)}try{aa(5,e,e.return)}catch(y){Ve(e,e.return,y)}}break;case 1:ts(s,e),ms(e),n&512&&r!==null&&rn(r,r.return);break;case 5:if(ts(s,e),ms(e),n&512&&r!==null&&rn(r,r.return),e.flags&32){var a=e.stateNode;try{ca(a,"")}catch(y){Ve(e,e.return,y)}}if(n&4&&(a=e.stateNode,a!=null)){var l=e.memoizedProps,i=r!==null?r.memoizedProps:l,o=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{o==="input"&&l.type==="radio"&&l.name!=null&&bm(a,l),mo(o,i);var c=mo(o,l);for(i=0;i<d.length;i+=2){var u=d[i],h=d[i+1];u==="style"?_m(a,h):u==="dangerouslySetInnerHTML"?Nm(a,h):u==="children"?ca(a,h):uc(a,u,h,c)}switch(o){case"input":lo(a,l);break;case"textarea":jm(a,l);break;case"select":var b=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var w=l.value;w!=null?an(a,!!l.multiple,w,!1):b!==!!l.multiple&&(l.defaultValue!=null?an(a,!!l.multiple,l.defaultValue,!0):an(a,!!l.multiple,l.multiple?[]:"",!1))}a[ya]=l}catch(y){Ve(e,e.return,y)}}break;case 6:if(ts(s,e),ms(e),n&4){if(e.stateNode===null)throw Error(U(162));a=e.stateNode,l=e.memoizedProps;try{a.nodeValue=l}catch(y){Ve(e,e.return,y)}}break;case 3:if(ts(s,e),ms(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{xa(s.containerInfo)}catch(y){Ve(e,e.return,y)}break;case 4:ts(s,e),ms(e);break;case 13:ts(s,e),ms(e),a=e.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(Vc=qe())),n&4&&g0(e);break;case 22:if(u=r!==null&&r.memoizedState!==null,e.mode&1?(ht=(c=ht)||u,ts(s,e),ht=c):ts(s,e),ms(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!u&&e.mode&1)for(X=e,u=e.child;u!==null;){for(h=X=u;X!==null;){switch(b=X,w=b.child,b.tag){case 0:case 11:case 14:case 15:aa(4,b,b.return);break;case 1:rn(b,b.return);var f=b.stateNode;if(typeof f.componentWillUnmount=="function"){n=b,r=b.return;try{s=n,f.props=s.memoizedProps,f.state=s.memoizedState,f.componentWillUnmount()}catch(y){Ve(n,r,y)}}break;case 5:rn(b,b.return);break;case 22:if(b.memoizedState!==null){y0(h);continue}}w!==null?(w.return=b,X=w):y0(h)}u=u.sibling}e:for(u=null,h=e;;){if(h.tag===5){if(u===null){u=h;try{a=h.stateNode,c?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(o=h.stateNode,d=h.memoizedProps.style,i=d!=null&&d.hasOwnProperty("display")?d.display:null,o.style.display=wm("display",i))}catch(y){Ve(e,e.return,y)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(y){Ve(e,e.return,y)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ts(s,e),ms(e),n&4&&g0(e);break;case 21:break;default:ts(s,e),ms(e)}}function ms(e){var s=e.flags;if(s&2){try{e:{for(var r=e.return;r!==null;){if(Gx(r)){var n=r;break e}r=r.return}throw Error(U(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(ca(a,""),n.flags&=-33);var l=h0(e);Bo(e,l,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=h0(e);Fo(e,o,i);break;default:throw Error(U(161))}}catch(d){Ve(e,e.return,d)}e.flags&=-3}s&4096&&(e.flags&=-4097)}function of(e,s,r){X=e,Jx(e)}function Jx(e,s,r){for(var n=(e.mode&1)!==0;X!==null;){var a=X,l=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Xa;if(!i){var o=a.alternate,d=o!==null&&o.memoizedState!==null||ht;o=Xa;var c=ht;if(Xa=i,(ht=d)&&!c)for(X=a;X!==null;)i=X,d=i.child,i.tag===22&&i.memoizedState!==null?b0(a):d!==null?(d.return=i,X=d):b0(a);for(;l!==null;)X=l,Jx(l),l=l.sibling;X=a,Xa=o,ht=c}f0(e)}else a.subtreeFlags&8772&&l!==null?(l.return=a,X=l):f0(e)}}function f0(e){for(;X!==null;){var s=X;if(s.flags&8772){var r=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:ht||li(5,s);break;case 1:var n=s.stateNode;if(s.flags&4&&!ht)if(r===null)n.componentDidMount();else{var a=s.elementType===s.type?r.memoizedProps:rs(s.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&t0(s,l,n);break;case 3:var i=s.updateQueue;if(i!==null){if(r=null,s.child!==null)switch(s.child.tag){case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}t0(s,i,r)}break;case 5:var o=s.stateNode;if(r===null&&s.flags&4){r=o;var d=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&r.focus();break;case"img":d.src&&(r.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var c=s.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&xa(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}ht||s.flags&512&&Uo(s)}catch(b){Ve(s,s.return,b)}}if(s===e){X=null;break}if(r=s.sibling,r!==null){r.return=s.return,X=r;break}X=s.return}}function y0(e){for(;X!==null;){var s=X;if(s===e){X=null;break}var r=s.sibling;if(r!==null){r.return=s.return,X=r;break}X=s.return}}function b0(e){for(;X!==null;){var s=X;try{switch(s.tag){case 0:case 11:case 15:var r=s.return;try{li(4,s)}catch(d){Ve(s,r,d)}break;case 1:var n=s.stateNode;if(typeof n.componentDidMount=="function"){var a=s.return;try{n.componentDidMount()}catch(d){Ve(s,a,d)}}var l=s.return;try{Uo(s)}catch(d){Ve(s,l,d)}break;case 5:var i=s.return;try{Uo(s)}catch(d){Ve(s,i,d)}}}catch(d){Ve(s,s.return,d)}if(s===e){X=null;break}var o=s.sibling;if(o!==null){o.return=s.return,X=o;break}X=s.return}}var cf=Math.ceil,Fl=Is.ReactCurrentDispatcher,Bc=Is.ReactCurrentOwner,Yt=Is.ReactCurrentBatchConfig,_e=0,lt=null,Qe=null,ct=0,Dt=0,nn=jr(0),tt=0,_a=null,zr=0,ii=0,Hc=0,la=null,Ct=null,Vc=0,yn=1/0,ks=null,Bl=!1,Ho=null,mr=null,Ya=!1,lr=null,Hl=0,ia=0,Vo=null,ml=-1,xl=0;function Nt(){return _e&6?qe():ml!==-1?ml:ml=qe()}function xr(e){return e.mode&1?_e&2&&ct!==0?ct&-ct:qg.transition!==null?(xl===0&&(xl=Dm()),xl):(e=Te,e!==0||(e=window.event,e=e===void 0?16:Hm(e.type)),e):1}function is(e,s,r,n){if(50<ia)throw ia=0,Vo=null,Error(U(185));Sa(e,r,n),(!(_e&2)||e!==lt)&&(e===lt&&(!(_e&2)&&(ii|=r),tt===4&&rr(e,ct)),Rt(e,n),r===1&&_e===0&&!(s.mode&1)&&(yn=qe()+500,ri&&vr()))}function Rt(e,s){var r=e.callbackNode;qh(e,s);var n=Sl(e,e===lt?ct:0);if(n===0)r!==null&&Eu(r),e.callbackNode=null,e.callbackPriority=0;else if(s=n&-n,e.callbackPriority!==s){if(r!=null&&Eu(r),s===1)e.tag===0?Vg(j0.bind(null,e)):ox(j0.bind(null,e)),Ug(function(){!(_e&6)&&vr()}),r=null;else{switch(Im(n)){case 1:r=gc;break;case 4:r=Mm;break;case 16:r=kl;break;case 536870912:r=$m;break;default:r=kl}r=lp(r,Zx.bind(null,e))}e.callbackPriority=s,e.callbackNode=r}}function Zx(e,s){if(ml=-1,xl=0,_e&6)throw Error(U(327));var r=e.callbackNode;if(un()&&e.callbackNode!==r)return null;var n=Sl(e,e===lt?ct:0);if(n===0)return null;if(n&30||n&e.expiredLanes||s)s=Vl(e,n);else{s=n;var a=_e;_e|=2;var l=tp();(lt!==e||ct!==s)&&(ks=null,yn=qe()+500,Pr(e,s));do try{mf();break}catch(o){ep(e,o)}while(!0);Tc(),Fl.current=l,_e=a,Qe!==null?s=0:(lt=null,ct=0,s=tt)}if(s!==0){if(s===2&&(a=fo(e),a!==0&&(n=a,s=qo(e,a))),s===1)throw r=_a,Pr(e,0),rr(e,n),Rt(e,qe()),r;if(s===6)rr(e,n);else{if(a=e.current.alternate,!(n&30)&&!df(a)&&(s=Vl(e,n),s===2&&(l=fo(e),l!==0&&(n=l,s=qo(e,l))),s===1))throw r=_a,Pr(e,0),rr(e,n),Rt(e,qe()),r;switch(e.finishedWork=a,e.finishedLanes=n,s){case 0:case 1:throw Error(U(345));case 2:Cr(e,Ct,ks);break;case 3:if(rr(e,n),(n&130023424)===n&&(s=Vc+500-qe(),10<s)){if(Sl(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){Nt(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ko(Cr.bind(null,e,Ct,ks),s);break}Cr(e,Ct,ks);break;case 4:if(rr(e,n),(n&4194240)===n)break;for(s=e.eventTimes,a=-1;0<n;){var i=31-ls(n);l=1<<i,i=s[i],i>a&&(a=i),n&=~l}if(n=a,n=qe()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*cf(n/1960))-n,10<n){e.timeoutHandle=ko(Cr.bind(null,e,Ct,ks),n);break}Cr(e,Ct,ks);break;case 5:Cr(e,Ct,ks);break;default:throw Error(U(329))}}}return Rt(e,qe()),e.callbackNode===r?Zx.bind(null,e):null}function qo(e,s){var r=la;return e.current.memoizedState.isDehydrated&&(Pr(e,s).flags|=256),e=Vl(e,s),e!==2&&(s=Ct,Ct=r,s!==null&&Wo(s)),e}function Wo(e){Ct===null?Ct=e:Ct.push.apply(Ct,e)}function df(e){for(var s=e;;){if(s.flags&16384){var r=s.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],l=a.getSnapshot;a=a.value;try{if(!cs(l(),a))return!1}catch{return!1}}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===e)break;for(;s.sibling===null;){if(s.return===null||s.return===e)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function rr(e,s){for(s&=~Hc,s&=~ii,e.suspendedLanes|=s,e.pingedLanes&=~s,e=e.expirationTimes;0<s;){var r=31-ls(s),n=1<<r;e[r]=-1,s&=~n}}function j0(e){if(_e&6)throw Error(U(327));un();var s=Sl(e,0);if(!(s&1))return Rt(e,qe()),null;var r=Vl(e,s);if(e.tag!==0&&r===2){var n=fo(e);n!==0&&(s=n,r=qo(e,n))}if(r===1)throw r=_a,Pr(e,0),rr(e,s),Rt(e,qe()),r;if(r===6)throw Error(U(345));return e.finishedWork=e.current.alternate,e.finishedLanes=s,Cr(e,Ct,ks),Rt(e,qe()),null}function qc(e,s){var r=_e;_e|=1;try{return e(s)}finally{_e=r,_e===0&&(yn=qe()+500,ri&&vr())}}function Ur(e){lr!==null&&lr.tag===0&&!(_e&6)&&un();var s=_e;_e|=1;var r=Yt.transition,n=Te;try{if(Yt.transition=null,Te=1,e)return e()}finally{Te=n,Yt.transition=r,_e=s,!(_e&6)&&vr()}}function Wc(){Dt=nn.current,Oe(nn)}function Pr(e,s){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,zg(r)),Qe!==null)for(r=Qe.return;r!==null;){var n=r;switch(Sc(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Rl();break;case 3:gn(),Oe(Tt),Oe(yt),$c();break;case 5:Mc(n);break;case 4:gn();break;case 13:Oe(Ue);break;case 19:Oe(Ue);break;case 10:Ac(n.type._context);break;case 22:case 23:Wc()}r=r.return}if(lt=e,Qe=e=pr(e.current,null),ct=Dt=s,tt=0,_a=null,Hc=ii=zr=0,Ct=la=null,Ar!==null){for(s=0;s<Ar.length;s++)if(r=Ar[s],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,l=r.pending;if(l!==null){var i=l.next;l.next=a,n.next=i}r.pending=n}Ar=null}return e}function ep(e,s){do{var r=Qe;try{if(Tc(),cl.current=Ul,zl){for(var n=Fe.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}zl=!1}if(Or=0,rt=Je=Fe=null,na=!1,va=0,Bc.current=null,r===null||r.return===null){tt=1,_a=s,Qe=null;break}e:{var l=e,i=r.return,o=r,d=s;if(s=ct,o.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var c=d,u=o,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var b=u.alternate;b?(u.updateQueue=b.updateQueue,u.memoizedState=b.memoizedState,u.lanes=b.lanes):(u.updateQueue=null,u.memoizedState=null)}var w=i0(i);if(w!==null){w.flags&=-257,o0(w,i,o,l,s),w.mode&1&&l0(l,c,s),s=w,d=c;var f=s.updateQueue;if(f===null){var y=new Set;y.add(d),s.updateQueue=y}else f.add(d);break e}else{if(!(s&1)){l0(l,c,s),Kc();break e}d=Error(U(426))}}else if(ze&&o.mode&1){var v=i0(i);if(v!==null){!(v.flags&65536)&&(v.flags|=256),o0(v,i,o,l,s),Cc(fn(d,o));break e}}l=d=fn(d,o),tt!==4&&(tt=2),la===null?la=[l]:la.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var g=Ix(l,d,s);e0(l,g);break e;case 1:o=d;var p=l.type,x=l.stateNode;if(!(l.flags&128)&&(typeof p.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(mr===null||!mr.has(x)))){l.flags|=65536,s&=-s,l.lanes|=s;var N=Ox(l,o,s);e0(l,N);break e}}l=l.return}while(l!==null)}rp(r)}catch(j){s=j,Qe===r&&r!==null&&(Qe=r=r.return);continue}break}while(!0)}function tp(){var e=Fl.current;return Fl.current=Ul,e===null?Ul:e}function Kc(){(tt===0||tt===3||tt===2)&&(tt=4),lt===null||!(zr&268435455)&&!(ii&268435455)||rr(lt,ct)}function Vl(e,s){var r=_e;_e|=2;var n=tp();(lt!==e||ct!==s)&&(ks=null,Pr(e,s));do try{uf();break}catch(a){ep(e,a)}while(!0);if(Tc(),_e=r,Fl.current=n,Qe!==null)throw Error(U(261));return lt=null,ct=0,tt}function uf(){for(;Qe!==null;)sp(Qe)}function mf(){for(;Qe!==null&&!Dh();)sp(Qe)}function sp(e){var s=ap(e.alternate,e,Dt);e.memoizedProps=e.pendingProps,s===null?rp(e):Qe=s,Bc.current=null}function rp(e){var s=e;do{var r=s.alternate;if(e=s.return,s.flags&32768){if(r=nf(r,s),r!==null){r.flags&=32767,Qe=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{tt=6,Qe=null;return}}else if(r=rf(r,s,Dt),r!==null){Qe=r;return}if(s=s.sibling,s!==null){Qe=s;return}Qe=s=e}while(s!==null);tt===0&&(tt=5)}function Cr(e,s,r){var n=Te,a=Yt.transition;try{Yt.transition=null,Te=1,xf(e,s,r,n)}finally{Yt.transition=a,Te=n}return null}function xf(e,s,r,n){do un();while(lr!==null);if(_e&6)throw Error(U(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(U(177));e.callbackNode=null,e.callbackPriority=0;var l=r.lanes|r.childLanes;if(Wh(e,l),e===lt&&(Qe=lt=null,ct=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ya||(Ya=!0,lp(kl,function(){return un(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=Yt.transition,Yt.transition=null;var i=Te;Te=1;var o=_e;_e|=4,Bc.current=null,lf(e,r),Yx(r,e),Lg(wo),Cl=!!No,wo=No=null,e.current=r,of(r),Ih(),_e=o,Te=i,Yt.transition=l}else e.current=r;if(Ya&&(Ya=!1,lr=e,Hl=a),l=e.pendingLanes,l===0&&(mr=null),Uh(r.stateNode),Rt(e,qe()),s!==null)for(n=e.onRecoverableError,r=0;r<s.length;r++)a=s[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Bl)throw Bl=!1,e=Ho,Ho=null,e;return Hl&1&&e.tag!==0&&un(),l=e.pendingLanes,l&1?e===Vo?ia++:(ia=0,Vo=e):ia=0,vr(),null}function un(){if(lr!==null){var e=Im(Hl),s=Yt.transition,r=Te;try{if(Yt.transition=null,Te=16>e?16:e,lr===null)var n=!1;else{if(e=lr,lr=null,Hl=0,_e&6)throw Error(U(331));var a=_e;for(_e|=4,X=e.current;X!==null;){var l=X,i=l.child;if(X.flags&16){var o=l.deletions;if(o!==null){for(var d=0;d<o.length;d++){var c=o[d];for(X=c;X!==null;){var u=X;switch(u.tag){case 0:case 11:case 15:aa(8,u,l)}var h=u.child;if(h!==null)h.return=u,X=h;else for(;X!==null;){u=X;var b=u.sibling,w=u.return;if(Qx(u),u===c){X=null;break}if(b!==null){b.return=w,X=b;break}X=w}}}var f=l.alternate;if(f!==null){var y=f.child;if(y!==null){f.child=null;do{var v=y.sibling;y.sibling=null,y=v}while(y!==null)}}X=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,X=i;else e:for(;X!==null;){if(l=X,l.flags&2048)switch(l.tag){case 0:case 11:case 15:aa(9,l,l.return)}var g=l.sibling;if(g!==null){g.return=l.return,X=g;break e}X=l.return}}var p=e.current;for(X=p;X!==null;){i=X;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,X=x;else e:for(i=p;X!==null;){if(o=X,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:li(9,o)}}catch(j){Ve(o,o.return,j)}if(o===i){X=null;break e}var N=o.sibling;if(N!==null){N.return=o.return,X=N;break e}X=o.return}}if(_e=a,vr(),js&&typeof js.onPostCommitFiberRoot=="function")try{js.onPostCommitFiberRoot(Jl,e)}catch{}n=!0}return n}finally{Te=r,Yt.transition=s}}return!1}function v0(e,s,r){s=fn(r,s),s=Ix(e,s,1),e=ur(e,s,1),s=Nt(),e!==null&&(Sa(e,1,s),Rt(e,s))}function Ve(e,s,r){if(e.tag===3)v0(e,e,r);else for(;s!==null;){if(s.tag===3){v0(s,e,r);break}else if(s.tag===1){var n=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(mr===null||!mr.has(n))){e=fn(r,e),e=Ox(s,e,1),s=ur(s,e,1),e=Nt(),s!==null&&(Sa(s,1,e),Rt(s,e));break}}s=s.return}}function pf(e,s,r){var n=e.pingCache;n!==null&&n.delete(s),s=Nt(),e.pingedLanes|=e.suspendedLanes&r,lt===e&&(ct&r)===r&&(tt===4||tt===3&&(ct&130023424)===ct&&500>qe()-Vc?Pr(e,0):Hc|=r),Rt(e,s)}function np(e,s){s===0&&(e.mode&1?(s=Fa,Fa<<=1,!(Fa&130023424)&&(Fa=4194304)):s=1);var r=Nt();e=Ms(e,s),e!==null&&(Sa(e,s,r),Rt(e,r))}function hf(e){var s=e.memoizedState,r=0;s!==null&&(r=s.retryLane),np(e,r)}function gf(e,s){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(U(314))}n!==null&&n.delete(s),np(e,r)}var ap;ap=function(e,s,r){if(e!==null)if(e.memoizedProps!==s.pendingProps||Tt.current)Et=!0;else{if(!(e.lanes&r)&&!(s.flags&128))return Et=!1,sf(e,s,r);Et=!!(e.flags&131072)}else Et=!1,ze&&s.flags&1048576&&cx(s,Ml,s.index);switch(s.lanes=0,s.tag){case 2:var n=s.type;ul(e,s),e=s.pendingProps;var a=xn(s,yt.current);dn(s,r),a=Ic(null,s,n,e,a,r);var l=Oc();return s.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,At(n)?(l=!0,Ll(s)):l=!1,s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,Lc(s),a.updater=ai,s.stateNode=a,a._reactInternals=s,Lo(s,n,e,r),s=$o(null,s,n,!0,l,r)):(s.tag=0,ze&&l&&kc(s),bt(null,s,a,r),s=s.child),s;case 16:n=s.elementType;e:{switch(ul(e,s),e=s.pendingProps,a=n._init,n=a(n._payload),s.type=n,a=s.tag=yf(n),e=rs(n,e),a){case 0:s=Mo(null,s,n,e,r);break e;case 1:s=u0(null,s,n,e,r);break e;case 11:s=c0(null,s,n,e,r);break e;case 14:s=d0(null,s,n,rs(n.type,e),r);break e}throw Error(U(306,n,""))}return s;case 0:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:rs(n,a),Mo(e,s,n,a,r);case 1:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:rs(n,a),u0(e,s,n,a,r);case 3:e:{if(Bx(s),e===null)throw Error(U(387));n=s.pendingProps,l=s.memoizedState,a=l.element,hx(e,s),Il(s,n,null,r);var i=s.memoizedState;if(n=i.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){a=fn(Error(U(423)),s),s=m0(e,s,n,r,a);break e}else if(n!==a){a=fn(Error(U(424)),s),s=m0(e,s,n,r,a);break e}else for(It=dr(s.stateNode.containerInfo.firstChild),zt=s,ze=!0,as=null,r=xx(s,null,n,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(pn(),n===a){s=$s(e,s,r);break e}bt(e,s,n,r)}s=s.child}return s;case 5:return gx(s),e===null&&To(s),n=s.type,a=s.pendingProps,l=e!==null?e.memoizedProps:null,i=a.children,_o(n,a)?i=null:l!==null&&_o(n,l)&&(s.flags|=32),Fx(e,s),bt(e,s,i,r),s.child;case 6:return e===null&&To(s),null;case 13:return Hx(e,s,r);case 4:return Pc(s,s.stateNode.containerInfo),n=s.pendingProps,e===null?s.child=hn(s,null,n,r):bt(e,s,n,r),s.child;case 11:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:rs(n,a),c0(e,s,n,a,r);case 7:return bt(e,s,s.pendingProps,r),s.child;case 8:return bt(e,s,s.pendingProps.children,r),s.child;case 12:return bt(e,s,s.pendingProps.children,r),s.child;case 10:e:{if(n=s.type._context,a=s.pendingProps,l=s.memoizedProps,i=a.value,Re($l,n._currentValue),n._currentValue=i,l!==null)if(cs(l.value,i)){if(l.children===a.children&&!Tt.current){s=$s(e,s,r);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var o=l.dependencies;if(o!==null){i=l.child;for(var d=o.firstContext;d!==null;){if(d.context===n){if(l.tag===1){d=As(-1,r&-r),d.tag=2;var c=l.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?d.next=d:(d.next=u.next,u.next=d),c.pending=d}}l.lanes|=r,d=l.alternate,d!==null&&(d.lanes|=r),Ao(l.return,r,s),o.lanes|=r;break}d=d.next}}else if(l.tag===10)i=l.type===s.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(U(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Ao(i,r,s),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===s){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}bt(e,s,a.children,r),s=s.child}return s;case 9:return a=s.type,n=s.pendingProps.children,dn(s,r),a=Jt(a),n=n(a),s.flags|=1,bt(e,s,n,r),s.child;case 14:return n=s.type,a=rs(n,s.pendingProps),a=rs(n.type,a),d0(e,s,n,a,r);case 15:return zx(e,s,s.type,s.pendingProps,r);case 17:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:rs(n,a),ul(e,s),s.tag=1,At(n)?(e=!0,Ll(s)):e=!1,dn(s,r),Dx(s,n,a),Lo(s,n,a,r),$o(null,s,n,!0,e,r);case 19:return Vx(e,s,r);case 22:return Ux(e,s,r)}throw Error(U(156,s.tag))};function lp(e,s){return Pm(e,s)}function ff(e,s,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gt(e,s,r,n){return new ff(e,s,r,n)}function Qc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function yf(e){if(typeof e=="function")return Qc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===xc)return 11;if(e===pc)return 14}return 2}function pr(e,s){var r=e.alternate;return r===null?(r=Gt(e.tag,s,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=s,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,s=e.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function pl(e,s,r,n,a,l){var i=2;if(n=e,typeof e=="function")Qc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Qr:return Mr(r.children,a,l,s);case mc:i=8,a|=8;break;case to:return e=Gt(12,r,s,a|2),e.elementType=to,e.lanes=l,e;case so:return e=Gt(13,r,s,a),e.elementType=so,e.lanes=l,e;case ro:return e=Gt(19,r,s,a),e.elementType=ro,e.lanes=l,e;case gm:return oi(r,a,l,s);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case pm:i=10;break e;case hm:i=9;break e;case xc:i=11;break e;case pc:i=14;break e;case er:i=16,n=null;break e}throw Error(U(130,e==null?e:typeof e,""))}return s=Gt(i,r,s,a),s.elementType=e,s.type=n,s.lanes=l,s}function Mr(e,s,r,n){return e=Gt(7,e,n,s),e.lanes=r,e}function oi(e,s,r,n){return e=Gt(22,e,n,s),e.elementType=gm,e.lanes=r,e.stateNode={isHidden:!1},e}function Vi(e,s,r){return e=Gt(6,e,null,s),e.lanes=r,e}function qi(e,s,r){return s=Gt(4,e.children!==null?e.children:[],e.key,s),s.lanes=r,s.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},s}function bf(e,s,r,n,a){this.tag=s,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ki(0),this.expirationTimes=ki(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ki(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Gc(e,s,r,n,a,l,i,o,d){return e=new bf(e,s,r,o,d),s===1?(s=1,l===!0&&(s|=8)):s=0,l=Gt(3,null,null,s),e.current=l,l.stateNode=e,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lc(l),e}function jf(e,s,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kr,key:n==null?null:""+n,children:e,containerInfo:s,implementation:r}}function ip(e){if(!e)return fr;e=e._reactInternals;e:{if(qr(e)!==e||e.tag!==1)throw Error(U(170));var s=e;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(At(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(U(171))}if(e.tag===1){var r=e.type;if(At(r))return ix(e,r,s)}return s}function op(e,s,r,n,a,l,i,o,d){return e=Gc(r,n,!0,e,a,l,i,o,d),e.context=ip(null),r=e.current,n=Nt(),a=xr(r),l=As(n,a),l.callback=s??null,ur(r,l,a),e.current.lanes=a,Sa(e,a,n),Rt(e,n),e}function ci(e,s,r,n){var a=s.current,l=Nt(),i=xr(a);return r=ip(r),s.context===null?s.context=r:s.pendingContext=r,s=As(l,i),s.payload={element:e},n=n===void 0?null:n,n!==null&&(s.callback=n),e=ur(a,s,i),e!==null&&(is(e,a,i,l),ol(e,a,i)),i}function ql(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function N0(e,s){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<s?r:s}}function Xc(e,s){N0(e,s),(e=e.alternate)&&N0(e,s)}function vf(){return null}var cp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}di.prototype.render=Yc.prototype.render=function(e){var s=this._internalRoot;if(s===null)throw Error(U(409));ci(e,s,null,null)};di.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var s=e.containerInfo;Ur(function(){ci(null,e,null,null)}),s[Ps]=null}};function di(e){this._internalRoot=e}di.prototype.unstable_scheduleHydration=function(e){if(e){var s=Um();e={blockedOn:null,target:e,priority:s};for(var r=0;r<sr.length&&s!==0&&s<sr[r].priority;r++);sr.splice(r,0,e),r===0&&Bm(e)}};function Jc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ui(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function w0(){}function Nf(e,s,r,n,a){if(a){if(typeof n=="function"){var l=n;n=function(){var c=ql(i);l.call(c)}}var i=op(s,n,e,0,null,!1,!1,"",w0);return e._reactRootContainer=i,e[Ps]=i.current,ga(e.nodeType===8?e.parentNode:e),Ur(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=ql(d);o.call(c)}}var d=Gc(e,0,!1,null,null,!1,!1,"",w0);return e._reactRootContainer=d,e[Ps]=d.current,ga(e.nodeType===8?e.parentNode:e),Ur(function(){ci(s,d,r,n)}),d}function mi(e,s,r,n,a){var l=r._reactRootContainer;if(l){var i=l;if(typeof a=="function"){var o=a;a=function(){var d=ql(i);o.call(d)}}ci(s,i,e,a)}else i=Nf(r,s,e,a,n);return ql(i)}Om=function(e){switch(e.tag){case 3:var s=e.stateNode;if(s.current.memoizedState.isDehydrated){var r=Yn(s.pendingLanes);r!==0&&(fc(s,r|1),Rt(s,qe()),!(_e&6)&&(yn=qe()+500,vr()))}break;case 13:Ur(function(){var n=Ms(e,1);if(n!==null){var a=Nt();is(n,e,1,a)}}),Xc(e,1)}};yc=function(e){if(e.tag===13){var s=Ms(e,134217728);if(s!==null){var r=Nt();is(s,e,134217728,r)}Xc(e,134217728)}};zm=function(e){if(e.tag===13){var s=xr(e),r=Ms(e,s);if(r!==null){var n=Nt();is(r,e,s,n)}Xc(e,s)}};Um=function(){return Te};Fm=function(e,s){var r=Te;try{return Te=e,s()}finally{Te=r}};po=function(e,s,r){switch(s){case"input":if(lo(e,r),s=r.name,r.type==="radio"&&s!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<r.length;s++){var n=r[s];if(n!==e&&n.form===e.form){var a=si(n);if(!a)throw Error(U(90));ym(n),lo(n,a)}}}break;case"textarea":jm(e,r);break;case"select":s=r.value,s!=null&&an(e,!!r.multiple,s,!1)}};Cm=qc;Em=Ur;var wf={usingClientEntryPoint:!1,Events:[Ea,Jr,si,km,Sm,qc]},Kn={findFiberByHostInstance:Tr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},_f={bundleType:Kn.bundleType,version:Kn.version,rendererPackageName:Kn.rendererPackageName,rendererConfig:Kn.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Is.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=Rm(e),e===null?null:e.stateNode},findFiberByHostInstance:Kn.findFiberByHostInstance||vf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ja=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ja.isDisabled&&Ja.supportsFiber)try{Jl=Ja.inject(_f),js=Ja}catch{}}Bt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wf;Bt.createPortal=function(e,s){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jc(s))throw Error(U(200));return jf(e,s,null,r)};Bt.createRoot=function(e,s){if(!Jc(e))throw Error(U(299));var r=!1,n="",a=cp;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(a=s.onRecoverableError)),s=Gc(e,1,!1,null,null,r,!1,n,a),e[Ps]=s.current,ga(e.nodeType===8?e.parentNode:e),new Yc(s)};Bt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var s=e._reactInternals;if(s===void 0)throw typeof e.render=="function"?Error(U(188)):(e=Object.keys(e).join(","),Error(U(268,e)));return e=Rm(s),e=e===null?null:e.stateNode,e};Bt.flushSync=function(e){return Ur(e)};Bt.hydrate=function(e,s,r){if(!ui(s))throw Error(U(200));return mi(null,e,s,!0,r)};Bt.hydrateRoot=function(e,s,r){if(!Jc(e))throw Error(U(405));var n=r!=null&&r.hydratedSources||null,a=!1,l="",i=cp;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),s=op(s,null,e,1,r??null,a,!1,l,i),e[Ps]=s.current,ga(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[r,a]:s.mutableSourceEagerHydrationData.push(r,a);return new di(s)};Bt.render=function(e,s,r){if(!ui(s))throw Error(U(200));return mi(null,e,s,!1,r)};Bt.unmountComponentAtNode=function(e){if(!ui(e))throw Error(U(40));return e._reactRootContainer?(Ur(function(){mi(null,null,e,!1,function(){e._reactRootContainer=null,e[Ps]=null})}),!0):!1};Bt.unstable_batchedUpdates=qc;Bt.unstable_renderSubtreeIntoContainer=function(e,s,r,n){if(!ui(r))throw Error(U(200));if(e==null||e._reactInternals===void 0)throw Error(U(38));return mi(e,s,r,!1,n)};Bt.version="18.3.1-next-f1338f8080-20240426";function dp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dp)}catch(e){console.error(e)}}dp(),dm.exports=Bt;var kf=dm.exports,_0=kf;Zi.createRoot=_0.createRoot,Zi.hydrateRoot=_0.hydrateRoot;let Sf={data:""},Cf=e=>{if(typeof window=="object"){let s=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return s.nonce=window.__nonce__,s.parentNode||(e||document.head).appendChild(s),s.firstChild}return e||Sf},Ef=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Tf=/\/\*[^]*?\*\/|  +/g,k0=/\n+/g,nr=(e,s)=>{let r="",n="",a="";for(let l in e){let i=e[l];l[0]=="@"?l[1]=="i"?r=l+" "+i+";":n+=l[1]=="f"?nr(i,l):l+"{"+nr(i,l[1]=="k"?"":s)+"}":typeof i=="object"?n+=nr(i,s?s.replace(/([^,])+/g,o=>l.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,o):o?o+" "+d:d)):l):i!=null&&(l=/^--/.test(l)?l:l.replace(/[A-Z]/g,"-$&").toLowerCase(),a+=nr.p?nr.p(l,i):l+":"+i+";")}return r+(s&&a?s+"{"+a+"}":a)+n},_s={},up=e=>{if(typeof e=="object"){let s="";for(let r in e)s+=r+up(e[r]);return s}return e},Af=(e,s,r,n,a)=>{let l=up(e),i=_s[l]||(_s[l]=(d=>{let c=0,u=11;for(;c<d.length;)u=101*u+d.charCodeAt(c++)>>>0;return"go"+u})(l));if(!_s[i]){let d=l!==e?e:(c=>{let u,h,b=[{}];for(;u=Ef.exec(c.replace(Tf,""));)u[4]?b.shift():u[3]?(h=u[3].replace(k0," ").trim(),b.unshift(b[0][h]=b[0][h]||{})):b[0][u[1]]=u[2].replace(k0," ").trim();return b[0]})(e);_s[i]=nr(a?{["@keyframes "+i]:d}:d,r?"":"."+i)}let o=r&&_s.g?_s.g:null;return r&&(_s.g=_s[i]),((d,c,u,h)=>{h?c.data=c.data.replace(h,d):c.data.indexOf(d)===-1&&(c.data=u?d+c.data:c.data+d)})(_s[i],s,n,o),i},Rf=(e,s,r)=>e.reduce((n,a,l)=>{let i=s[l];if(i&&i.call){let o=i(r),d=o&&o.props&&o.props.className||/^go/.test(o)&&o;i=d?"."+d:o&&typeof o=="object"?o.props?"":nr(o,""):o===!1?"":o}return n+a+(i??"")},"");function xi(e){let s=this||{},r=e.call?e(s.p):e;return Af(r.unshift?r.raw?Rf(r,[].slice.call(arguments,1),s.p):r.reduce((n,a)=>Object.assign(n,a&&a.call?a(s.p):a),{}):r,Cf(s.target),s.g,s.o,s.k)}let mp,Ko,Qo;xi.bind({g:1});let Ds=xi.bind({k:1});function Lf(e,s,r,n){nr.p=s,mp=e,Ko=r,Qo=n}function Nr(e,s){let r=this||{};return function(){let n=arguments;function a(l,i){let o=Object.assign({},l),d=o.className||a.className;r.p=Object.assign({theme:Ko&&Ko()},o),r.o=/ *go\d+/.test(d),o.className=xi.apply(r,n)+(d?" "+d:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),Qo&&c[0]&&Qo(o),mp(c,o)}return a}}var Pf=e=>typeof e=="function",Wl=(e,s)=>Pf(e)?e(s):e,Mf=(()=>{let e=0;return()=>(++e).toString()})(),xp=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let s=matchMedia("(prefers-reduced-motion: reduce)");e=!s||s.matches}return e}})(),$f=20,Zc="default",pp=(e,s)=>{let{toastLimit:r}=e.settings;switch(s.type){case 0:return{...e,toasts:[s.toast,...e.toasts].slice(0,r)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===s.toast.id?{...i,...s.toast}:i)};case 2:let{toast:n}=s;return pp(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:a}=s;return{...e,toasts:e.toasts.map(i=>i.id===a||a===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return s.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==s.toastId)};case 5:return{...e,pausedAt:s.time};case 6:let l=s.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+l}))}}},hl=[],hp={toasts:[],pausedAt:void 0,settings:{toastLimit:$f}},ys={},gp=(e,s=Zc)=>{ys[s]=pp(ys[s]||hp,e),hl.forEach(([r,n])=>{r===s&&n(ys[s])})},fp=e=>Object.keys(ys).forEach(s=>gp(e,s)),Df=e=>Object.keys(ys).find(s=>ys[s].toasts.some(r=>r.id===e)),pi=(e=Zc)=>s=>{gp(s,e)},If={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Of=(e={},s=Zc)=>{let[r,n]=k.useState(ys[s]||hp),a=k.useRef(ys[s]);k.useEffect(()=>(a.current!==ys[s]&&n(ys[s]),hl.push([s,n]),()=>{let i=hl.findIndex(([o])=>o===s);i>-1&&hl.splice(i,1)}),[s]);let l=r.toasts.map(i=>{var o,d,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((o=e[i.type])==null?void 0:o.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((d=e[i.type])==null?void 0:d.duration)||(e==null?void 0:e.duration)||If[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...r,toasts:l}},zf=(e,s="blank",r)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:s,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...r,id:(r==null?void 0:r.id)||Mf()}),Aa=e=>(s,r)=>{let n=zf(s,e,r);return pi(n.toasterId||Df(n.id))({type:2,toast:n}),n.id},ie=(e,s)=>Aa("blank")(e,s);ie.error=Aa("error");ie.success=Aa("success");ie.loading=Aa("loading");ie.custom=Aa("custom");ie.dismiss=(e,s)=>{let r={type:3,toastId:e};s?pi(s)(r):fp(r)};ie.dismissAll=e=>ie.dismiss(void 0,e);ie.remove=(e,s)=>{let r={type:4,toastId:e};s?pi(s)(r):fp(r)};ie.removeAll=e=>ie.remove(void 0,e);ie.promise=(e,s,r)=>{let n=ie.loading(s.loading,{...r,...r==null?void 0:r.loading});return typeof e=="function"&&(e=e()),e.then(a=>{let l=s.success?Wl(s.success,a):void 0;return l?ie.success(l,{id:n,...r,...r==null?void 0:r.success}):ie.dismiss(n),a}).catch(a=>{let l=s.error?Wl(s.error,a):void 0;l?ie.error(l,{id:n,...r,...r==null?void 0:r.error}):ie.dismiss(n)}),e};var Uf=1e3,Ff=(e,s="default")=>{let{toasts:r,pausedAt:n}=Of(e,s),a=k.useRef(new Map).current,l=k.useCallback((h,b=Uf)=>{if(a.has(h))return;let w=setTimeout(()=>{a.delete(h),i({type:4,toastId:h})},b);a.set(h,w)},[]);k.useEffect(()=>{if(n)return;let h=Date.now(),b=r.map(w=>{if(w.duration===1/0)return;let f=(w.duration||0)+w.pauseDuration-(h-w.createdAt);if(f<0){w.visible&&ie.dismiss(w.id);return}return setTimeout(()=>ie.dismiss(w.id,s),f)});return()=>{b.forEach(w=>w&&clearTimeout(w))}},[r,n,s]);let i=k.useCallback(pi(s),[s]),o=k.useCallback(()=>{i({type:5,time:Date.now()})},[i]),d=k.useCallback((h,b)=>{i({type:1,toast:{id:h,height:b}})},[i]),c=k.useCallback(()=>{n&&i({type:6,time:Date.now()})},[n,i]),u=k.useCallback((h,b)=>{let{reverseOrder:w=!1,gutter:f=8,defaultPosition:y}=b||{},v=r.filter(x=>(x.position||y)===(h.position||y)&&x.height),g=v.findIndex(x=>x.id===h.id),p=v.filter((x,N)=>N<g&&x.visible).length;return v.filter(x=>x.visible).slice(...w?[p+1]:[0,p]).reduce((x,N)=>x+(N.height||0)+f,0)},[r]);return k.useEffect(()=>{r.forEach(h=>{if(h.dismissed)l(h.id,h.removeDelay);else{let b=a.get(h.id);b&&(clearTimeout(b),a.delete(h.id))}})},[r,l]),{toasts:r,handlers:{updateHeight:d,startPause:o,endPause:c,calculateOffset:u}}},Bf=Ds`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Hf=Ds`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Vf=Ds`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,qf=Nr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Bf} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Hf} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Vf} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Wf=Ds`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Kf=Nr("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Wf} 1s linear infinite;
`,Qf=Ds`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Gf=Ds`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Xf=Nr("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Qf} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Gf} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Yf=Nr("div")`
  position: absolute;
`,Jf=Nr("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Zf=Ds`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,ey=Nr("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Zf} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ty=({toast:e})=>{let{icon:s,type:r,iconTheme:n}=e;return s!==void 0?typeof s=="string"?k.createElement(ey,null,s):s:r==="blank"?null:k.createElement(Jf,null,k.createElement(Kf,{...n}),r!=="loading"&&k.createElement(Yf,null,r==="error"?k.createElement(qf,{...n}):k.createElement(Xf,{...n})))},sy=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ry=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,ny="0%{opacity:0;} 100%{opacity:1;}",ay="0%{opacity:1;} 100%{opacity:0;}",ly=Nr("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,iy=Nr("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,oy=(e,s)=>{let r=e.includes("top")?1:-1,[n,a]=xp()?[ny,ay]:[sy(r),ry(r)];return{animation:s?`${Ds(n)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ds(a)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},cy=k.memo(({toast:e,position:s,style:r,children:n})=>{let a=e.height?oy(e.position||s||"top-center",e.visible):{opacity:0},l=k.createElement(ty,{toast:e}),i=k.createElement(iy,{...e.ariaProps},Wl(e.message,e));return k.createElement(ly,{className:e.className,style:{...a,...r,...e.style}},typeof n=="function"?n({icon:l,message:i}):k.createElement(k.Fragment,null,l,i))});Lf(k.createElement);var dy=({id:e,className:s,style:r,onHeightUpdate:n,children:a})=>{let l=k.useCallback(i=>{if(i){let o=()=>{let d=i.getBoundingClientRect().height;n(e,d)};o(),new MutationObserver(o).observe(i,{subtree:!0,childList:!0,characterData:!0})}},[e,n]);return k.createElement("div",{ref:l,className:s,style:r},a)},uy=(e,s)=>{let r=e.includes("top"),n=r?{top:0}:{bottom:0},a=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:xp()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${s*(r?1:-1)}px)`,...n,...a}},my=xi`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Za=16,xy=({reverseOrder:e,position:s="top-center",toastOptions:r,gutter:n,children:a,toasterId:l,containerStyle:i,containerClassName:o})=>{let{toasts:d,handlers:c}=Ff(r,l);return k.createElement("div",{"data-rht-toaster":l||"",style:{position:"fixed",zIndex:9999,top:Za,left:Za,right:Za,bottom:Za,pointerEvents:"none",...i},className:o,onMouseEnter:c.startPause,onMouseLeave:c.endPause},d.map(u=>{let h=u.position||s,b=c.calculateOffset(u,{reverseOrder:e,gutter:n,defaultPosition:s}),w=uy(h,b);return k.createElement(dy,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?my:"",style:w},u.type==="custom"?Wl(u.message,u):a?a(u):k.createElement(cy,{toast:u,position:h}))}))},qt=ie;/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var py={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),K=(e,s)=>{const r=k.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:o="",children:d,...c},u)=>k.createElement("svg",{ref:u,...py,width:a,height:a,stroke:n,strokeWidth:i?Number(l)*24/Number(a):l,className:["lucide",`lucide-${hy(e)}`,o].join(" "),...c},[...s.map(([h,b])=>k.createElement(h,b)),...Array.isArray(d)?d:[d]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ed=K("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bn=K("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gy=K("AlertOctagon",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=K("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S0=K("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=K("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=K("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=K("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=K("BookOpen",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=K("Brain",[["path",{d:"M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z",key:"1mhkh5"}],["path",{d:"M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z",key:"1d6s00"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yp=K("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=K("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const by=K("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=K("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=K("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=K("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=K("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=K("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const td=K("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=K("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=K("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bp=K("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=K("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=K("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=K("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jy=K("Cpu",[["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"9",y:"9",width:"6",height:"6",key:"o3kz5p"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ze=K("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=K("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=K("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ye=K("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ny=K("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=K("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wi=K("FileCode",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 13-2 2 2 2",key:"17smn8"}],["path",{d:"m14 17 2-2-2-2",key:"14mezr"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=K("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gl=K("FileWarning",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=K("FileX",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wy=K("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=K("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=K("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xo=K("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vp=K("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=K("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ts=K("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=K("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=K("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ky=K("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=K("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=K("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yr=K("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Np=K("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=K("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=K("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=K("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sy=K("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=K("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cy=K("MinusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=K("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=K("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=K("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=K("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wp=K("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=K("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=K("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=K("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jo=K("ShieldAlert",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zo=K("ShieldCheck",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=K("ShieldX",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"m14.5 9-5 5",key:"1m49dw"}],["path",{d:"m9.5 9 5 5",key:"wyx7zg"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=K("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ec=K("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=K("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yl=K("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=K("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ey=K("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _p=K("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kp=K("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sp=K("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=K("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=K("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=K("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.323.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ty=K("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);function Cp(e,s){return function(){return e.apply(s,arguments)}}const{toString:Ay}=Object.prototype,{getPrototypeOf:rd}=Object,{iterator:hi,toStringTag:Ep}=Symbol,gi=(e=>s=>{const r=Ay.call(s);return e[r]||(e[r]=r.slice(8,-1).toLowerCase())})(Object.create(null)),ds=e=>(e=e.toLowerCase(),s=>gi(s)===e),fi=e=>s=>typeof s===e,{isArray:Sn}=Array,vn=fi("undefined");function Ra(e){return e!==null&&!vn(e)&&e.constructor!==null&&!vn(e.constructor)&&Lt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Tp=ds("ArrayBuffer");function Ry(e){let s;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?s=ArrayBuffer.isView(e):s=e&&e.buffer&&Tp(e.buffer),s}const Ly=fi("string"),Lt=fi("function"),Ap=fi("number"),La=e=>e!==null&&typeof e=="object",Py=e=>e===!0||e===!1,bl=e=>{if(gi(e)!=="object")return!1;const s=rd(e);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Ep in e)&&!(hi in e)},My=e=>{if(!La(e)||Ra(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},$y=ds("Date"),Dy=ds("File"),Iy=ds("Blob"),Oy=ds("FileList"),zy=e=>La(e)&&Lt(e.pipe),Uy=e=>{let s;return e&&(typeof FormData=="function"&&e instanceof FormData||Lt(e.append)&&((s=gi(e))==="formdata"||s==="object"&&Lt(e.toString)&&e.toString()==="[object FormData]"))},Fy=ds("URLSearchParams"),[By,Hy,Vy,qy]=["ReadableStream","Request","Response","Headers"].map(ds),Wy=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Pa(e,s,{allOwnKeys:r=!1}={}){if(e===null||typeof e>"u")return;let n,a;if(typeof e!="object"&&(e=[e]),Sn(e))for(n=0,a=e.length;n<a;n++)s.call(null,e[n],n,e);else{if(Ra(e))return;const l=r?Object.getOwnPropertyNames(e):Object.keys(e),i=l.length;let o;for(n=0;n<i;n++)o=l[n],s.call(null,e[o],o,e)}}function Rp(e,s){if(Ra(e))return null;s=s.toLowerCase();const r=Object.keys(e);let n=r.length,a;for(;n-- >0;)if(a=r[n],s===a.toLowerCase())return a;return null}const Lr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Lp=e=>!vn(e)&&e!==Lr;function tc(){const{caseless:e,skipUndefined:s}=Lp(this)&&this||{},r={},n=(a,l)=>{const i=e&&Rp(r,l)||l;bl(r[i])&&bl(a)?r[i]=tc(r[i],a):bl(a)?r[i]=tc({},a):Sn(a)?r[i]=a.slice():(!s||!vn(a))&&(r[i]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Pa(arguments[a],n);return r}const Ky=(e,s,r,{allOwnKeys:n}={})=>(Pa(s,(a,l)=>{r&&Lt(a)?e[l]=Cp(a,r):e[l]=a},{allOwnKeys:n}),e),Qy=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),Gy=(e,s,r,n)=>{e.prototype=Object.create(s.prototype,n),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:s.prototype}),r&&Object.assign(e.prototype,r)},Xy=(e,s,r,n)=>{let a,l,i;const o={};if(s=s||{},e==null)return s;do{for(a=Object.getOwnPropertyNames(e),l=a.length;l-- >0;)i=a[l],(!n||n(i,e,s))&&!o[i]&&(s[i]=e[i],o[i]=!0);e=r!==!1&&rd(e)}while(e&&(!r||r(e,s))&&e!==Object.prototype);return s},Yy=(e,s,r)=>{e=String(e),(r===void 0||r>e.length)&&(r=e.length),r-=s.length;const n=e.indexOf(s,r);return n!==-1&&n===r},Jy=e=>{if(!e)return null;if(Sn(e))return e;let s=e.length;if(!Ap(s))return null;const r=new Array(s);for(;s-- >0;)r[s]=e[s];return r},Zy=(e=>s=>e&&s instanceof e)(typeof Uint8Array<"u"&&rd(Uint8Array)),eb=(e,s)=>{const n=(e&&e[hi]).call(e);let a;for(;(a=n.next())&&!a.done;){const l=a.value;s.call(e,l[0],l[1])}},tb=(e,s)=>{let r;const n=[];for(;(r=e.exec(s))!==null;)n.push(r);return n},sb=ds("HTMLFormElement"),rb=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(r,n,a){return n.toUpperCase()+a}),P0=(({hasOwnProperty:e})=>(s,r)=>e.call(s,r))(Object.prototype),nb=ds("RegExp"),Pp=(e,s)=>{const r=Object.getOwnPropertyDescriptors(e),n={};Pa(r,(a,l)=>{let i;(i=s(a,l,e))!==!1&&(n[l]=i||a)}),Object.defineProperties(e,n)},ab=e=>{Pp(e,(s,r)=>{if(Lt(e)&&["arguments","caller","callee"].indexOf(r)!==-1)return!1;const n=e[r];if(Lt(n)){if(s.enumerable=!1,"writable"in s){s.writable=!1;return}s.set||(s.set=()=>{throw Error("Can not rewrite read-only method '"+r+"'")})}})},lb=(e,s)=>{const r={},n=a=>{a.forEach(l=>{r[l]=!0})};return Sn(e)?n(e):n(String(e).split(s)),r},ib=()=>{},ob=(e,s)=>e!=null&&Number.isFinite(e=+e)?e:s;function cb(e){return!!(e&&Lt(e.append)&&e[Ep]==="FormData"&&e[hi])}const db=e=>{const s=new Array(10),r=(n,a)=>{if(La(n)){if(s.indexOf(n)>=0)return;if(Ra(n))return n;if(!("toJSON"in n)){s[a]=n;const l=Sn(n)?[]:{};return Pa(n,(i,o)=>{const d=r(i,a+1);!vn(d)&&(l[o]=d)}),s[a]=void 0,l}}return n};return r(e,0)},ub=ds("AsyncFunction"),mb=e=>e&&(La(e)||Lt(e))&&Lt(e.then)&&Lt(e.catch),Mp=((e,s)=>e?setImmediate:s?((r,n)=>(Lr.addEventListener("message",({source:a,data:l})=>{a===Lr&&l===r&&n.length&&n.shift()()},!1),a=>{n.push(a),Lr.postMessage(r,"*")}))(`axios@${Math.random()}`,[]):r=>setTimeout(r))(typeof setImmediate=="function",Lt(Lr.postMessage)),xb=typeof queueMicrotask<"u"?queueMicrotask.bind(Lr):typeof process<"u"&&process.nextTick||Mp,pb=e=>e!=null&&Lt(e[hi]),L={isArray:Sn,isArrayBuffer:Tp,isBuffer:Ra,isFormData:Uy,isArrayBufferView:Ry,isString:Ly,isNumber:Ap,isBoolean:Py,isObject:La,isPlainObject:bl,isEmptyObject:My,isReadableStream:By,isRequest:Hy,isResponse:Vy,isHeaders:qy,isUndefined:vn,isDate:$y,isFile:Dy,isBlob:Iy,isRegExp:nb,isFunction:Lt,isStream:zy,isURLSearchParams:Fy,isTypedArray:Zy,isFileList:Oy,forEach:Pa,merge:tc,extend:Ky,trim:Wy,stripBOM:Qy,inherits:Gy,toFlatObject:Xy,kindOf:gi,kindOfTest:ds,endsWith:Yy,toArray:Jy,forEachEntry:eb,matchAll:tb,isHTMLForm:sb,hasOwnProperty:P0,hasOwnProp:P0,reduceDescriptors:Pp,freezeMethods:ab,toObjectSet:lb,toCamelCase:rb,noop:ib,toFiniteNumber:ob,findKey:Rp,global:Lr,isContextDefined:Lp,isSpecCompliantForm:cb,toJSONObject:db,isAsyncFn:ub,isThenable:mb,setImmediate:Mp,asap:xb,isIterable:pb};function me(e,s,r,n,a){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",s&&(this.code=s),r&&(this.config=r),n&&(this.request=n),a&&(this.response=a,this.status=a.status?a.status:null)}L.inherits(me,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:L.toJSONObject(this.config),code:this.code,status:this.status}}});const $p=me.prototype,Dp={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Dp[e]={value:e}});Object.defineProperties(me,Dp);Object.defineProperty($p,"isAxiosError",{value:!0});me.from=(e,s,r,n,a,l)=>{const i=Object.create($p);L.toFlatObject(e,i,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const o=e&&e.message?e.message:"Error",d=s==null&&e?e.code:s;return me.call(i,o,d,r,n,a),e&&i.cause==null&&Object.defineProperty(i,"cause",{value:e,configurable:!0}),i.name=e&&e.name||"Error",l&&Object.assign(i,l),i};const hb=null;function sc(e){return L.isPlainObject(e)||L.isArray(e)}function Ip(e){return L.endsWith(e,"[]")?e.slice(0,-2):e}function M0(e,s,r){return e?e.concat(s).map(function(a,l){return a=Ip(a),!r&&l?"["+a+"]":a}).join(r?".":""):s}function gb(e){return L.isArray(e)&&!e.some(sc)}const fb=L.toFlatObject(L,{},null,function(s){return/^is[A-Z]/.test(s)});function yi(e,s,r){if(!L.isObject(e))throw new TypeError("target must be an object");s=s||new FormData,r=L.toFlatObject(r,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,v){return!L.isUndefined(v[y])});const n=r.metaTokens,a=r.visitor||u,l=r.dots,i=r.indexes,d=(r.Blob||typeof Blob<"u"&&Blob)&&L.isSpecCompliantForm(s);if(!L.isFunction(a))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(L.isDate(f))return f.toISOString();if(L.isBoolean(f))return f.toString();if(!d&&L.isBlob(f))throw new me("Blob is not supported. Use a Buffer instead.");return L.isArrayBuffer(f)||L.isTypedArray(f)?d&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function u(f,y,v){let g=f;if(f&&!v&&typeof f=="object"){if(L.endsWith(y,"{}"))y=n?y:y.slice(0,-2),f=JSON.stringify(f);else if(L.isArray(f)&&gb(f)||(L.isFileList(f)||L.endsWith(y,"[]"))&&(g=L.toArray(f)))return y=Ip(y),g.forEach(function(x,N){!(L.isUndefined(x)||x===null)&&s.append(i===!0?M0([y],N,l):i===null?y:y+"[]",c(x))}),!1}return sc(f)?!0:(s.append(M0(v,y,l),c(f)),!1)}const h=[],b=Object.assign(fb,{defaultVisitor:u,convertValue:c,isVisitable:sc});function w(f,y){if(!L.isUndefined(f)){if(h.indexOf(f)!==-1)throw Error("Circular reference detected in "+y.join("."));h.push(f),L.forEach(f,function(g,p){(!(L.isUndefined(g)||g===null)&&a.call(s,g,L.isString(p)?p.trim():p,y,b))===!0&&w(g,y?y.concat(p):[p])}),h.pop()}}if(!L.isObject(e))throw new TypeError("data must be an object");return w(e),s}function $0(e){const s={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(n){return s[n]})}function nd(e,s){this._pairs=[],e&&yi(e,this,s)}const Op=nd.prototype;Op.append=function(s,r){this._pairs.push([s,r])};Op.toString=function(s){const r=s?function(n){return s.call(this,n,$0)}:$0;return this._pairs.map(function(a){return r(a[0])+"="+r(a[1])},"").join("&")};function yb(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function zp(e,s,r){if(!s)return e;const n=r&&r.encode||yb;L.isFunction(r)&&(r={serialize:r});const a=r&&r.serialize;let l;if(a?l=a(s,r):l=L.isURLSearchParams(s)?s.toString():new nd(s,r).toString(n),l){const i=e.indexOf("#");i!==-1&&(e=e.slice(0,i)),e+=(e.indexOf("?")===-1?"?":"&")+l}return e}class D0{constructor(){this.handlers=[]}use(s,r,n){return this.handlers.push({fulfilled:s,rejected:r,synchronous:n?n.synchronous:!1,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(s){this.handlers[s]&&(this.handlers[s]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(s){L.forEach(this.handlers,function(n){n!==null&&s(n)})}}const Up={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},bb=typeof URLSearchParams<"u"?URLSearchParams:nd,jb=typeof FormData<"u"?FormData:null,vb=typeof Blob<"u"?Blob:null,Nb={isBrowser:!0,classes:{URLSearchParams:bb,FormData:jb,Blob:vb},protocols:["http","https","file","blob","url","data"]},ad=typeof window<"u"&&typeof document<"u",rc=typeof navigator=="object"&&navigator||void 0,wb=ad&&(!rc||["ReactNative","NativeScript","NS"].indexOf(rc.product)<0),_b=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",kb=ad&&window.location.href||"http://localhost",Sb=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ad,hasStandardBrowserEnv:wb,hasStandardBrowserWebWorkerEnv:_b,navigator:rc,origin:kb},Symbol.toStringTag,{value:"Module"})),ft={...Sb,...Nb};function Cb(e,s){return yi(e,new ft.classes.URLSearchParams,{visitor:function(r,n,a,l){return ft.isNode&&L.isBuffer(r)?(this.append(n,r.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...s})}function Eb(e){return L.matchAll(/\w+|\[(\w*)]/g,e).map(s=>s[0]==="[]"?"":s[1]||s[0])}function Tb(e){const s={},r=Object.keys(e);let n;const a=r.length;let l;for(n=0;n<a;n++)l=r[n],s[l]=e[l];return s}function Fp(e){function s(r,n,a,l){let i=r[l++];if(i==="__proto__")return!0;const o=Number.isFinite(+i),d=l>=r.length;return i=!i&&L.isArray(a)?a.length:i,d?(L.hasOwnProp(a,i)?a[i]=[a[i],n]:a[i]=n,!o):((!a[i]||!L.isObject(a[i]))&&(a[i]=[]),s(r,n,a[i],l)&&L.isArray(a[i])&&(a[i]=Tb(a[i])),!o)}if(L.isFormData(e)&&L.isFunction(e.entries)){const r={};return L.forEachEntry(e,(n,a)=>{s(Eb(n),a,r,0)}),r}return null}function Ab(e,s,r){if(L.isString(e))try{return(s||JSON.parse)(e),L.trim(e)}catch(n){if(n.name!=="SyntaxError")throw n}return(r||JSON.stringify)(e)}const Ma={transitional:Up,adapter:["xhr","http","fetch"],transformRequest:[function(s,r){const n=r.getContentType()||"",a=n.indexOf("application/json")>-1,l=L.isObject(s);if(l&&L.isHTMLForm(s)&&(s=new FormData(s)),L.isFormData(s))return a?JSON.stringify(Fp(s)):s;if(L.isArrayBuffer(s)||L.isBuffer(s)||L.isStream(s)||L.isFile(s)||L.isBlob(s)||L.isReadableStream(s))return s;if(L.isArrayBufferView(s))return s.buffer;if(L.isURLSearchParams(s))return r.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),s.toString();let o;if(l){if(n.indexOf("application/x-www-form-urlencoded")>-1)return Cb(s,this.formSerializer).toString();if((o=L.isFileList(s))||n.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return yi(o?{"files[]":s}:s,d&&new d,this.formSerializer)}}return l||a?(r.setContentType("application/json",!1),Ab(s)):s}],transformResponse:[function(s){const r=this.transitional||Ma.transitional,n=r&&r.forcedJSONParsing,a=this.responseType==="json";if(L.isResponse(s)||L.isReadableStream(s))return s;if(s&&L.isString(s)&&(n&&!this.responseType||a)){const i=!(r&&r.silentJSONParsing)&&a;try{return JSON.parse(s,this.parseReviver)}catch(o){if(i)throw o.name==="SyntaxError"?me.from(o,me.ERR_BAD_RESPONSE,this,null,this.response):o}}return s}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ft.classes.FormData,Blob:ft.classes.Blob},validateStatus:function(s){return s>=200&&s<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};L.forEach(["delete","get","head","post","put","patch"],e=>{Ma.headers[e]={}});const Rb=L.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Lb=e=>{const s={};let r,n,a;return e&&e.split(`
`).forEach(function(i){a=i.indexOf(":"),r=i.substring(0,a).trim().toLowerCase(),n=i.substring(a+1).trim(),!(!r||s[r]&&Rb[r])&&(r==="set-cookie"?s[r]?s[r].push(n):s[r]=[n]:s[r]=s[r]?s[r]+", "+n:n)}),s},I0=Symbol("internals");function Qn(e){return e&&String(e).trim().toLowerCase()}function jl(e){return e===!1||e==null?e:L.isArray(e)?e.map(jl):String(e)}function Pb(e){const s=Object.create(null),r=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let n;for(;n=r.exec(e);)s[n[1]]=n[2];return s}const Mb=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Gi(e,s,r,n,a){if(L.isFunction(n))return n.call(this,s,r);if(a&&(s=r),!!L.isString(s)){if(L.isString(n))return s.indexOf(n)!==-1;if(L.isRegExp(n))return n.test(s)}}function $b(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(s,r,n)=>r.toUpperCase()+n)}function Db(e,s){const r=L.toCamelCase(" "+s);["get","set","has"].forEach(n=>{Object.defineProperty(e,n+r,{value:function(a,l,i){return this[n].call(this,s,a,l,i)},configurable:!0})})}let Pt=class{constructor(s){s&&this.set(s)}set(s,r,n){const a=this;function l(o,d,c){const u=Qn(d);if(!u)throw new Error("header name must be a non-empty string");const h=L.findKey(a,u);(!h||a[h]===void 0||c===!0||c===void 0&&a[h]!==!1)&&(a[h||d]=jl(o))}const i=(o,d)=>L.forEach(o,(c,u)=>l(c,u,d));if(L.isPlainObject(s)||s instanceof this.constructor)i(s,r);else if(L.isString(s)&&(s=s.trim())&&!Mb(s))i(Lb(s),r);else if(L.isObject(s)&&L.isIterable(s)){let o={},d,c;for(const u of s){if(!L.isArray(u))throw TypeError("Object iterator must return a key-value pair");o[c=u[0]]=(d=o[c])?L.isArray(d)?[...d,u[1]]:[d,u[1]]:u[1]}i(o,r)}else s!=null&&l(r,s,n);return this}get(s,r){if(s=Qn(s),s){const n=L.findKey(this,s);if(n){const a=this[n];if(!r)return a;if(r===!0)return Pb(a);if(L.isFunction(r))return r.call(this,a,n);if(L.isRegExp(r))return r.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(s,r){if(s=Qn(s),s){const n=L.findKey(this,s);return!!(n&&this[n]!==void 0&&(!r||Gi(this,this[n],n,r)))}return!1}delete(s,r){const n=this;let a=!1;function l(i){if(i=Qn(i),i){const o=L.findKey(n,i);o&&(!r||Gi(n,n[o],o,r))&&(delete n[o],a=!0)}}return L.isArray(s)?s.forEach(l):l(s),a}clear(s){const r=Object.keys(this);let n=r.length,a=!1;for(;n--;){const l=r[n];(!s||Gi(this,this[l],l,s,!0))&&(delete this[l],a=!0)}return a}normalize(s){const r=this,n={};return L.forEach(this,(a,l)=>{const i=L.findKey(n,l);if(i){r[i]=jl(a),delete r[l];return}const o=s?$b(l):String(l).trim();o!==l&&delete r[l],r[o]=jl(a),n[o]=!0}),this}concat(...s){return this.constructor.concat(this,...s)}toJSON(s){const r=Object.create(null);return L.forEach(this,(n,a)=>{n!=null&&n!==!1&&(r[a]=s&&L.isArray(n)?n.join(", "):n)}),r}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([s,r])=>s+": "+r).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(s){return s instanceof this?s:new this(s)}static concat(s,...r){const n=new this(s);return r.forEach(a=>n.set(a)),n}static accessor(s){const n=(this[I0]=this[I0]={accessors:{}}).accessors,a=this.prototype;function l(i){const o=Qn(i);n[o]||(Db(a,i),n[o]=!0)}return L.isArray(s)?s.forEach(l):l(s),this}};Pt.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);L.reduceDescriptors(Pt.prototype,({value:e},s)=>{let r=s[0].toUpperCase()+s.slice(1);return{get:()=>e,set(n){this[r]=n}}});L.freezeMethods(Pt);function Xi(e,s){const r=this||Ma,n=s||r,a=Pt.from(n.headers);let l=n.data;return L.forEach(e,function(o){l=o.call(r,l,a.normalize(),s?s.status:void 0)}),a.normalize(),l}function Bp(e){return!!(e&&e.__CANCEL__)}function Cn(e,s,r){me.call(this,e??"canceled",me.ERR_CANCELED,s,r),this.name="CanceledError"}L.inherits(Cn,me,{__CANCEL__:!0});function Hp(e,s,r){const n=r.config.validateStatus;!r.status||!n||n(r.status)?e(r):s(new me("Request failed with status code "+r.status,[me.ERR_BAD_REQUEST,me.ERR_BAD_RESPONSE][Math.floor(r.status/100)-4],r.config,r.request,r))}function Ib(e){const s=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return s&&s[1]||""}function Ob(e,s){e=e||10;const r=new Array(e),n=new Array(e);let a=0,l=0,i;return s=s!==void 0?s:1e3,function(d){const c=Date.now(),u=n[l];i||(i=c),r[a]=d,n[a]=c;let h=l,b=0;for(;h!==a;)b+=r[h++],h=h%e;if(a=(a+1)%e,a===l&&(l=(l+1)%e),c-i<s)return;const w=u&&c-u;return w?Math.round(b*1e3/w):void 0}}function zb(e,s){let r=0,n=1e3/s,a,l;const i=(c,u=Date.now())=>{r=u,a=null,l&&(clearTimeout(l),l=null),e(...c)};return[(...c)=>{const u=Date.now(),h=u-r;h>=n?i(c,u):(a=c,l||(l=setTimeout(()=>{l=null,i(a)},n-h)))},()=>a&&i(a)]}const Xl=(e,s,r=3)=>{let n=0;const a=Ob(50,250);return zb(l=>{const i=l.loaded,o=l.lengthComputable?l.total:void 0,d=i-n,c=a(d),u=i<=o;n=i;const h={loaded:i,total:o,progress:o?i/o:void 0,bytes:d,rate:c||void 0,estimated:c&&o&&u?(o-i)/c:void 0,event:l,lengthComputable:o!=null,[s?"download":"upload"]:!0};e(h)},r)},O0=(e,s)=>{const r=e!=null;return[n=>s[0]({lengthComputable:r,total:e,loaded:n}),s[1]]},z0=e=>(...s)=>L.asap(()=>e(...s)),Ub=ft.hasStandardBrowserEnv?((e,s)=>r=>(r=new URL(r,ft.origin),e.protocol===r.protocol&&e.host===r.host&&(s||e.port===r.port)))(new URL(ft.origin),ft.navigator&&/(msie|trident)/i.test(ft.navigator.userAgent)):()=>!0,Fb=ft.hasStandardBrowserEnv?{write(e,s,r,n,a,l,i){if(typeof document>"u")return;const o=[`${e}=${encodeURIComponent(s)}`];L.isNumber(r)&&o.push(`expires=${new Date(r).toUTCString()}`),L.isString(n)&&o.push(`path=${n}`),L.isString(a)&&o.push(`domain=${a}`),l===!0&&o.push("secure"),L.isString(i)&&o.push(`SameSite=${i}`),document.cookie=o.join("; ")},read(e){if(typeof document>"u")return null;const s=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return s?decodeURIComponent(s[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function Bb(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Hb(e,s){return s?e.replace(/\/?\/$/,"")+"/"+s.replace(/^\/+/,""):e}function Vp(e,s,r){let n=!Bb(s);return e&&(n||r==!1)?Hb(e,s):s}const U0=e=>e instanceof Pt?{...e}:e;function Hr(e,s){s=s||{};const r={};function n(c,u,h,b){return L.isPlainObject(c)&&L.isPlainObject(u)?L.merge.call({caseless:b},c,u):L.isPlainObject(u)?L.merge({},u):L.isArray(u)?u.slice():u}function a(c,u,h,b){if(L.isUndefined(u)){if(!L.isUndefined(c))return n(void 0,c,h,b)}else return n(c,u,h,b)}function l(c,u){if(!L.isUndefined(u))return n(void 0,u)}function i(c,u){if(L.isUndefined(u)){if(!L.isUndefined(c))return n(void 0,c)}else return n(void 0,u)}function o(c,u,h){if(h in s)return n(c,u);if(h in e)return n(void 0,c)}const d={url:l,method:l,data:l,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:o,headers:(c,u,h)=>a(U0(c),U0(u),h,!0)};return L.forEach(Object.keys({...e,...s}),function(u){const h=d[u]||a,b=h(e[u],s[u],u);L.isUndefined(b)&&h!==o||(r[u]=b)}),r}const qp=e=>{const s=Hr({},e);let{data:r,withXSRFToken:n,xsrfHeaderName:a,xsrfCookieName:l,headers:i,auth:o}=s;if(s.headers=i=Pt.from(i),s.url=zp(Vp(s.baseURL,s.url,s.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),L.isFormData(r)){if(ft.hasStandardBrowserEnv||ft.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(L.isFunction(r.getHeaders)){const d=r.getHeaders(),c=["content-type","content-length"];Object.entries(d).forEach(([u,h])=>{c.includes(u.toLowerCase())&&i.set(u,h)})}}if(ft.hasStandardBrowserEnv&&(n&&L.isFunction(n)&&(n=n(s)),n||n!==!1&&Ub(s.url))){const d=a&&l&&Fb.read(l);d&&i.set(a,d)}return s},Vb=typeof XMLHttpRequest<"u",qb=Vb&&function(e){return new Promise(function(r,n){const a=qp(e);let l=a.data;const i=Pt.from(a.headers).normalize();let{responseType:o,onUploadProgress:d,onDownloadProgress:c}=a,u,h,b,w,f;function y(){w&&w(),f&&f(),a.cancelToken&&a.cancelToken.unsubscribe(u),a.signal&&a.signal.removeEventListener("abort",u)}let v=new XMLHttpRequest;v.open(a.method.toUpperCase(),a.url,!0),v.timeout=a.timeout;function g(){if(!v)return;const x=Pt.from("getAllResponseHeaders"in v&&v.getAllResponseHeaders()),j={data:!o||o==="text"||o==="json"?v.responseText:v.response,status:v.status,statusText:v.statusText,headers:x,config:e,request:v};Hp(function(C){r(C),y()},function(C){n(C),y()},j),v=null}"onloadend"in v?v.onloadend=g:v.onreadystatechange=function(){!v||v.readyState!==4||v.status===0&&!(v.responseURL&&v.responseURL.indexOf("file:")===0)||setTimeout(g)},v.onabort=function(){v&&(n(new me("Request aborted",me.ECONNABORTED,e,v)),v=null)},v.onerror=function(N){const j=N&&N.message?N.message:"Network Error",S=new me(j,me.ERR_NETWORK,e,v);S.event=N||null,n(S),v=null},v.ontimeout=function(){let N=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const j=a.transitional||Up;a.timeoutErrorMessage&&(N=a.timeoutErrorMessage),n(new me(N,j.clarifyTimeoutError?me.ETIMEDOUT:me.ECONNABORTED,e,v)),v=null},l===void 0&&i.setContentType(null),"setRequestHeader"in v&&L.forEach(i.toJSON(),function(N,j){v.setRequestHeader(j,N)}),L.isUndefined(a.withCredentials)||(v.withCredentials=!!a.withCredentials),o&&o!=="json"&&(v.responseType=a.responseType),c&&([b,f]=Xl(c,!0),v.addEventListener("progress",b)),d&&v.upload&&([h,w]=Xl(d),v.upload.addEventListener("progress",h),v.upload.addEventListener("loadend",w)),(a.cancelToken||a.signal)&&(u=x=>{v&&(n(!x||x.type?new Cn(null,e,v):x),v.abort(),v=null)},a.cancelToken&&a.cancelToken.subscribe(u),a.signal&&(a.signal.aborted?u():a.signal.addEventListener("abort",u)));const p=Ib(a.url);if(p&&ft.protocols.indexOf(p)===-1){n(new me("Unsupported protocol "+p+":",me.ERR_BAD_REQUEST,e));return}v.send(l||null)})},Wb=(e,s)=>{const{length:r}=e=e?e.filter(Boolean):[];if(s||r){let n=new AbortController,a;const l=function(c){if(!a){a=!0,o();const u=c instanceof Error?c:this.reason;n.abort(u instanceof me?u:new Cn(u instanceof Error?u.message:u))}};let i=s&&setTimeout(()=>{i=null,l(new me(`timeout ${s} of ms exceeded`,me.ETIMEDOUT))},s);const o=()=>{e&&(i&&clearTimeout(i),i=null,e.forEach(c=>{c.unsubscribe?c.unsubscribe(l):c.removeEventListener("abort",l)}),e=null)};e.forEach(c=>c.addEventListener("abort",l));const{signal:d}=n;return d.unsubscribe=()=>L.asap(o),d}},Kb=function*(e,s){let r=e.byteLength;if(r<s){yield e;return}let n=0,a;for(;n<r;)a=n+s,yield e.slice(n,a),n=a},Qb=async function*(e,s){for await(const r of Gb(e))yield*Kb(r,s)},Gb=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const s=e.getReader();try{for(;;){const{done:r,value:n}=await s.read();if(r)break;yield n}}finally{await s.cancel()}},F0=(e,s,r,n)=>{const a=Qb(e,s);let l=0,i,o=d=>{i||(i=!0,n&&n(d))};return new ReadableStream({async pull(d){try{const{done:c,value:u}=await a.next();if(c){o(),d.close();return}let h=u.byteLength;if(r){let b=l+=h;r(b)}d.enqueue(new Uint8Array(u))}catch(c){throw o(c),c}},cancel(d){return o(d),a.return()}},{highWaterMark:2})},B0=64*1024,{isFunction:el}=L,Xb=(({Request:e,Response:s})=>({Request:e,Response:s}))(L.global),{ReadableStream:H0,TextEncoder:V0}=L.global,q0=(e,...s)=>{try{return!!e(...s)}catch{return!1}},Yb=e=>{e=L.merge.call({skipUndefined:!0},Xb,e);const{fetch:s,Request:r,Response:n}=e,a=s?el(s):typeof fetch=="function",l=el(r),i=el(n);if(!a)return!1;const o=a&&el(H0),d=a&&(typeof V0=="function"?(f=>y=>f.encode(y))(new V0):async f=>new Uint8Array(await new r(f).arrayBuffer())),c=l&&o&&q0(()=>{let f=!1;const y=new r(ft.origin,{body:new H0,method:"POST",get duplex(){return f=!0,"half"}}).headers.has("Content-Type");return f&&!y}),u=i&&o&&q0(()=>L.isReadableStream(new n("").body)),h={stream:u&&(f=>f.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(f=>{!h[f]&&(h[f]=(y,v)=>{let g=y&&y[f];if(g)return g.call(y);throw new me(`Response type '${f}' is not supported`,me.ERR_NOT_SUPPORT,v)})});const b=async f=>{if(f==null)return 0;if(L.isBlob(f))return f.size;if(L.isSpecCompliantForm(f))return(await new r(ft.origin,{method:"POST",body:f}).arrayBuffer()).byteLength;if(L.isArrayBufferView(f)||L.isArrayBuffer(f))return f.byteLength;if(L.isURLSearchParams(f)&&(f=f+""),L.isString(f))return(await d(f)).byteLength},w=async(f,y)=>{const v=L.toFiniteNumber(f.getContentLength());return v??b(y)};return async f=>{let{url:y,method:v,data:g,signal:p,cancelToken:x,timeout:N,onDownloadProgress:j,onUploadProgress:S,responseType:C,headers:P,withCredentials:$="same-origin",fetchOptions:z}=qp(f),B=s||fetch;C=C?(C+"").toLowerCase():"text";let de=Wb([p,x&&x.toAbortSignal()],N),xe=null;const be=de&&de.unsubscribe&&(()=>{de.unsubscribe()});let ue;try{if(S&&c&&v!=="get"&&v!=="head"&&(ue=await w(P,g))!==0){let F=new r(y,{method:"POST",body:g,duplex:"half"}),J;if(L.isFormData(g)&&(J=F.headers.get("content-type"))&&P.setContentType(J),F.body){const[R,A]=O0(ue,Xl(z0(S)));g=F0(F.body,B0,R,A)}}L.isString($)||($=$?"include":"omit");const se=l&&"credentials"in r.prototype,ke={...z,signal:de,method:v.toUpperCase(),headers:P.normalize().toJSON(),body:g,duplex:"half",credentials:se?$:void 0};xe=l&&new r(y,ke);let _=await(l?B(xe,z):B(y,ke));const I=u&&(C==="stream"||C==="response");if(u&&(j||I&&be)){const F={};["status","statusText","headers"].forEach(D=>{F[D]=_[D]});const J=L.toFiniteNumber(_.headers.get("content-length")),[R,A]=j&&O0(J,Xl(z0(j),!0))||[];_=new n(F0(_.body,B0,R,()=>{A&&A(),be&&be()}),F)}C=C||"text";let E=await h[L.findKey(h,C)||"text"](_,f);return!I&&be&&be(),await new Promise((F,J)=>{Hp(F,J,{data:E,headers:Pt.from(_.headers),status:_.status,statusText:_.statusText,config:f,request:xe})})}catch(se){throw be&&be(),se&&se.name==="TypeError"&&/Load failed|fetch/i.test(se.message)?Object.assign(new me("Network Error",me.ERR_NETWORK,f,xe),{cause:se.cause||se}):me.from(se,se&&se.code,f,xe)}}},Jb=new Map,Wp=e=>{let s=e&&e.env||{};const{fetch:r,Request:n,Response:a}=s,l=[n,a,r];let i=l.length,o=i,d,c,u=Jb;for(;o--;)d=l[o],c=u.get(d),c===void 0&&u.set(d,c=o?new Map:Yb(s)),u=c;return c};Wp();const ld={http:hb,xhr:qb,fetch:{get:Wp}};L.forEach(ld,(e,s)=>{if(e){try{Object.defineProperty(e,"name",{value:s})}catch{}Object.defineProperty(e,"adapterName",{value:s})}});const W0=e=>`- ${e}`,Zb=e=>L.isFunction(e)||e===null||e===!1;function ej(e,s){e=L.isArray(e)?e:[e];const{length:r}=e;let n,a;const l={};for(let i=0;i<r;i++){n=e[i];let o;if(a=n,!Zb(n)&&(a=ld[(o=String(n)).toLowerCase()],a===void 0))throw new me(`Unknown adapter '${o}'`);if(a&&(L.isFunction(a)||(a=a.get(s))))break;l[o||"#"+i]=a}if(!a){const i=Object.entries(l).map(([d,c])=>`adapter ${d} `+(c===!1?"is not supported by the environment":"is not available in the build"));let o=r?i.length>1?`since :
`+i.map(W0).join(`
`):" "+W0(i[0]):"as no adapter specified";throw new me("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return a}const Kp={getAdapter:ej,adapters:ld};function Yi(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Cn(null,e)}function K0(e){return Yi(e),e.headers=Pt.from(e.headers),e.data=Xi.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Kp.getAdapter(e.adapter||Ma.adapter,e)(e).then(function(n){return Yi(e),n.data=Xi.call(e,e.transformResponse,n),n.headers=Pt.from(n.headers),n},function(n){return Bp(n)||(Yi(e),n&&n.response&&(n.response.data=Xi.call(e,e.transformResponse,n.response),n.response.headers=Pt.from(n.response.headers))),Promise.reject(n)})}const Qp="1.13.2",bi={};["object","boolean","number","function","string","symbol"].forEach((e,s)=>{bi[e]=function(n){return typeof n===e||"a"+(s<1?"n ":" ")+e}});const Q0={};bi.transitional=function(s,r,n){function a(l,i){return"[Axios v"+Qp+"] Transitional option '"+l+"'"+i+(n?". "+n:"")}return(l,i,o)=>{if(s===!1)throw new me(a(i," has been removed"+(r?" in "+r:"")),me.ERR_DEPRECATED);return r&&!Q0[i]&&(Q0[i]=!0,console.warn(a(i," has been deprecated since v"+r+" and will be removed in the near future"))),s?s(l,i,o):!0}};bi.spelling=function(s){return(r,n)=>(console.warn(`${n} is likely a misspelling of ${s}`),!0)};function tj(e,s,r){if(typeof e!="object")throw new me("options must be an object",me.ERR_BAD_OPTION_VALUE);const n=Object.keys(e);let a=n.length;for(;a-- >0;){const l=n[a],i=s[l];if(i){const o=e[l],d=o===void 0||i(o,l,e);if(d!==!0)throw new me("option "+l+" must be "+d,me.ERR_BAD_OPTION_VALUE);continue}if(r!==!0)throw new me("Unknown option "+l,me.ERR_BAD_OPTION)}}const vl={assertOptions:tj,validators:bi},xs=vl.validators;let $r=class{constructor(s){this.defaults=s||{},this.interceptors={request:new D0,response:new D0}}async request(s,r){try{return await this._request(s,r)}catch(n){if(n instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{n.stack?l&&!String(n.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(n.stack+=`
`+l):n.stack=l}catch{}}throw n}}_request(s,r){typeof s=="string"?(r=r||{},r.url=s):r=s||{},r=Hr(this.defaults,r);const{transitional:n,paramsSerializer:a,headers:l}=r;n!==void 0&&vl.assertOptions(n,{silentJSONParsing:xs.transitional(xs.boolean),forcedJSONParsing:xs.transitional(xs.boolean),clarifyTimeoutError:xs.transitional(xs.boolean)},!1),a!=null&&(L.isFunction(a)?r.paramsSerializer={serialize:a}:vl.assertOptions(a,{encode:xs.function,serialize:xs.function},!0)),r.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?r.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:r.allowAbsoluteUrls=!0),vl.assertOptions(r,{baseUrl:xs.spelling("baseURL"),withXsrfToken:xs.spelling("withXSRFToken")},!0),r.method=(r.method||this.defaults.method||"get").toLowerCase();let i=l&&L.merge(l.common,l[r.method]);l&&L.forEach(["delete","get","head","post","put","patch","common"],f=>{delete l[f]}),r.headers=Pt.concat(i,l);const o=[];let d=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(r)===!1||(d=d&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const c=[];this.interceptors.response.forEach(function(y){c.push(y.fulfilled,y.rejected)});let u,h=0,b;if(!d){const f=[K0.bind(this),void 0];for(f.unshift(...o),f.push(...c),b=f.length,u=Promise.resolve(r);h<b;)u=u.then(f[h++],f[h++]);return u}b=o.length;let w=r;for(;h<b;){const f=o[h++],y=o[h++];try{w=f(w)}catch(v){y.call(this,v);break}}try{u=K0.call(this,w)}catch(f){return Promise.reject(f)}for(h=0,b=c.length;h<b;)u=u.then(c[h++],c[h++]);return u}getUri(s){s=Hr(this.defaults,s);const r=Vp(s.baseURL,s.url,s.allowAbsoluteUrls);return zp(r,s.params,s.paramsSerializer)}};L.forEach(["delete","get","head","options"],function(s){$r.prototype[s]=function(r,n){return this.request(Hr(n||{},{method:s,url:r,data:(n||{}).data}))}});L.forEach(["post","put","patch"],function(s){function r(n){return function(l,i,o){return this.request(Hr(o||{},{method:s,headers:n?{"Content-Type":"multipart/form-data"}:{},url:l,data:i}))}}$r.prototype[s]=r(),$r.prototype[s+"Form"]=r(!0)});let sj=class Gp{constructor(s){if(typeof s!="function")throw new TypeError("executor must be a function.");let r;this.promise=new Promise(function(l){r=l});const n=this;this.promise.then(a=>{if(!n._listeners)return;let l=n._listeners.length;for(;l-- >0;)n._listeners[l](a);n._listeners=null}),this.promise.then=a=>{let l;const i=new Promise(o=>{n.subscribe(o),l=o}).then(a);return i.cancel=function(){n.unsubscribe(l)},i},s(function(l,i,o){n.reason||(n.reason=new Cn(l,i,o),r(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(s){if(this.reason){s(this.reason);return}this._listeners?this._listeners.push(s):this._listeners=[s]}unsubscribe(s){if(!this._listeners)return;const r=this._listeners.indexOf(s);r!==-1&&this._listeners.splice(r,1)}toAbortSignal(){const s=new AbortController,r=n=>{s.abort(n)};return this.subscribe(r),s.signal.unsubscribe=()=>this.unsubscribe(r),s.signal}static source(){let s;return{token:new Gp(function(a){s=a}),cancel:s}}};function rj(e){return function(r){return e.apply(null,r)}}function nj(e){return L.isObject(e)&&e.isAxiosError===!0}const nc={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(nc).forEach(([e,s])=>{nc[s]=e});function Xp(e){const s=new $r(e),r=Cp($r.prototype.request,s);return L.extend(r,$r.prototype,s,{allOwnKeys:!0}),L.extend(r,s,null,{allOwnKeys:!0}),r.create=function(a){return Xp(Hr(e,a))},r}const We=Xp(Ma);We.Axios=$r;We.CanceledError=Cn;We.CancelToken=sj;We.isCancel=Bp;We.VERSION=Qp;We.toFormData=yi;We.AxiosError=me;We.Cancel=We.CanceledError;We.all=function(s){return Promise.all(s)};We.spread=rj;We.isAxiosError=nj;We.mergeConfig=Hr;We.AxiosHeaders=Pt;We.formToJSON=e=>Fp(L.isHTMLForm(e)?new FormData(e):e);We.getAdapter=Kp.getAdapter;We.HttpStatusCode=nc;We.default=We;const{Axios:Uj,AxiosError:Fj,CanceledError:Bj,isCancel:Hj,CancelToken:Vj,VERSION:qj,all:Wj,Cancel:Kj,isAxiosError:Qj,spread:Gj,toFormData:Xj,AxiosHeaders:Yj,HttpStatusCode:Jj,formToJSON:Zj,getAdapter:ev,mergeConfig:tv}=We,aj="https://nikses-production.up.railway.app/api/v1",lj=12e4,ij=()=>{const e=We.create({baseURL:aj,timeout:lj,headers:{"Content-Type":"application/json"}});return e.interceptors.request.use(s=>s,s=>Promise.reject(s)),e.interceptors.response.use(s=>s,s=>{var n,a,l,i,o,d,c;const r={status:((n=s.response)==null?void 0:n.status)||500,message:((l=(a=s.response)==null?void 0:a.data)==null?void 0:l.message)||((o=(i=s.response)==null?void 0:i.data)==null?void 0:o.detail)||s.message,detail:(c=(d=s.response)==null?void 0:d.data)==null?void 0:c.detail};return Promise.reject(r)}),e},Ie=ij(),G0={email_metadata:{label:"Email Metadata",icon:Ut,fields:[{id:"subject",label:"Subject",type:"string",description:"Email subject line"},{id:"body",label:"Body Content",type:"string",description:"Email body text (HTML stripped)"},{id:"body_html",label:"Body HTML",type:"string",description:"Raw HTML content"},{id:"sender_email",label:"Sender Email",type:"string",description:"From address"},{id:"sender_domain",label:"Sender Domain",type:"string",description:"Domain of sender"},{id:"sender_display_name",label:"Display Name",type:"string",description:"Sender display name"},{id:"reply_to",label:"Reply-To",type:"string",description:"Reply-To address"},{id:"return_path",label:"Return-Path",type:"string",description:"Bounce address"},{id:"recipient_count",label:"Recipient Count",type:"number",description:"Number of recipients"}]},authentication:{label:"Authentication",icon:fs,fields:[{id:"spf_result",label:"SPF Result",type:"enum",options:["pass","fail","softfail","neutral","none"],description:"SPF check result"},{id:"dkim_result",label:"DKIM Result",type:"enum",options:["pass","fail","none"],description:"DKIM signature result"},{id:"dmarc_result",label:"DMARC Result",type:"enum",options:["pass","fail","none"],description:"DMARC policy result"},{id:"auth_all_pass",label:"All Auth Pass",type:"boolean",description:"SPF + DKIM + DMARC all pass"},{id:"auth_any_fail",label:"Any Auth Fail",type:"boolean",description:"Any authentication failed"}]},threat_intel:{label:"Threat Intelligence",icon:Ze,fields:[{id:"sender_domain_vt_score",label:"Sender Domain VT Score",type:"number",description:"VirusTotal detection count"},{id:"sender_domain_age_days",label:"Domain Age (days)",type:"number",description:"Days since domain registration"},{id:"sender_domain_is_new",label:"Newly Registered Domain",type:"boolean",description:"Domain < 30 days old"},{id:"originating_ip_abuse_score",label:"IP Abuse Score",type:"number",description:"AbuseIPDB confidence score (0-100)"},{id:"originating_ip_is_tor",label:"IP is Tor Exit",type:"boolean",description:"Originates from Tor network"},{id:"originating_ip_is_vpn",label:"IP is VPN",type:"boolean",description:"Originates from VPN provider"},{id:"originating_ip_country",label:"IP Country",type:"string",description:"Geolocation country code"},{id:"url_any_malicious",label:"Any Malicious URL",type:"boolean",description:"Any URL flagged by threat intel"},{id:"attachment_any_malicious",label:"Any Malicious Attachment",type:"boolean",description:"Any attachment flagged"}]},urls_links:{label:"URLs & Links",icon:jt,fields:[{id:"url_count",label:"URL Count",type:"number",description:"Number of URLs in email"},{id:"urls",label:"URL Content",type:"string",description:"Any URL in email"},{id:"url_domains",label:"URL Domains",type:"string",description:"Domains in URLs"},{id:"has_shortened_url",label:"Has Shortened URL",type:"boolean",description:"Contains bit.ly, tinyurl, etc."},{id:"has_ip_url",label:"Has IP-based URL",type:"boolean",description:"URL with IP instead of domain"},{id:"has_data_uri",label:"Has Data URI",type:"boolean",description:"Contains data: URI scheme"},{id:"url_mismatch",label:"URL/Text Mismatch",type:"boolean",description:"Display text differs from href"},{id:"has_credential_harvesting_url",label:"Credential Harvesting URL",type:"boolean",description:"URL contains login/signin patterns"}]},attachments:{label:"Attachments",icon:hr,fields:[{id:"attachment_count",label:"Attachment Count",type:"number",description:"Number of attachments"},{id:"attachment_names",label:"Attachment Names",type:"string",description:"Filename of any attachment"},{id:"attachment_extensions",label:"Attachment Extensions",type:"string",description:"File extension (.exe, .zip, etc.)"},{id:"attachment_size_total",label:"Total Size (KB)",type:"number",description:"Total attachment size"},{id:"has_executable",label:"Has Executable",type:"boolean",description:"Contains .exe, .dll, .bat, etc."},{id:"has_macro_document",label:"Has Macro Document",type:"boolean",description:"Contains .docm, .xlsm, etc."},{id:"has_archive",label:"Has Archive",type:"boolean",description:"Contains .zip, .rar, .7z, etc."},{id:"has_double_extension",label:"Double Extension",type:"boolean",description:"File like invoice.pdf.exe"},{id:"has_password_protected",label:"Password Protected",type:"boolean",description:"Encrypted attachment"}]},headers:{label:"Headers & Routing",icon:vt,fields:[{id:"headers",label:"Raw Headers",type:"string",description:"Any header content"},{id:"x_mailer",label:"X-Mailer",type:"string",description:"Mail client identifier"},{id:"received_hop_count",label:"Received Hops",type:"number",description:"Number of mail servers traversed"},{id:"received_delay_total",label:"Total Delay (sec)",type:"number",description:"Time from first to last hop"},{id:"has_received_localhost",label:"Localhost in Received",type:"boolean",description:"Suspicious localhost routing"},{id:"header_from_mismatch",label:"Header From Mismatch",type:"boolean",description:"From header differs from envelope"}]},behavioral:{label:"Behavioral Patterns",icon:gt,fields:[{id:"urgency_score",label:"Urgency Score",type:"number",description:"Urgency language intensity (0-100)"},{id:"has_urgency_language",label:"Has Urgency Language",type:"boolean",description:"URGENT, ASAP, immediately, etc."},{id:"has_threat_language",label:"Has Threat Language",type:"boolean",description:"Account suspended, legal action, etc."},{id:"has_financial_request",label:"Financial Request",type:"boolean",description:"Wire transfer, gift cards, payment"},{id:"has_credential_request",label:"Credential Request",type:"boolean",description:"Password, login, verify account"},{id:"has_pii_request",label:"PII Request",type:"boolean",description:"SSN, DOB, address requests"},{id:"impersonates_brand",label:"Brand Impersonation",type:"boolean",description:"Mentions known brand names"},{id:"impersonates_executive",label:"Executive Impersonation",type:"boolean",description:"CEO, CFO name patterns"},{id:"sent_outside_business_hours",label:"Outside Business Hours",type:"boolean",description:"Sent outside 9-5 local time"}]}},Ji={string:[{id:"contains",label:"contains",description:"Text contains value (case-insensitive)"},{id:"not_contains",label:"does not contain",description:"Text does not contain value"},{id:"equals",label:"equals",description:"Exact match (case-insensitive)"},{id:"not_equals",label:"does not equal",description:"Does not match exactly"},{id:"starts_with",label:"starts with",description:"Begins with value"},{id:"ends_with",label:"ends with",description:"Ends with value"},{id:"regex",label:"matches regex",description:"Regular expression match"},{id:"in_list",label:"is in list",description:"Matches any item in comma-separated list"},{id:"similarity",label:"similar to (fuzzy)",description:"Fuzzy string matching (typosquatting)"}],number:[{id:"equals",label:"=",description:"Equal to"},{id:"not_equals",label:"",description:"Not equal to"},{id:"greater_than",label:">",description:"Greater than"},{id:"less_than",label:"<",description:"Less than"},{id:"greater_equal",label:"",description:"Greater than or equal"},{id:"less_equal",label:"",description:"Less than or equal"},{id:"between",label:"between",description:"Value is between two numbers"}],boolean:[{id:"is_true",label:"is true",description:"Condition is true"},{id:"is_false",label:"is false",description:"Condition is false"}],enum:[{id:"equals",label:"is",description:"Equals selected value"},{id:"not_equals",label:"is not",description:"Does not equal selected value"},{id:"in_list",label:"is one of",description:"Matches any selected value"}]},kr=[{id:"critical",label:"Critical",color:"bg-red-600",textColor:"text-red-400",score:40},{id:"high",label:"High",color:"bg-orange-600",textColor:"text-orange-400",score:25},{id:"medium",label:"Medium",color:"bg-yellow-600",textColor:"text-yellow-400",score:15},{id:"low",label:"Low",color:"bg-blue-600",textColor:"text-blue-400",score:5},{id:"info",label:"Informational",color:"bg-gray-600",textColor:"text-gray-400",score:0}],X0=[{id:"T1566.001",name:"Spearphishing Attachment",tactic:"Initial Access"},{id:"T1566.002",name:"Spearphishing Link",tactic:"Initial Access"},{id:"T1566.003",name:"Spearphishing via Service",tactic:"Initial Access"},{id:"T1598.002",name:"Spearphishing for Information",tactic:"Reconnaissance"},{id:"T1598.003",name:"Spearphishing Link (Recon)",tactic:"Reconnaissance"},{id:"T1204.001",name:"Malicious Link",tactic:"Execution"},{id:"T1204.002",name:"Malicious File",tactic:"Execution"},{id:"T1656",name:"Impersonation",tactic:"Defense Evasion"},{id:"T1036",name:"Masquerading",tactic:"Defense Evasion"},{id:"T1589.001",name:"Gather Victim Identity - Credentials",tactic:"Reconnaissance"}],oj=[{name:"Authentication Failure",description:"Detect emails failing SPF, DKIM, or DMARC",conditions:[{field:"auth_any_fail",operator:"is_true",value:"true"}],severity:"high",mitre:["T1566.001"]},{name:"Newly Registered Domain",description:"Sender domain registered within last 30 days",conditions:[{field:"sender_domain_is_new",operator:"is_true",value:"true"}],severity:"medium",mitre:["T1566.002"]},{name:"Credential Harvesting",description:"URLs with login/password patterns",conditions:[{field:"has_credential_harvesting_url",operator:"is_true",value:"true"}],severity:"critical",mitre:["T1566.002","T1589.001"]},{name:"Executive Impersonation (BEC)",description:"Possible CEO/CFO impersonation attempt",conditions:[{field:"impersonates_executive",operator:"is_true",value:"true"},{field:"has_financial_request",operator:"is_true",value:"true"}],logic:"AND",severity:"critical",mitre:["T1656","T1598.002"]},{name:"Malicious Attachment Type",description:"Dangerous file extensions attached",conditions:[{field:"has_executable",operator:"is_true",value:"true"}],severity:"critical",mitre:["T1566.001","T1204.002"]},{name:"High IP Abuse Score",description:"Originating IP has high abuse confidence",conditions:[{field:"originating_ip_abuse_score",operator:"greater_than",value:"50"}],severity:"high",mitre:["T1566.001"]},{name:"URL Shortener with Urgency",description:"Shortened URLs combined with urgent language",conditions:[{field:"has_shortened_url",operator:"is_true",value:"true"},{field:"has_urgency_language",operator:"is_true",value:"true"}],logic:"AND",severity:"high",mitre:["T1566.002","T1204.001"]},{name:"Tor/VPN Origin",description:"Email originates from anonymizing network",conditions:[{field:"originating_ip_is_tor",operator:"is_true",value:"true"}],severity:"medium",mitre:["T1566.001"]}],cj=({isOpen:e,onClose:s})=>{var ke,_,I,E,F,J;const[r,n]=k.useState([]),[a,l]=k.useState(null),[i,o]=k.useState(!1),[d,c]=k.useState(!1),[u,h]=k.useState(!1),[b,w]=k.useState(""),[f,y]=k.useState(""),[v,g]=k.useState(!1),[p,x]=k.useState({name:"",description:"",severity:"medium",category:"custom",conditionGroups:[{id:"1",logic:"AND",conditions:[{id:"1",field:"",operator:"",value:""}]}],groupLogic:"AND",mitreTechniques:[],tags:[],enabled:!0});k.useEffect(()=>{e&&N()},[e]);const N=async()=>{g(!0);try{const D=((await Ie.get("/rules")).data.rules||[]).map(q=>{var T;return{...q,conditionGroups:q.conditionGroups||[{id:"1",logic:"AND",conditions:((T=q.conditions)==null?void 0:T.map((Y,ve)=>({id:String(ve+1),field:Y.field,operator:Y.operator,value:Y.value})))||[]}],groupLogic:q.groupLogic||"AND",mitreTechniques:q.mitreTechniques||q.mitre||[],tags:q.tags||[]}});n(D)}catch(R){console.error("Failed to load rules:",R)}finally{g(!1)}},j=R=>{for(const A of Object.values(G0)){const D=A.fields.find(q=>q.id===R);if(D)return D}return null},S=R=>{const A=j(R);return A&&Ji[A.type]||Ji.string},C=R=>{const A=[...p.conditionGroups||[]];A[R].conditions.push({id:String(Date.now()),field:"",operator:"",value:""}),x({...p,conditionGroups:A})},P=(R,A)=>{const D=[...p.conditionGroups||[]];D[R].conditions.splice(A,1),D[R].conditions.length===0&&D.splice(R,1),D.length===0&&D.push({id:String(Date.now()),logic:"AND",conditions:[{id:"1",field:"",operator:"",value:""}]}),x({...p,conditionGroups:D})},$=(R,A,D)=>{const q=[...p.conditionGroups||[]];q[R].conditions[A]={...q[R].conditions[A],...D},D.field&&(q[R].conditions[A].operator="",q[R].conditions[A].value=""),x({...p,conditionGroups:q})},z=()=>{const R=[...p.conditionGroups||[]];R.push({id:String(Date.now()),logic:"AND",conditions:[{id:"1",field:"",operator:"",value:""}]}),x({...p,conditionGroups:R})},B=R=>{const A=p.mitreTechniques||[];A.includes(R)?x({...p,mitreTechniques:A.filter(D=>D!==R)}):x({...p,mitreTechniques:[...A,R]})},de=async()=>{var A,D;if(!p.name){ie.error("Rule name is required");return}if(!((A=p.conditionGroups)==null?void 0:A.some(q=>q.conditions.some(T=>T.field&&T.operator)))){ie.error("At least one condition is required");return}try{const q={...p,id:p.id||`custom_${Date.now()}`,score:((D=kr.find(T=>T.id===p.severity))==null?void 0:D.score)||10,updated_at:new Date().toISOString(),created_at:p.created_at||new Date().toISOString()};await Ie.post("/rules",q),ie.success(a?"Rule updated":"Rule created"),o(!1),l(null),N()}catch{ie.error("Failed to save rule")}},xe=async R=>{try{await Ie.delete(`/rules/${R}`),ie.success("Rule deleted"),N()}catch{ie.error("Failed to delete rule")}},be=R=>{x({name:R.name,description:R.description,severity:R.severity,category:"custom",conditionGroups:[{id:"1",logic:R.logic||"AND",conditions:R.conditions.map((A,D)=>({id:String(D+1),...A}))}],groupLogic:"AND",mitreTechniques:R.mitre,tags:[],enabled:!0}),c(!1),o(!0)},ue=()=>{const R=JSON.stringify(r,null,2),A=new Blob([R],{type:"application/json"}),D=URL.createObjectURL(A),q=document.createElement("a");q.href=D,q.download="nikses-rules.json",q.click(),URL.revokeObjectURL(D),ie.success("Rules exported")},se=r.filter(R=>{var q;const A=!b||R.name.toLowerCase().includes(b.toLowerCase())||((q=R.description)==null?void 0:q.toLowerCase().includes(b.toLowerCase())),D=!f||R.severity===f;return A&&D});return e?t.jsx("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-900 rounded-xl shadow-2xl w-full max-w-6xl max-h-[90vh] flex flex-col border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-purple-600 rounded-lg",children:t.jsx(oe,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-white",children:"Advanced Detection Rules"}),t.jsxs("p",{className:"text-sm text-gray-400",children:[r.length," rules configured"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:()=>c(!0),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 rounded text-sm flex items-center gap-1",children:[t.jsx(Go,{className:"w-4 h-4"}),"Templates"]}),t.jsxs("button",{onClick:ue,className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm flex items-center gap-1",children:[t.jsx(Rs,{className:"w-4 h-4"}),"Export"]}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-700 rounded-lg",children:t.jsx(ws,{className:"w-5 h-5 text-gray-400"})})]})]}),t.jsxs("div",{className:"flex flex-grow overflow-hidden",children:[t.jsxs("div",{className:"w-1/3 border-r border-gray-700 flex flex-col",children:[t.jsxs("div",{className:"p-3 border-b border-gray-700 space-y-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(Br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),t.jsx("input",{type:"text",placeholder:"Search rules...",value:b,onChange:R=>w(R.target.value),className:"w-full pl-9 pr-3 py-2 bg-gray-800 border border-gray-600 rounded text-sm focus:ring-2 focus:ring-purple-500"})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("select",{value:f,onChange:R=>y(R.target.value),className:"flex-grow px-2 py-1.5 bg-gray-800 border border-gray-600 rounded text-sm",children:[t.jsx("option",{value:"",children:"All Severities"}),kr.map(R=>t.jsx("option",{value:R.id,children:R.label},R.id))]}),t.jsxs("button",{onClick:()=>{l(null),x({name:"",description:"",severity:"medium",category:"custom",conditionGroups:[{id:"1",logic:"AND",conditions:[{id:"1",field:"",operator:"",value:""}]}],groupLogic:"AND",mitreTechniques:[],tags:[],enabled:!0}),o(!0)},className:"px-3 py-1.5 bg-purple-600 hover:bg-purple-700 rounded text-sm flex items-center gap-1",children:[t.jsx(Qi,{className:"w-4 h-4"}),"New"]})]})]}),t.jsx("div",{className:"flex-grow overflow-auto",children:v?t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx(Ns,{className:"w-6 h-6 animate-spin text-gray-500"})}):se.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(oe,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),t.jsx("p",{children:"No rules found"}),t.jsx("button",{onClick:()=>c(!0),className:"mt-2 text-sm text-purple-400 hover:text-purple-300",children:"Start with a template "})]}):se.map(R=>{var A,D;return t.jsxs("div",{onClick:()=>{l(R),x(R),o(!1)},className:`p-3 border-b border-gray-800 cursor-pointer hover:bg-gray-800/50 ${(a==null?void 0:a.id)===R.id?"bg-gray-800":""}`,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${((A=kr.find(q=>q.id===R.severity))==null?void 0:A.color)||"bg-gray-500"}`}),t.jsx("span",{className:"font-medium text-white truncate",children:R.name})]}),t.jsx("p",{className:"text-xs text-gray-500 truncate mt-1",children:R.description})]}),t.jsx("div",{className:"flex items-center gap-1 ml-2",children:!R.enabled&&t.jsx("span",{className:"px-1.5 py-0.5 bg-gray-700 text-gray-400 text-xs rounded",children:"Disabled"})})]}),((D=R.mitreTechniques)==null?void 0:D.length)>0&&t.jsxs("div",{className:"flex gap-1 mt-2 flex-wrap",children:[R.mitreTechniques.slice(0,2).map(q=>t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded",children:q},q)),R.mitreTechniques.length>2&&t.jsxs("span",{className:"text-xs text-gray-500",children:["+",R.mitreTechniques.length-2]})]})]},R.id)})})]}),t.jsx("div",{className:"flex-grow flex flex-col overflow-hidden",children:i?t.jsxs("div",{className:"flex-grow overflow-auto p-4 space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Rule Name *"}),t.jsx("input",{type:"text",value:p.name||"",onChange:R=>x({...p,name:R.target.value}),placeholder:"e.g., Credential Harvesting Detection",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded focus:ring-2 focus:ring-purple-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Severity"}),t.jsx("select",{value:p.severity||"medium",onChange:R=>x({...p,severity:R.target.value}),className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded focus:ring-2 focus:ring-purple-500",children:kr.map(R=>t.jsxs("option",{value:R.id,children:[R.label," (+",R.score," points)"]},R.id))})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-1",children:"Description"}),t.jsx("textarea",{value:p.description||"",onChange:R=>x({...p,description:R.target.value}),placeholder:"Describe what this rule detects...",rows:2,className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded focus:ring-2 focus:ring-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Detection Conditions"}),t.jsxs("button",{onClick:z,className:"text-xs text-purple-400 hover:text-purple-300 flex items-center gap-1",children:[t.jsx(Qi,{className:"w-3 h-3"}),"Add Group"]})]}),(ke=p.conditionGroups)==null?void 0:ke.map((R,A)=>t.jsxs("div",{className:"mb-4 p-3 bg-gray-800/50 border border-gray-700 rounded-lg",children:[A>0&&t.jsx("div",{className:"flex items-center justify-center mb-3",children:t.jsxs("select",{value:p.groupLogic,onChange:D=>x({...p,groupLogic:D.target.value}),className:"px-2 py-1 bg-gray-700 border border-gray-600 rounded text-xs font-mono",children:[t.jsx("option",{value:"AND",children:"AND"}),t.jsx("option",{value:"OR",children:"OR"})]})}),t.jsx("div",{className:"space-y-2",children:R.conditions.map((D,q)=>{var T,Y,ve,Le,ut;return t.jsxs("div",{className:"flex items-start gap-2",children:[q>0&&t.jsxs("select",{value:R.logic,onChange:he=>{const Ge=[...p.conditionGroups||[]];Ge[A].logic=he.target.value,x({...p,conditionGroups:Ge})},className:"w-16 px-1 py-2 bg-gray-700 border border-gray-600 rounded text-xs font-mono",children:[t.jsx("option",{value:"AND",children:"AND"}),t.jsx("option",{value:"OR",children:"OR"})]}),q===0&&t.jsx("div",{className:"w-16"}),t.jsxs("select",{value:D.field,onChange:he=>$(A,q,{field:he.target.value}),className:"flex-grow px-2 py-2 bg-gray-700 border border-gray-600 rounded text-sm",children:[t.jsx("option",{value:"",children:"Select field..."}),Object.entries(G0).map(([he,Ge])=>t.jsx("optgroup",{label:Ge.label,children:Ge.fields.map(Q=>t.jsx("option",{value:Q.id,children:Q.label},Q.id))},he))]}),t.jsxs("select",{value:D.operator,onChange:he=>$(A,q,{operator:he.target.value}),disabled:!D.field,className:"w-32 px-2 py-2 bg-gray-700 border border-gray-600 rounded text-sm disabled:opacity-50",children:[t.jsx("option",{value:"",children:"operator"}),S(D.field).map(he=>t.jsx("option",{value:he.id,children:he.label},he.id))]}),((T=j(D.field))==null?void 0:T.type)==="boolean"?t.jsx("div",{className:"w-32"}):((Y=j(D.field))==null?void 0:Y.type)==="enum"?t.jsxs("select",{value:D.value,onChange:he=>$(A,q,{value:he.target.value}),className:"w-32 px-2 py-2 bg-gray-700 border border-gray-600 rounded text-sm",children:[t.jsx("option",{value:"",children:"value"}),(Le=(ve=j(D.field))==null?void 0:ve.options)==null?void 0:Le.map(he=>t.jsx("option",{value:he,children:he},he))]}):t.jsx("input",{type:((ut=j(D.field))==null?void 0:ut.type)==="number"?"number":"text",value:D.value,onChange:he=>$(A,q,{value:he.target.value}),placeholder:"value",className:"w-32 px-2 py-2 bg-gray-700 border border-gray-600 rounded text-sm"}),t.jsx("button",{onClick:()=>P(A,q),className:"p-2 hover:bg-red-900/50 rounded text-red-400",children:t.jsx(yl,{className:"w-4 h-4"})})]},D.id)})}),t.jsxs("button",{onClick:()=>C(A),className:"mt-2 text-xs text-gray-400 hover:text-gray-300 flex items-center gap-1",children:[t.jsx(Qi,{className:"w-3 h-3"}),"Add condition"]})]},R.id))]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"MITRE ATT&CK Techniques"}),t.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-auto p-2 bg-gray-800/50 rounded border border-gray-700",children:X0.map(R=>{var A,D;return t.jsxs("label",{className:`flex items-center gap-2 p-2 rounded cursor-pointer hover:bg-gray-700 ${(A=p.mitreTechniques)!=null&&A.includes(R.id)?"bg-red-900/30":""}`,children:[t.jsx("input",{type:"checkbox",checked:((D=p.mitreTechniques)==null?void 0:D.includes(R.id))||!1,onChange:()=>B(R.id),className:"rounded border-gray-600 text-red-600 focus:ring-red-500"}),t.jsxs("span",{className:"text-xs",children:[t.jsx("span",{className:"font-mono text-red-400",children:R.id}),t.jsx("span",{className:"text-gray-400 ml-1",children:R.name})]})]},R.id)})})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-700",children:[t.jsx("button",{onClick:()=>{o(!1),a||l(null)},className:"px-4 py-2 border border-gray-600 rounded hover:bg-gray-800",children:"Cancel"}),t.jsxs("button",{onClick:de,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded flex items-center gap-2",children:[t.jsx(wp,{className:"w-4 h-4"}),"Save Rule"]})]})]}):a?t.jsxs("div",{className:"flex-grow overflow-auto p-4",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${((_=kr.find(R=>R.id===a.severity))==null?void 0:_.color)||"bg-gray-600"}`,children:(I=a.severity)==null?void 0:I.toUpperCase()}),!a.enabled&&t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:"DISABLED"})]}),t.jsx("h3",{className:"text-xl font-bold text-white",children:a.name}),t.jsx("p",{className:"text-gray-400 mt-1",children:a.description})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>o(!0),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm",children:"Edit"}),t.jsx("button",{onClick:()=>xe(a.id),className:"px-3 py-1.5 bg-red-900/50 hover:bg-red-900 text-red-400 rounded text-sm",children:"Delete"})]})]}),t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Detection Logic"}),t.jsx("div",{className:"p-3 bg-gray-800 rounded-lg font-mono text-sm",children:(E=a.conditionGroups)==null?void 0:E.map((R,A)=>t.jsxs("div",{children:[A>0&&t.jsx("div",{className:"text-purple-400 my-1",children:a.groupLogic}),t.jsx("div",{className:"pl-2 border-l-2 border-gray-700",children:R.conditions.map((D,q)=>t.jsxs("div",{className:"flex items-center gap-2 py-1",children:[q>0&&t.jsx("span",{className:"text-blue-400",children:R.logic}),t.jsx("span",{className:"text-green-400",children:D.field}),t.jsx("span",{className:"text-gray-500",children:D.operator}),t.jsxs("span",{className:"text-yellow-400",children:['"',D.value,'"']})]},q))})]},A))})]}),((F=a.mitreTechniques)==null?void 0:F.length)>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"MITRE ATT&CK Mapping"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:a.mitreTechniques.map(R=>{const A=X0.find(D=>D.id===R);return t.jsxs("a",{href:`https://attack.mitre.org/techniques/${R.replace(".","/")}`,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-1 bg-red-900/50 border border-red-800 rounded text-sm hover:bg-red-900",children:[t.jsx("span",{className:"font-mono text-red-400",children:R}),A&&t.jsxs("span",{className:"text-gray-400 ml-1",children:["- ",A.name]})]},R)})})]}),t.jsxs("div",{className:"text-xs text-gray-500 mt-4 pt-4 border-t border-gray-700",children:[t.jsxs("p",{children:["Rule ID: ",a.id]}),t.jsxs("p",{children:["Score: +",a.score||((J=kr.find(R=>R.id===a.severity))==null?void 0:J.score)||0," points"]}),a.created_at&&t.jsxs("p",{children:["Created: ",new Date(a.created_at).toLocaleString()]})]})]}):t.jsx("div",{className:"flex-grow flex items-center justify-center text-gray-500",children:t.jsxs("div",{className:"text-center",children:[t.jsx(oe,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),t.jsx("p",{children:"Select a rule to view details"}),t.jsx("p",{className:"text-sm mt-1",children:"or create a new one"})]})})})]}),d&&t.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 max-w-2xl w-full max-h-[70vh] overflow-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"text-lg font-bold",children:"Rule Templates"}),t.jsx("button",{onClick:()=>c(!1),className:"p-1 hover:bg-gray-700 rounded",children:t.jsx(ws,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:oj.map((R,A)=>{var D;return t.jsxs("div",{onClick:()=>be(R),className:"p-3 bg-gray-700/50 rounded-lg cursor-pointer hover:bg-gray-700 border border-gray-600",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${(D=kr.find(q=>q.id===R.severity))==null?void 0:D.color}`}),t.jsx("span",{className:"font-medium",children:R.name})]}),t.jsx("p",{className:"text-xs text-gray-400",children:R.description}),t.jsx("div",{className:"flex gap-1 mt-2",children:R.mitre.map(q=>t.jsx("span",{className:"px-1 py-0.5 bg-red-900/50 text-red-400 text-xs rounded font-mono",children:q},q))})]},A)})})]})})]})}):null},dj=({onViewAnalysis:e,onClose:s})=>{const[r,n]=k.useState([]),[a,l]=k.useState(null),[i,o]=k.useState(!0),[d,c]=k.useState(""),[u,h]=k.useState("all"),[b,w]=k.useState("date"),[f,y]=k.useState("desc"),[v,g]=k.useState(1),[p,x]=k.useState(1),N=10,j=_=>{const I=(_||"").toLowerCase();return["phishing","malware","bec","ransomware","credential_harvesting"].includes(I)?"malicious":["suspicious","spam","unknown"].includes(I)?"suspicious":["critical","high"].includes(I)?"malicious":["medium"].includes(I)?"suspicious":"clean"},S=_=>{const I=(_.subject||"").toLowerCase(),E=(_.sender_email||"").toLowerCase();return I.startsWith("url analysis")||E.includes("url@analysis")?"url":I.startsWith("sms analysis")||E.includes("sms@analysis")?"sms":"email"},C=_=>{switch(_){case"url":return t.jsx(jt,{className:"w-4 h-4"});case"sms":return t.jsx(Xt,{className:"w-4 h-4"});default:return t.jsx(Ut,{className:"w-4 h-4"})}},P=_=>{switch(_){case"url":return"URL";case"sms":return"SMS";default:return"Email"}},$=_=>{switch(_){case"url":return"bg-blue-100 text-blue-700 border-blue-200";case"sms":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}};k.useEffect(()=>{z()},[v,u,b,f]);const z=async()=>{o(!0);try{const I={date:"analyzed_at",score:"risk_score",subject:"subject"}[b]||"analyzed_at",F=(await Ie.get("/analyses",{params:{page:v,page_size:N,sort_by:I,sort_order:f,...u!=="all"&&{risk_level:u}}})).data,R=(F.analyses||F.items||[]).map(D=>({...D,id:D.analysis_id||D.id,sender:D.sender_email||D.sender||"Unknown",verdict:j(D.classification||D.risk_level),rules_triggered:D.rules_triggered_count||D.rules_triggered||0,critical_findings:D.critical_findings||0,ai_enabled:!!D.ai_summary,subject:D.subject||"(No Subject)"}));n(R),x(Math.ceil((F.total||0)/N));const A=await Ie.get("/analyses/stats");l(A.data)}catch(_){console.error("Failed to fetch dashboard data:",_),n(B()),l(de())}o(!1)},B=()=>[{analysis_id:"analysis-001",id:"analysis-001",subject:"URGENT: Wire Transfer Required Immediately",sender_email:"ceo@company-corp.com",sender:"ceo@company-corp.com",sender_domain:"company-corp.com",analyzed_at:new Date(Date.now()-36e5).toISOString(),risk_score:85,risk_level:"critical",classification:"bec",verdict:"malicious",rules_triggered:8,critical_findings:3,has_attachments:!0,has_urls:!0,attachment_count:1,url_count:2,ai_summary:"High-risk BEC attempt targeting finance",ai_enabled:!0},{analysis_id:"analysis-002",id:"analysis-002",subject:"Invoice #INV-2024-0342 - Payment Due",sender_email:"billing@vendor-payments.net",sender:"billing@vendor-payments.net",sender_domain:"vendor-payments.net",analyzed_at:new Date(Date.now()-72e5).toISOString(),risk_score:62,risk_level:"high",classification:"phishing",verdict:"suspicious",rules_triggered:5,critical_findings:1,has_attachments:!0,has_urls:!0,attachment_count:1,url_count:3,ai_summary:"Suspicious invoice with mismatched sender",ai_enabled:!0},{analysis_id:"analysis-003",id:"analysis-003",subject:"Meeting Notes - Q4 Planning Session",sender_email:"john.smith@company.com",sender:"john.smith@company.com",sender_domain:"company.com",analyzed_at:new Date(Date.now()-108e5).toISOString(),risk_score:12,risk_level:"low",classification:"legitimate",verdict:"clean",rules_triggered:1,critical_findings:0,has_attachments:!0,has_urls:!1,attachment_count:1,url_count:0,ai_summary:null,ai_enabled:!1},{analysis_id:"analysis-004",id:"analysis-004",subject:"Your password expires in 24 hours - Action Required",sender_email:"security@micros0ft-support.com",sender:"security@micros0ft-support.com",sender_domain:"micros0ft-support.com",analyzed_at:new Date(Date.now()-144e5).toISOString(),risk_score:92,risk_level:"critical",classification:"phishing",verdict:"malicious",rules_triggered:12,critical_findings:5,has_attachments:!1,has_urls:!0,attachment_count:0,url_count:2,ai_summary:"Credential harvesting attempt impersonating Microsoft",ai_enabled:!0},{analysis_id:"analysis-005",id:"analysis-005",subject:"Weekly Tech Newsletter - Issue #142",sender_email:"newsletter@techdigest.com",sender:"newsletter@techdigest.com",sender_domain:"techdigest.com",analyzed_at:new Date(Date.now()-18e6).toISOString(),risk_score:8,risk_level:"informational",classification:"legitimate",verdict:"clean",rules_triggered:0,critical_findings:0,has_attachments:!1,has_urls:!0,attachment_count:0,url_count:5,ai_summary:null,ai_enabled:!1}],de=()=>({total_analyses:47,malicious:12,suspicious:18,clean:17,avg_risk_score:45.3,analyses_today:5,analyses_this_week:23,top_threat_categories:[{category:"Phishing",count:15},{category:"BEC",count:8},{category:"Malware",count:5},{category:"Social Engineering",count:4}]}),xe=_=>{switch(_.toLowerCase()){case"malicious":return"bg-red-100 text-red-800 border-red-200";case"suspicious":return"bg-orange-100 text-orange-800 border-orange-200";case"clean":return"bg-green-100 text-green-800 border-green-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},be=_=>{switch(_.toLowerCase()){case"malicious":return t.jsx(L0,{className:"w-4 h-4"});case"suspicious":return t.jsx(Jo,{className:"w-4 h-4"});case"clean":return t.jsx(Zo,{className:"w-4 h-4"});default:return t.jsx(oe,{className:"w-4 h-4"})}},ue=_=>_>=80?"text-red-600 bg-red-50":_>=60?"text-orange-600 bg-orange-50":_>=40?"text-yellow-600 bg-yellow-50":_>=20?"text-blue-600 bg-blue-50":"text-green-600 bg-green-50",se=_=>{const I=new Date(_),F=new Date().getTime()-I.getTime(),J=Math.floor(F/6e4),R=Math.floor(F/36e5),A=Math.floor(F/864e5);return J<60?`${J}m ago`:R<24?`${R}h ago`:A<7?`${A}d ago`:I.toLocaleDateString()},ke=r.filter(_=>{if(!d)return!0;const I=d.toLowerCase(),E=(_.subject||"").toLowerCase(),F=(_.sender||_.sender_email||"").toLowerCase(),J=(_.sender_domain||"").toLowerCase();return E.includes(I)||F.includes(I)||J.includes(I)});return t.jsx("div",{className:"fixed inset-0 bg-gray-900 bg-opacity-50 flex items-end md:items-center justify-center z-50 p-0 md:p-4",children:t.jsxs("div",{className:"bg-white rounded-t-2xl md:rounded-xl shadow-2xl w-full md:max-w-7xl max-h-[95vh] overflow-hidden flex flex-col animate-slide-up md:animate-fade-in",children:[t.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-4 md:p-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[t.jsx(fl,{className:"w-6 h-6 md:w-8 md:h-8"}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-lg md:text-2xl font-bold",children:"Security Dashboard"}),t.jsx("p",{className:"text-indigo-200 text-xs md:text-sm",children:"Analysis Overview & History"})]})]}),t.jsx("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:t.jsx(at,{className:"w-6 h-6"})})]})}),a&&t.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-2 md:gap-4 p-3 md:p-6 bg-gray-50 border-b",children:[t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-gray-500 text-[10px] md:text-sm mb-1",children:[t.jsx(ed,{className:"w-3 h-3 md:w-4 md:h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Total"})," Analyses"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-gray-900",children:a.total_analyses})]}),t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border border-red-100",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-red-500 text-[10px] md:text-sm mb-1",children:[t.jsx(L0,{className:"w-3 h-3 md:w-4 md:h-4"}),"Malicious"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-red-600",children:a.malicious})]}),t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border border-orange-100",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-orange-500 text-[10px] md:text-sm mb-1",children:[t.jsx(Jo,{className:"w-3 h-3 md:w-4 md:h-4"}),"Suspicious"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-orange-600",children:a.suspicious})]}),t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border border-green-100",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-green-500 text-[10px] md:text-sm mb-1",children:[t.jsx(Zo,{className:"w-3 h-3 md:w-4 md:h-4"}),"Clean"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-green-600",children:a.clean})]}),t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border hidden md:block",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-gray-500 text-[10px] md:text-sm mb-1",children:[t.jsx(Gl,{className:"w-3 h-3 md:w-4 md:h-4"}),"Avg Risk"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-gray-900",children:a.avg_risk_score.toFixed(1)})]}),t.jsxs("div",{className:"bg-white rounded-lg p-2 md:p-4 shadow-sm border hidden lg:block",children:[t.jsxs("div",{className:"flex items-center gap-1 md:gap-2 text-gray-500 text-[10px] md:text-sm mb-1",children:[t.jsx(by,{className:"w-3 h-3 md:w-4 md:h-4"}),"Today"]}),t.jsx("div",{className:"text-lg md:text-2xl font-bold text-indigo-600",children:a.analyses_today})]})]}),t.jsxs("div",{className:"flex flex-wrap items-center gap-4 p-4 border-b bg-white",children:[t.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[t.jsx(Br,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),t.jsx("input",{type:"text",placeholder:"Search by subject, sender, or filename...",value:d,onChange:_=>c(_.target.value),className:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(wy,{className:"w-5 h-5 text-gray-400"}),t.jsxs("select",{value:u,onChange:_=>h(_.target.value),className:"border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"all",children:"All Verdicts"}),t.jsx("option",{value:"malicious",children:"Malicious"}),t.jsx("option",{value:"suspicious",children:"Suspicious"}),t.jsx("option",{value:"clean",children:"Clean"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("select",{value:b,onChange:_=>w(_.target.value),className:"border rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"date",children:"Sort by Date"}),t.jsx("option",{value:"score",children:"Sort by Risk Score"}),t.jsx("option",{value:"subject",children:"Sort by Subject"})]}),t.jsx("button",{onClick:()=>y(f==="asc"?"desc":"asc"),className:"p-2 border rounded-lg hover:bg-gray-50",children:f==="desc"?"":""})]}),t.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:[t.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]})]}),t.jsx("div",{className:"flex-1 overflow-auto p-4",children:i?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx(Ns,{className:"w-8 h-8 animate-spin text-indigo-600"})}):ke.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[t.jsx(Ut,{className:"w-16 h-16 mb-4 text-gray-300"}),t.jsx("p",{className:"text-lg",children:"No analyses found"}),t.jsx("p",{className:"text-sm",children:"Upload an email to get started"})]}):t.jsx("div",{className:"space-y-3",children:ke.map(_=>t.jsx("div",{className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>e(_.id||_.analysis_id),children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsxs("div",{className:`flex-shrink-0 w-16 h-16 rounded-lg flex flex-col items-center justify-center ${ue(_.risk_score)}`,children:[t.jsx("span",{className:"text-2xl font-bold",children:_.risk_score}),t.jsx("span",{className:"text-xs uppercase",children:"Risk"})]}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(()=>{const I=S(_);return t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium border ${$(I)}`,children:[C(I),P(I)]})})(),t.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium border ${xe(_.verdict||"unknown")}`,children:[be(_.verdict||"unknown"),(_.verdict||"unknown").toUpperCase()]}),t.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx(os,{className:"w-3 h-3"}),se(_.analyzed_at)]}),_.ai_enabled&&t.jsx("span",{className:"text-xs bg-purple-100 text-purple-700 px-2 py-0.5 rounded-full",children:"AI Analyzed"})]}),t.jsx("h3",{className:"font-semibold text-gray-900 truncate mb-1",children:(()=>{const I=_.subject||"(No Subject)";return I.toLowerCase().startsWith("url analysis:")?I.replace(/^url analysis:\s*/i," "):I.toLowerCase().startsWith("sms analysis:")?I.replace(/^sms analysis:\s*/i," "):I})()}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[C(S(_)),(()=>{const I=S(_);return I==="url"?_.url_count?`${_.url_count} URL(s) analyzed`:"URL Analysis":I==="sms"?"SMS/Message Analysis":_.sender||_.sender_email||"Unknown"})()]}),S(_)==="email"&&_.sender_domain&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-gray-400",children:"@"}),t.jsx("span",{className:"text-gray-500",children:_.sender_domain})]})]}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"}),_.rules_triggered," rules triggered"]}),(_.critical_findings??0)>0&&t.jsxs("span",{className:"flex items-center gap-1 text-red-600",children:[t.jsx(gl,{className:"w-3 h-3"}),_.critical_findings," critical findings"]}),_.has_attachments&&t.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded",children:" Attachments"}),_.has_urls&&t.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded",children:" URLs"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:I=>{I.stopPropagation(),e(_.id||_.analysis_id)},className:"p-2 text-indigo-600 hover:bg-indigo-50 rounded-lg",title:"View Details",children:t.jsx(kn,{className:"w-5 h-5"})}),t.jsx("button",{onClick:I=>I.stopPropagation(),className:"p-2 text-gray-600 hover:bg-gray-50 rounded-lg",title:"Export",children:t.jsx(Rs,{className:"w-5 h-5"})})]})]})},_.id||_.analysis_id))})}),t.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t bg-gray-50",children:[t.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",ke.length," of ",(a==null?void 0:a.total_analyses)||0," analyses"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>g(Math.max(1,v-1)),disabled:v===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(td,{className:"w-5 h-5"})}),t.jsxs("span",{className:"px-4 py-2 text-sm",children:["Page ",v," of ",p]}),t.jsx("button",{onClick:()=>g(Math.min(p,v+1)),disabled:v===p,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Fr,{className:"w-5 h-5"})})]})]})]})})},uj=()=>{const[e,s]=k.useState(null);return{copied:e,copy:(n,a)=>{navigator.clipboard.writeText(n),s(a),setTimeout(()=>s(null),2e3)}}},mj=({verdict:e,score:s})=>{const r=()=>{switch(e){case"malicious":return"bg-red-500/20 text-red-400 border-red-500/30";case"suspicious":return"bg-yellow-500/20 text-yellow-400 border-yellow-500/30";case"clean":return"bg-green-500/20 text-green-400 border-green-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},n=()=>{switch(e){case"malicious":return t.jsx(at,{className:"w-4 h-4"});case"suspicious":return t.jsx(ae,{className:"w-4 h-4"});case"clean":return t.jsx(Ce,{className:"w-4 h-4"});default:return t.jsx(Xo,{className:"w-4 h-4"})}};return t.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border ${r()}`,children:[n(),t.jsx("span",{className:"font-medium capitalize",children:e||"Unknown"}),s!==void 0&&s>0&&t.jsxs("span",{className:"text-xs opacity-70",children:["(",s,"/100)"]})]})},xj=({score:e})=>{const s=()=>e>=70?"bg-red-500":e>=40?"bg-yellow-500":e>=10?"bg-blue-500":"bg-green-500";return t.jsxs("div",{className:"w-full",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{className:"text-gray-400",children:"Threat Score"}),t.jsxs("span",{className:"font-mono font-medium text-white",children:[e,"/100"]})]}),t.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${s()}`,style:{width:`${e}%`}})})]})},Zs=({title:e,icon:s,count:r,children:n,defaultExpanded:a=!1,onExpand:l})=>{const[i,o]=k.useState(a),d=()=>{const c=!i;o(c),c&&l&&l()};return t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("button",{onClick:d,className:"w-full flex items-center justify-between p-3 bg-gray-800/50 hover:bg-gray-700/50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[s,t.jsx("span",{className:"font-medium text-gray-200",children:e}),r!==void 0&&r>0&&t.jsx("span",{className:"px-2 py-0.5 text-xs bg-gray-700 rounded-full text-gray-300",children:r})]}),i?t.jsx(Er,{className:"w-4 h-4 text-gray-400"}):t.jsx(Qt,{className:"w-4 h-4 text-gray-400"})]}),i&&t.jsx("div",{className:"p-3 bg-gray-900/50",children:n})]})},pj=({result:e})=>{var f,y,v,g,p,x,N,j,S,C,P,$,z,B,de,xe,be,ue,se,ke,_,I;const[s,r]=k.useState(!1),{copied:n,copy:a}=uj(),[l,i]=k.useState([]),[o,d]=k.useState(!1),[c,u]=k.useState(null),[h,b]=k.useState(null),w=async()=>{if(!(!e.submission_id||o||l.length>0)){d(!0),u(null);try{const E=e.submission_id,F=await Ie.get(`/sandbox/screenshots/${E}`);F.data.success&&F.data.screenshots&&i(F.data.screenshots)}catch(E){console.error("Failed to fetch screenshots:",E),u("Screenshots not available")}finally{d(!1)}}};return e.status==="skipped"?t.jsx("div",{className:"border border-gray-700 rounded-lg p-4 bg-gray-800/30",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(jp,{className:"w-5 h-5 text-gray-500"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-300",children:e.filename||"Unknown file"}),t.jsx("p",{className:"text-sm text-gray-500",children:e.error||"Skipped - not suitable for analysis"})]})]})}):e.status==="submitted"||e.status==="pending"||e.status==="running"?t.jsx("div",{className:"border border-blue-500/30 rounded-lg p-4 bg-blue-500/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(yr,{className:"w-5 h-5 text-blue-400 animate-spin"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-200",children:e.filename||"File"}),t.jsx("p",{className:"text-sm text-blue-400",children:"Analysis in progress..."})]}),e.report_url&&t.jsxs("a",{href:e.report_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-400 hover:text-blue-300",children:["View Progress ",t.jsx(Ye,{className:"w-3 h-3"})]})]})}):e.status==="error"||e.status==="not_configured"?t.jsx("div",{className:"border border-red-500/30 rounded-lg p-4 bg-red-500/10",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gy,{className:"w-5 h-5 text-red-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-200",children:e.filename||"File"}),t.jsx("p",{className:"text-sm text-red-400",children:e.error||"Analysis failed"})]})]})}):t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"p-4 bg-gray-800/50 cursor-pointer hover:bg-gray-700/50 transition-colors",onClick:()=>r(!s),children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(gl,{className:`w-5 h-5 ${e.verdict==="malicious"?"text-red-400":e.verdict==="suspicious"?"text-yellow-400":"text-green-400"}`}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-200",children:e.filename||"Unknown file"}),e.file_hash&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:[e.file_hash.substring(0,16),"..."]}),t.jsx("button",{onClick:E=>{E.stopPropagation(),a(e.file_hash,"hash")},className:"text-gray-500 hover:text-gray-300",children:n==="hash"?t.jsx(ss,{className:"w-3 h-3"}):t.jsx(De,{className:"w-3 h-3"})})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(mj,{verdict:e.verdict,score:e.threat_score}),s?t.jsx(Er,{className:"w-4 h-4 text-gray-400"}):t.jsx(Qt,{className:"w-4 h-4 text-gray-400"})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-4 mt-3 text-sm",children:[e.malware_families&&e.malware_families.length>0&&t.jsxs("span",{className:"text-red-400",children:[t.jsx(yp,{className:"w-3 h-3 inline mr-1"}),e.malware_families.join(", ")]}),e.mitre_attacks&&e.mitre_attacks.length>0&&t.jsxs("span",{className:"text-orange-400",children:[t.jsx(oe,{className:"w-3 h-3 inline mr-1"}),e.mitre_attacks.length," MITRE techniques"]}),e.network_iocs&&(((f=e.network_iocs.domains)==null?void 0:f.length)>0||((y=e.network_iocs.ips)==null?void 0:y.length)>0)&&t.jsxs("span",{className:"text-blue-400",children:[t.jsx(Ke,{className:"w-3 h-3 inline mr-1"}),(((v=e.network_iocs.domains)==null?void 0:v.length)||0)+(((g=e.network_iocs.ips)==null?void 0:g.length)||0)," network IOCs"]})]})]}),s&&t.jsxs("div",{className:"p-4 space-y-4 bg-gray-900/50",children:[(e.file_type||e.file_size||e.submit_name)&&t.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-gray-400 pb-2 border-b border-gray-700/50",children:[e.file_type&&t.jsx("span",{className:"px-2 py-0.5 bg-gray-800 rounded",children:e.file_type}),e.type_short&&e.type_short!==e.file_type&&t.jsx("span",{className:"px-2 py-0.5 bg-gray-800 rounded",children:e.type_short}),e.file_size&&e.file_size>0&&t.jsxs("span",{children:[(e.file_size/1024).toFixed(1)," KB"]}),e.submit_name&&t.jsx("span",{className:"text-gray-500 truncate max-w-[200px]",children:e.submit_name})]}),t.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 lg:grid-cols-6 gap-2 pb-3 border-b border-gray-700",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 text-center",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"Environment"}),t.jsx("p",{className:"text-sm text-gray-300 truncate",children:e.environment||"Windows"})]}),e.av_detect!==void 0&&e.av_detect>0&&t.jsxs("div",{className:"bg-red-500/10 rounded-lg p-2 text-center border border-red-500/20",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"AV Detections"}),t.jsx("p",{className:"text-sm text-red-400 font-medium",children:e.av_detect})]}),e.vt_detect!==void 0&&e.vt_detect>0&&t.jsxs("div",{className:"bg-red-500/10 rounded-lg p-2 text-center border border-red-500/20",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"VirusTotal"}),t.jsx("p",{className:"text-sm text-red-400 font-medium",children:e.vt_detect})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 text-center",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"Signatures"}),t.jsx("p",{className:`text-sm ${(e.total_signatures||((p=e.signatures)==null?void 0:p.length)||0)>0?"text-purple-400":"text-gray-500"}`,children:e.total_signatures||((x=e.signatures)==null?void 0:x.length)||0})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 text-center",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"MITRE"}),t.jsx("p",{className:`text-sm ${(((N=e.mitre_attacks)==null?void 0:N.length)||0)>0?"text-orange-400":"text-gray-500"}`,children:((j=e.mitre_attacks)==null?void 0:j.length)||0})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 text-center",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"Network"}),t.jsx("p",{className:`text-sm ${(e.total_network_connections||0)>0?"text-blue-400":"text-gray-500"}`,children:e.total_network_connections||(((C=(S=e.network_iocs)==null?void 0:S.domains)==null?void 0:C.length)||0)+((($=(P=e.network_iocs)==null?void 0:P.ips)==null?void 0:$.length)||0)+(((B=(z=e.network_iocs)==null?void 0:z.urls)==null?void 0:B.length)||0)})]}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-2 text-center",children:[t.jsx("p",{className:"text-xs text-gray-500",children:"Processes"}),t.jsx("p",{className:`text-sm ${(e.total_processes||((de=e.processes)==null?void 0:de.length)||0)>0?"text-cyan-400":"text-gray-500"}`,children:e.total_processes||((xe=e.processes)==null?void 0:xe.length)||0})]})]}),e.threat_score!==void 0&&t.jsx(xj,{score:e.threat_score}),e.malware_families&&e.malware_families.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Malware Families"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.malware_families.map((E,F)=>t.jsx("span",{className:"px-2 py-1 bg-red-500/20 text-red-400 rounded text-sm",children:E},F))})]}),e.classification_tags&&e.classification_tags.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-2",children:"Classification Tags"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.classification_tags.map((E,F)=>t.jsx("span",{className:"px-2 py-1 bg-yellow-500/20 text-yellow-400 rounded text-sm",children:E},F))})]}),e.mitre_attacks&&e.mitre_attacks.length>0&&t.jsx(Zs,{title:"MITRE ATT&CK Techniques",icon:t.jsx(oe,{className:"w-4 h-4 text-orange-400"}),count:e.mitre_attacks.length,defaultExpanded:!0,children:t.jsx("div",{className:"space-y-2",children:e.mitre_attacks.map((E,F)=>t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("a",{href:`https://attack.mitre.org/techniques/${E.attck_id.replace(".","/")}`,target:"_blank",rel:"noopener noreferrer",className:"px-2 py-0.5 bg-orange-500/20 text-orange-400 rounded font-mono text-xs hover:bg-orange-500/30",children:E.attck_id}),t.jsx("span",{className:"text-gray-300",children:E.technique}),t.jsxs("span",{className:"text-gray-500",children:["(",E.tactic,")"]})]},F))})}),e.signatures&&e.signatures.length>0&&t.jsx(Zs,{title:"Behavioral Signatures",icon:t.jsx(ed,{className:"w-4 h-4 text-purple-400"}),count:e.signatures.length,children:t.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:e.signatures.map((E,F)=>t.jsxs("div",{className:"p-2 bg-gray-800/50 rounded text-sm",children:[t.jsx("p",{className:"font-medium text-gray-200",children:E.name}),E.description&&t.jsx("p",{className:"text-gray-400 text-xs mt-1",children:E.description})]},F))})}),e.network_iocs&&(((be=e.network_iocs.domains)==null?void 0:be.length)>0||((ue=e.network_iocs.ips)==null?void 0:ue.length)>0||((se=e.network_iocs.urls)==null?void 0:se.length)>0)&&t.jsx(Zs,{title:"Network IOCs",icon:t.jsx(Ke,{className:"w-4 h-4 text-blue-400"}),count:(((ke=e.network_iocs.domains)==null?void 0:ke.length)||0)+(((_=e.network_iocs.ips)==null?void 0:_.length)||0)+(((I=e.network_iocs.urls)==null?void 0:I.length)||0),children:t.jsxs("div",{className:"space-y-3",children:[e.network_iocs.domains&&e.network_iocs.domains.length>0&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[t.jsx(Ke,{className:"w-3 h-3"})," Domains"]}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.network_iocs.domains.map((E,F)=>t.jsx("code",{className:"px-2 py-0.5 bg-gray-800 rounded text-xs text-gray-300",children:E},F))})]}),e.network_iocs.ips&&e.network_iocs.ips.length>0&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[t.jsx(vt,{className:"w-3 h-3"})," IP Addresses"]}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.network_iocs.ips.map((E,F)=>t.jsx("code",{className:"px-2 py-0.5 bg-gray-800 rounded text-xs text-gray-300",children:E},F))})]}),e.network_iocs.urls&&e.network_iocs.urls.length>0&&t.jsxs("div",{children:[t.jsxs("p",{className:"text-xs text-gray-500 mb-1 flex items-center gap-1",children:[t.jsx(sd,{className:"w-3 h-3"})," URLs"]}),t.jsxs("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:[e.network_iocs.urls.slice(0,10).map((E,F)=>t.jsx("code",{className:"block px-2 py-0.5 bg-gray-800 rounded text-xs text-gray-300 truncate",children:E},F)),e.network_iocs.urls.length>10&&t.jsxs("p",{className:"text-xs text-gray-500",children:["+",e.network_iocs.urls.length-10," more"]})]})]})]})}),e.contacted_hosts&&e.contacted_hosts.length>0&&t.jsx(Zs,{title:"Contacted Hosts",icon:t.jsx(vt,{className:"w-4 h-4 text-pink-400"}),count:e.contacted_hosts.length,children:t.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:e.contacted_hosts.map((E,F)=>t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-800/50 rounded text-sm",children:[t.jsx("code",{className:"text-gray-300",children:E.ip}),E.port>0&&t.jsxs("span",{className:"px-1.5 py-0.5 bg-pink-500/20 text-pink-400 rounded text-xs",children:[":",E.port]}),E.protocol&&t.jsx("span",{className:"text-gray-500 text-xs",children:E.protocol}),E.hostname&&t.jsx("span",{className:"text-gray-400 text-xs truncate max-w-[150px]",children:E.hostname}),E.country&&t.jsx("span",{className:"text-gray-500 text-xs ml-auto",children:E.country})]},F))})}),e.file_iocs&&e.file_iocs.length>0&&t.jsx(Zs,{title:"Dropped Files",icon:t.jsx(gl,{className:"w-4 h-4 text-red-400"}),count:e.file_iocs.length,children:t.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:e.file_iocs.map((E,F)=>{var J;return t.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-800/50 rounded",children:[t.jsx(gl,{className:`w-4 h-4 flex-shrink-0 ${E.malicious?"text-red-400":"text-gray-400"}`}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"text-sm text-gray-200 truncate",children:E.filename}),E.malicious&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-500/20 text-red-400 rounded text-xs flex-shrink-0",children:"Malicious"})]}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsxs("span",{className:"font-mono truncate",children:[(J=E.sha256)==null?void 0:J.substring(0,24),"..."]}),E.type&&t.jsxs("span",{children:[" ",E.type]}),E.size&&t.jsxs("span",{children:[" ",(E.size/1024).toFixed(1)," KB"]})]})]})]},F)})})}),e.processes&&e.processes.length>0&&t.jsx(Zs,{title:"Process Activity",icon:t.jsx(jy,{className:"w-4 h-4 text-cyan-400"}),count:e.processes.length,children:t.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:e.processes.map((E,F)=>t.jsxs("div",{className:"p-2 bg-gray-800/50 rounded",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("p",{className:"text-sm text-gray-200 font-medium",children:E.name}),t.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[t.jsxs("span",{children:["PID: ",E.pid]}),E.parent_pid?t.jsxs("span",{children:[" Parent: ",E.parent_pid]}):null]})]}),E.command_line&&t.jsx("code",{className:"block text-xs text-gray-400 mt-1 p-1 bg-gray-900/50 rounded truncate",children:E.command_line}),(E.file_accesses||E.registry_accesses)&&t.jsxs("div",{className:"flex gap-3 mt-1 text-xs text-gray-500",children:[E.file_accesses?t.jsxs("span",{children:[" ",E.file_accesses," file ops"]}):null,E.registry_accesses?t.jsxs("span",{children:[" ",E.registry_accesses," reg ops"]}):null]})]},F))})}),e.registry_keys&&e.registry_keys.length>0&&t.jsx(Zs,{title:"Registry Modifications",icon:t.jsx(Ze,{className:"w-4 h-4 text-yellow-400"}),count:e.registry_keys.length,children:t.jsx("div",{className:"space-y-1 max-h-48 overflow-y-auto",children:e.registry_keys.map((E,F)=>t.jsx("code",{className:"block text-xs text-gray-400 p-1 bg-gray-800/50 rounded truncate",children:E},F))})}),e.status==="completed"&&t.jsx(Zs,{title:"Sandbox Screenshots",icon:t.jsx(E0,{className:"w-4 h-4 text-indigo-400"}),count:l.length||void 0,defaultExpanded:!1,onExpand:w,children:t.jsxs("div",{className:"space-y-3",children:[o&&t.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-sm",children:[t.jsx(yr,{className:"w-4 h-4 animate-spin"}),"Loading screenshots..."]}),c&&t.jsx("p",{className:"text-sm text-gray-500",children:c}),l.length>0&&t.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:l.map(E=>t.jsxs("div",{className:"relative group cursor-pointer rounded-lg overflow-hidden border border-gray-700 hover:border-indigo-500 transition-colors",onClick:()=>b(E.index),children:[t.jsx("img",{src:`data:image/${E.format||"png"};base64,${E.image}`,alt:E.name||`Screenshot ${E.index+1}`,className:"w-full h-24 object-cover"}),t.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:t.jsx(Ty,{className:"w-5 h-5 text-white"})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/70 px-2 py-1",children:t.jsx("p",{className:"text-xs text-gray-300 truncate",children:E.name||`Screenshot ${E.index+1}`})})]},E.index))}),!o&&l.length===0&&!c&&t.jsxs("button",{onClick:w,className:"flex items-center gap-2 text-sm text-indigo-400 hover:text-indigo-300",children:[t.jsx(E0,{className:"w-4 h-4"}),"Load Screenshots"]})]})}),h!==null&&l[h]&&t.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4",onClick:()=>b(null),children:t.jsxs("div",{className:"relative max-w-4xl max-h-[90vh]",children:[t.jsx("button",{className:"absolute -top-10 right-0 text-white hover:text-gray-300",onClick:()=>b(null),children:t.jsx(ws,{className:"w-6 h-6"})}),t.jsx("img",{src:`data:image/${l[h].format||"png"};base64,${l[h].image}`,alt:l[h].name||`Screenshot ${h+1}`,className:"max-w-full max-h-[85vh] object-contain rounded-lg",onClick:E=>E.stopPropagation()}),t.jsx("div",{className:"absolute bottom-2 left-2 bg-black/70 px-3 py-1 rounded text-sm text-white",children:l[h].name||`Screenshot ${h+1}`}),t.jsxs("div",{className:"absolute bottom-2 right-2 flex gap-2",children:[h>0&&t.jsx("button",{className:"bg-black/70 px-3 py-1 rounded text-sm text-white hover:bg-black/90",onClick:E=>{E.stopPropagation(),b(h-1)},children:" Prev"}),h<l.length-1&&t.jsx("button",{className:"bg-black/70 px-3 py-1 rounded text-sm text-white hover:bg-black/90",onClick:E=>{E.stopPropagation(),b(h+1)},children:"Next "})]})]})}),e.report_url&&t.jsx("div",{className:"pt-2 border-t border-gray-700",children:t.jsxs("a",{href:e.report_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-blue-400 hover:text-blue-300 text-sm",children:[t.jsx(Ye,{className:"w-4 h-4"}),"View Full Report on Hybrid Analysis"]})})]})]})},hj=({sandboxAnalysis:e,isLoading:s=!1})=>{const[r,n]=k.useState([]),[a,l]=k.useState(!1),[i,o]=k.useState(null),[d,c]=k.useState(!1);k.useEffect(()=>{e!=null&&e.results&&n(e.results)},[e]);const u=r.some(y=>y.status==="submitted"||y.status==="pending"||y.status==="running");k.useEffect(()=>{if(!d||!u)return;const y=setInterval(()=>{h()},3e4);return()=>clearInterval(y)},[d,u]);const h=k.useCallback(async()=>{var p;if(a)return;const y=r.filter(x=>x.status==="submitted"||x.status==="pending"||x.status==="running"),v=y.filter(x=>x.submission_id).map(x=>x.submission_id),g=y.filter(x=>x.file_hash).map(x=>x.file_hash);if(!(v.length===0&&g.length===0)){l(!0);try{const x=await Ie.post("/sandbox/batch-status",{submission_ids:v,file_hashes:g});(p=x.data)!=null&&p.results&&n(N=>N.map(j=>{const S=x.data.results.filter(P=>P.file_hash===j.file_hash||P.submission_id===j.submission_id||P.sha256===j.file_hash||P.file_hash===j.submission_id),C=S.find(P=>P.status==="completed"||P.verdict)||S.find(P=>P.status!=="error")||S[0];return C&&(C.status==="completed"||C.verdict)?{...j,...C,status:"completed",submission_id:C.submission_id||j.submission_id}:j})),o(new Date)}catch(x){console.error("Failed to refresh sandbox status:",x)}finally{l(!1)}}},[r,a]);if(s)return t.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(oe,{className:"w-5 h-5 text-blue-400"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Sandbox Analysis"})]}),t.jsxs("div",{className:"flex items-center justify-center py-8",children:[t.jsx(yr,{className:"w-6 h-6 text-blue-400 animate-spin"}),t.jsx("span",{className:"ml-2 text-gray-400",children:"Running dynamic analysis..."})]})]});if(!e)return null;if(!e.analyzed&&e.reason==="sandbox_not_configured")return t.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(jn,{className:"w-5 h-5 text-gray-500"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Sandbox Analysis"}),t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-400 rounded text-xs",children:"Not Configured"})]}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Dynamic malware analysis is not configured. Add your Hybrid Analysis API key in Settings  Threat Intel to enable sandbox analysis of attachments."}),t.jsxs("a",{href:"https://www.hybrid-analysis.com/apikeys/info",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 mt-3 text-sm text-blue-400 hover:text-blue-300",children:["Get free API key ",t.jsx(Ye,{className:"w-3 h-3"})]})]});if(!e.analyzed&&e.reason==="no_attachments")return t.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(oe,{className:"w-5 h-5 text-gray-500"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Sandbox Analysis"})]}),t.jsx("p",{className:"text-gray-400 text-sm",children:"No attachments to analyze. Sandbox analysis is performed on email attachments like executables, documents, and archives."})]});if(!e.analyzed&&e.reason==="no_content")return t.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx(jp,{className:"w-5 h-5 text-yellow-500"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Sandbox Analysis"})]}),t.jsx("p",{className:"text-gray-400 text-sm",children:"Attachment content could not be extracted for sandbox analysis. The file may be corrupted or in an unsupported format."})]});const{summary:b}=e,w=r.length>0?r:e.results||[],f={...b,malicious:w.filter(y=>y.verdict==="malicious").length,suspicious:w.filter(y=>y.verdict==="suspicious").length,clean:w.filter(y=>y.verdict==="clean").length};return t.jsxs("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(oe,{className:"w-5 h-5 text-purple-400"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-200",children:"Sandbox Analysis"}),t.jsx("span",{className:"px-2 py-0.5 bg-purple-500/20 text-purple-400 rounded text-xs",children:"Hybrid Analysis"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[i&&t.jsxs("span",{className:"text-xs text-gray-500 flex items-center gap-1",children:[t.jsx(os,{className:"w-3 h-3"}),"Updated ",i.toLocaleTimeString()]}),u&&t.jsxs("label",{className:"flex items-center gap-1 text-xs text-gray-400 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:d,onChange:y=>c(y.target.checked),className:"w-3 h-3 rounded"}),"Auto-refresh"]}),t.jsxs("button",{onClick:h,disabled:a||!u,className:`flex items-center gap-1 px-2 py-1 rounded text-xs transition-colors ${u?"bg-purple-500/20 text-purple-400 hover:bg-purple-500/30":"bg-gray-700 text-gray-500 cursor-not-allowed"}`,children:[t.jsx(Ns,{className:`w-3 h-3 ${a?"animate-spin":""}`}),a?"Checking...":"Refresh"]})]})]}),u&&t.jsx("div",{className:"mb-4 p-3 bg-blue-500/10 border border-blue-500/30 rounded-lg",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(yr,{className:"w-4 h-4 text-blue-400 animate-spin"}),t.jsxs("span",{className:"text-sm text-blue-400",children:["Analysis in progress. Sandbox analysis typically takes 2-5 minutes.",d?" Auto-refreshing every 30 seconds.":" Click Refresh to check status."]})]})}),t.jsxs("div",{className:"grid grid-cols-5 gap-3 mb-4",children:[t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-gray-200",children:f.total}),t.jsx("p",{className:"text-xs text-gray-500",children:"Total"})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-blue-400",children:f.analyzed}),t.jsx("p",{className:"text-xs text-gray-500",children:"Analyzed"})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-red-400",children:f.malicious}),t.jsx("p",{className:"text-xs text-gray-500",children:"Malicious"})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-yellow-400",children:f.suspicious}),t.jsx("p",{className:"text-xs text-gray-500",children:"Suspicious"})]}),t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 text-center",children:[t.jsx("p",{className:"text-2xl font-bold text-green-400",children:f.clean}),t.jsx("p",{className:"text-xs text-gray-500",children:"Clean"})]})]}),w&&w.length>0&&t.jsx("div",{className:"space-y-3",children:w.map((y,v)=>t.jsx(pj,{result:y},v))})]})},gj=({result:e,onExport:s,onBack:r})=>{var ue,se,ke,_,I,E,F,J,R,A,D,q,T,Y,ve,Le,ut,he,Ge,Q,H,ge,O,Z,re,V,ee,Ae,te,Os,zs,Us,Fs,Bs,Hs,Vs,Pe,kt,qs,En,Tn,An,Rn,Ln,Pn,Mn,W,le,Ee,fe,ce,Ne,Mt,we,us,Ws,Ks,Qs,Gs,Xe,pe,mt,Xs,es,Ys,it,$n,Dn,In,On,zn,je,$a,st,id,od,cd,dd,ud,md,xd,pd,hd,gd,fd,yd,bd,jd,vd,Nd,wd,_d,kd,Sd,Cd,Ed,Td,Ad,Rd,Ld,Pd,Md,$d,Dd,Id,Od,zd,Ud,Fd,Bd,Hd,Vd,qd,Wd,Kd,Qd,Gd,Xd,Yd,Jd,Zd,eu,tu,su,ru,nu,au,lu,iu,ou,cu,du;const[n,a]=k.useState("overview"),[l,i]=k.useState(new Set(["auth","threatintel","rules","iocs"])),[o,d]=k.useState(null);if(!e)return t.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(oe,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),t.jsx("h2",{className:"text-xl font-semibold text-gray-400 mb-2",children:"No Analysis Data"}),t.jsx("p",{className:"text-gray-500 mb-4",children:"Analysis result not available"}),t.jsx("button",{onClick:r,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700",children:"Go Back"})]})});const c=(m,M)=>{navigator.clipboard.writeText(m),d(M),setTimeout(()=>d(null),2e3)},u=m=>m.replace(/\./g,"[.]").replace(/http/gi,"hxxp").replace(/@/g,"[@]"),h=m=>{if(!m||m.length!==2)return"";const M=m.toUpperCase().split("").map(G=>127397+G.charCodeAt(0));return String.fromCodePoint(...M)},b=m=>typeof m=="number"?m:m&&typeof m=="object"&&"overall_score"in m?m.overall_score:0,w=e.overall_score??b(e.risk_score)??b((ue=e.detection)==null?void 0:ue.risk_score)??0,f=(e.overall_level??((se=e.risk_score)==null?void 0:se.overall_level)??((ke=e.detection)==null?void 0:ke.risk_level)??"unknown").toString().toLowerCase(),y=(e.classification??((_=e.risk_score)==null?void 0:_.primary_classification)??((I=e.detection)==null?void 0:I.primary_classification)??"unknown").toString(),v=m=>{if(!m)return{icon:Xo,color:"text-gray-400",bg:"bg-gray-800",label:"Not Checked"};const M=m.toLowerCase();return M==="pass"?{icon:Ce,color:"text-green-400",bg:"bg-green-900/30",label:"PASS"}:M==="fail"?{icon:at,color:"text-red-400",bg:"bg-red-900/30",label:"FAIL"}:M==="softfail"?{icon:ae,color:"text-yellow-400",bg:"bg-yellow-900/30",label:"SOFTFAIL"}:M==="neutral"||M==="none"?{icon:Ts,color:"text-gray-400",bg:"bg-gray-800",label:M.toUpperCase()}:M==="present"?{icon:Ce,color:"text-blue-400",bg:"bg-blue-900/30",label:"PRESENT"}:{icon:Xo,color:"text-gray-400",bg:"bg-gray-800",label:m.toUpperCase()}},g=m=>{const M=(m==null?void 0:m.toLowerCase())||"";return M==="critical"?"text-red-400 bg-red-900/50 border-red-500":M==="high"?"text-orange-400 bg-orange-900/50 border-orange-500":M==="medium"?"text-yellow-400 bg-yellow-900/50 border-yellow-500":M==="low"?"text-blue-400 bg-blue-900/50 border-blue-500":"text-green-400 bg-green-900/50 border-green-500"},p=(m,M)=>{const G=encodeURIComponent(M),ne=[];return(m==="domain"||m==="url")&&(ne.push({name:"VirusTotal",url:`https://www.virustotal.com/gui/domain/${G}`}),ne.push({name:"URLScan",url:`https://urlscan.io/search/#${G}`}),ne.push({name:"Shodan",url:`https://www.shodan.io/search?query=${G}`})),m==="ip"&&(ne.push({name:"VirusTotal",url:`https://www.virustotal.com/gui/ip-address/${G}`}),ne.push({name:"AbuseIPDB",url:`https://www.abuseipdb.com/check/${G}`}),ne.push({name:"Shodan",url:`https://www.shodan.io/host/${G}`}),ne.push({name:"GreyNoise",url:`https://viz.greynoise.io/ip/${G}`})),m==="hash"&&(ne.push({name:"VirusTotal",url:`https://www.virustotal.com/gui/file/${G}`}),ne.push({name:"MalwareBazaar",url:`https://bazaar.abuse.ch/browse.php?search=sha256:${G}`})),m==="email"&&ne.push({name:"Have I Been Pwned",url:`https://haveibeenpwned.com/account/${G}`}),ne},x=m=>{var G,ne,Se,Me,He,$t,wr,_r;const M=`${m}_result`;return(G=e.header_analysis)!=null&&G[M]?{result:e.header_analysis[M],details:null}:(Se=(ne=e.authentication)==null?void 0:ne[m])!=null&&Se.result?e.authentication[m]:($t=(He=(Me=e.email)==null?void 0:Me.header_analysis)==null?void 0:He[m])!=null&&$t.result?e.email.header_analysis[m]:(_r=(wr=e.email)==null?void 0:wr[M])!=null&&_r.result?e.email[M]:{result:"none",details:null}},N=x("spf"),j=x("dkim"),S=x("dmarc");e.se_analysis,e.content_analysis,e.lookalike_analysis;const C=e.ti_results;e.risk_score;const P=e.header_analysis||((E=e.email)==null?void 0:E.header_analysis)||{},$=e.enrichment||{},z=$.sender_domain,B=$.originating_ip,de=$.urls||[],xe=$.attachments||[],be=[{id:"overview",label:"Overview",icon:kn},{id:"insights",label:"Advanced Insights",icon:Gl},{id:"headers",label:"Headers",icon:et},{id:"threatintel",label:"Threat Intel",icon:Ze},{id:"iocs",label:"IOCs",icon:Ot},{id:"rules",label:"Detection",icon:oe},{id:"ai",label:"AI Analysis",icon:nt},...e.sandbox_analysis||((J=(F=e.email)==null?void 0:F.attachments)==null?void 0:J.length)>0?[{id:"sandbox",label:"Sandbox",icon:yp}]:[],...e.se_analysis||e.content_analysis||e.lookalike_analysis?[{id:"enhanced",label:"Enhanced",icon:gt}]:[]];try{return t.jsxs("div",{className:"min-h-screen bg-gray-900 text-gray-100",children:[t.jsx("div",{className:"bg-gray-800 border-b border-gray-700 px-3 md:px-6 py-3 md:py-4",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-3",children:[t.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[t.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white transition-colors p-2 -ml-2",children:" Back"}),t.jsxs("div",{className:"min-w-0",children:[t.jsxs("h1",{className:"text-lg md:text-xl font-bold flex items-center",children:[t.jsx(Jo,{className:"w-5 h-5 md:w-6 md:h-6 mr-2 text-orange-400"}),t.jsx("span",{className:"truncate",children:"Email Threat Analysis"})]}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-400 truncate",children:["ID: ",((R=e.analysis_id)==null?void 0:R.slice(0,8))||"N/A"," | ",e.analysis_duration_ms||0,"ms"]})]})]}),t.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto hide-scrollbar pb-1 -mx-3 px-3 md:mx-0 md:px-0",children:[t.jsxs("button",{onClick:()=>s("executive-pdf"),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-500 rounded text-xs md:text-sm flex items-center font-medium whitespace-nowrap",children:[t.jsx(Rs,{className:"w-4 h-4 mr-1"})," ",t.jsx("span",{className:"hidden sm:inline",children:"Executive"})," PDF"]}),t.jsxs("button",{onClick:()=>s("pdf"),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-xs md:text-sm flex items-center whitespace-nowrap",children:[t.jsx(et,{className:"w-4 h-4 mr-1"})," ",t.jsx("span",{className:"hidden sm:inline",children:"Technical"})," PDF"]}),t.jsxs("button",{onClick:()=>s("json"),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-xs md:text-sm flex items-center whitespace-nowrap",children:[t.jsx(Rs,{className:"w-4 h-4 mr-1"})," JSON"]}),t.jsxs("button",{onClick:()=>s("markdown"),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-xs md:text-sm flex items-center whitespace-nowrap hidden sm:flex",children:[t.jsx(et,{className:"w-4 h-4 mr-1"})," Report"]}),t.jsxs("button",{onClick:()=>s("stix"),className:"px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-xs md:text-sm flex items-center whitespace-nowrap hidden sm:flex",children:[t.jsx(Ze,{className:"w-4 h-4 mr-1"})," STIX"]})]})]})}),t.jsx("div",{className:`px-3 md:px-6 py-3 md:py-4 ${g(f)}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3 md:space-x-6",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl md:text-4xl font-bold",children:w}),t.jsx("div",{className:"text-[10px] md:text-xs uppercase tracking-wider opacity-80",children:"Risk"})]}),t.jsx("div",{className:"h-10 md:h-12 w-px bg-current opacity-30"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm md:text-lg font-semibold uppercase",children:f}),t.jsx("div",{className:"text-xs md:text-sm opacity-80 truncate max-w-[100px] md:max-w-none",children:y.replace(/_/g," ")})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 md:space-x-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold",children:((D=(A=e.detection)==null?void 0:A.rules_triggered)==null?void 0:D.length)||0}),t.jsx("div",{className:"text-[10px] md:text-xs opacity-80",children:"Rules"})]}),t.jsxs("div",{className:"text-center hidden sm:block",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold",children:(((T=(q=e.iocs)==null?void 0:q.domains)==null?void 0:T.length)||0)+(((ve=(Y=e.iocs)==null?void 0:Y.urls)==null?void 0:ve.length)||0)}),t.jsx("div",{className:"text-[10px] md:text-xs opacity-80",children:"IOCs"})]})]})]})}),t.jsx("div",{className:"bg-gray-800 border-b border-gray-700 px-2 md:px-6 overflow-x-auto hide-scrollbar",children:t.jsx("div",{className:"flex space-x-1",children:be.map(m=>t.jsxs("button",{onClick:()=>a(m.id),className:`px-3 md:px-4 py-2.5 md:py-3 flex items-center space-x-1.5 md:space-x-2 border-b-2 transition-colors whitespace-nowrap text-sm md:text-base ${n===m.id?"border-blue-500 text-blue-400":"border-transparent text-gray-400 hover:text-white"}`,children:[t.jsx(m.icon,{className:"w-4 h-4"}),t.jsx("span",{children:m.label})]},m.id))})}),t.jsxs("div",{className:"p-3 md:p-6",children:[n==="overview"&&t.jsxs("div",{className:"space-y-4 md:space-y-6",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 md:p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-base md:text-lg font-semibold mb-3 md:mb-4 flex items-center",children:[t.jsx(Ut,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-400"}),"Email Summary"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-[10px] md:text-xs text-gray-500 uppercase",children:"Subject"}),t.jsx("p",{className:"text-white font-medium text-sm md:text-base truncate",children:((Le=e.email)==null?void 0:Le.subject)||"No Subject"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[10px] md:text-xs text-gray-500 uppercase",children:"Date"}),t.jsx("p",{className:"text-white text-sm md:text-base",children:((ut=e.email)==null?void 0:ut.date)||"Unknown"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-[10px] md:text-xs text-gray-500 uppercase",children:"From"}),t.jsxs("p",{className:"text-white font-mono text-sm",children:[((Ge=(he=e.email)==null?void 0:he.sender)==null?void 0:Ge.display_name)&&t.jsxs("span",{className:"text-gray-400",children:[e.email.sender.display_name," "]}),"<",((H=(Q=e.email)==null?void 0:Q.sender)==null?void 0:H.email)||"unknown",">"]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"To"}),t.jsx("p",{className:"text-white font-mono text-sm",children:((O=(ge=e.email)==null?void 0:ge.to_recipients)==null?void 0:O.map(m=>m.email).join(", "))||"Unknown"})]}),((Z=e.email)==null?void 0:Z.reply_to)&&e.email.reply_to.length>0&&(()=>{var ne,Se;const m=e.email.reply_to.map(Me=>(Me.email||Me).toLowerCase().trim()),M=(((Se=(ne=e.email)==null?void 0:ne.sender)==null?void 0:Se.email)||"").toLowerCase().trim(),G=m.some(Me=>Me!==M);return t.jsxs("div",{className:"col-span-2",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase flex items-center",children:G?t.jsxs(t.Fragment,{children:[t.jsx(ae,{className:"w-3 h-3 mr-1 text-yellow-400"}),"Reply-To (Different from Sender!)"]}):t.jsx(t.Fragment,{children:"Reply-To"})}),t.jsx("p",{className:`font-mono text-sm ${G?"text-yellow-400":"text-gray-300"}`,children:e.email.reply_to.map(Me=>Me.email||Me).join(", ")})]})})()]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(fs,{className:"w-5 h-5 mr-2 text-purple-400"}),"Email Authentication"]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:`rounded-lg p-4 ${v(N==null?void 0:N.result).bg} border border-gray-600`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-semibold",children:"SPF"}),bs.createElement(v(N==null?void 0:N.result).icon,{className:`w-6 h-6 ${v(N==null?void 0:N.result).color}`})]}),t.jsx("div",{className:`text-2xl font-bold ${v(N==null?void 0:N.result).color}`,children:v(N==null?void 0:N.result).label}),(N==null?void 0:N.details)&&t.jsx("p",{className:"text-xs text-gray-400 mt-2 truncate",title:N.details,children:N.details})]}),t.jsxs("div",{className:`rounded-lg p-4 ${v(j==null?void 0:j.result).bg} border border-gray-600`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-semibold",children:"DKIM"}),bs.createElement(v(j==null?void 0:j.result).icon,{className:`w-6 h-6 ${v(j==null?void 0:j.result).color}`})]}),t.jsx("div",{className:`text-2xl font-bold ${v(j==null?void 0:j.result).color}`,children:v(j==null?void 0:j.result).label}),(j==null?void 0:j.details)&&t.jsx("p",{className:"text-xs text-gray-400 mt-2 truncate",title:j.details,children:j.details})]}),t.jsxs("div",{className:`rounded-lg p-4 ${v(S==null?void 0:S.result).bg} border border-gray-600`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-semibold",children:"DMARC"}),bs.createElement(v(S==null?void 0:S.result).icon,{className:`w-6 h-6 ${v(S==null?void 0:S.result).color}`})]}),t.jsx("div",{className:`text-2xl font-bold ${v(S==null?void 0:S.result).color}`,children:v(S==null?void 0:S.result).label}),(S==null?void 0:S.details)&&t.jsx("p",{className:"text-xs text-gray-400 mt-2 truncate",title:S.details,children:S.details})]})]}),!N&&!j&&!S&&t.jsxs("div",{className:"mt-4 p-3 bg-yellow-900/30 border border-yellow-700 rounded-lg flex items-start",children:[t.jsx(ae,{className:"w-5 h-5 text-yellow-400 mr-2 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-yellow-400 font-medium",children:"No Authentication Found"}),t.jsx("p",{className:"text-sm text-gray-400",children:"This email has no SPF, DKIM, or DMARC records. This is a significant red flag as legitimate organizations typically implement email authentication."})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ot,{className:"w-5 h-5 mr-2 text-red-400"}),"Indicators of Compromise (IOCs)"]}),t.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[t.jsxs("div",{className:"bg-gray-900 rounded p-3 text-center",children:[t.jsx(Ke,{className:"w-6 h-6 mx-auto mb-2 text-blue-400"}),t.jsx("div",{className:"text-2xl font-bold",children:((V=(re=e.iocs)==null?void 0:re.domains)==null?void 0:V.length)||0}),t.jsx("div",{className:"text-xs text-gray-400",children:"Domains"})]}),t.jsxs("div",{className:"bg-gray-900 rounded p-3 text-center",children:[t.jsx(jt,{className:"w-6 h-6 mx-auto mb-2 text-purple-400"}),t.jsx("div",{className:"text-2xl font-bold",children:((Ae=(ee=e.iocs)==null?void 0:ee.urls)==null?void 0:Ae.length)||0}),t.jsx("div",{className:"text-xs text-gray-400",children:"URLs"})]}),t.jsxs("div",{className:"bg-gray-900 rounded p-3 text-center",children:[t.jsx(vt,{className:"w-6 h-6 mx-auto mb-2 text-green-400"}),t.jsx("div",{className:"text-2xl font-bold",children:((Os=(te=e.iocs)==null?void 0:te.ips)==null?void 0:Os.length)||0}),t.jsx("div",{className:"text-xs text-gray-400",children:"IP Addresses"})]}),t.jsxs("div",{className:"bg-gray-900 rounded p-3 text-center",children:[t.jsx(Ql,{className:"w-6 h-6 mx-auto mb-2 text-orange-400"}),t.jsx("div",{className:"text-2xl font-bold",children:((Us=(zs=e.iocs)==null?void 0:zs.file_hashes_sha256)==null?void 0:Us.length)||0}),t.jsx("div",{className:"text-xs text-gray-400",children:"File Hashes"})]})]})]}),e.ai_triage&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(nt,{className:"w-5 h-5 mr-2 text-cyan-400"}),"AI Threat Assessment"]}),t.jsx("p",{className:"text-gray-300 mb-4",children:e.ai_triage.summary}),((Fs=e.ai_triage.key_findings)==null?void 0:Fs.length)>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Key Findings"}),t.jsx("ul",{className:"space-y-1",children:e.ai_triage.key_findings.slice(0,5).map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm text-gray-300",children:[t.jsx(bn,{className:"w-4 h-4 mr-2 text-yellow-400 flex-shrink-0 mt-0.5"}),m]},M))})]}),((Bs=e.ai_triage.recommended_actions)==null?void 0:Bs.length)>0&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Recommended Actions"}),t.jsx("ul",{className:"space-y-1",children:e.ai_triage.recommended_actions.slice(0,3).map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm",children:[t.jsx(gt,{className:"w-4 h-4 mr-2 text-green-400 flex-shrink-0 mt-0.5"}),t.jsxs("span",{className:"font-medium mr-2",children:[m.action,":"]}),t.jsx("span",{className:"text-gray-400",children:m.details})]},M))})]})]})]}),n==="insights"&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("div",{className:`rounded-lg p-6 border-2 ${w>=70?"bg-red-900/30 border-red-500":w>=40?"bg-orange-900/30 border-orange-500":w>=20?"bg-yellow-900/30 border-yellow-500":"bg-green-900/30 border-green-500"}`,children:t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center text-3xl font-bold ${w>=70?"bg-red-600":w>=40?"bg-orange-600":w>=20?"bg-yellow-600 text-black":"bg-green-600"}`,children:w}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold",children:"Overall Risk Assessment"}),t.jsx("p",{className:`text-lg font-semibold ${f==="critical"?"text-red-400":f==="high"?"text-orange-400":f==="medium"?"text-yellow-400":"text-green-400"}`,children:(f||"unknown").toUpperCase()})]})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm text-gray-400",children:"Classification"}),t.jsx("div",{className:`text-lg font-bold px-3 py-1 rounded ${((Vs=(Hs=e.detection)==null?void 0:Hs.primary_classification)==null?void 0:Vs.toLowerCase())==="phishing"?"bg-red-600":((kt=(Pe=e.detection)==null?void 0:Pe.primary_classification)==null?void 0:kt.toLowerCase())==="bec"?"bg-orange-600":((En=(qs=e.detection)==null?void 0:qs.primary_classification)==null?void 0:En.toLowerCase())==="malware"?"bg-purple-600":((An=(Tn=e.detection)==null?void 0:Tn.primary_classification)==null?void 0:An.toLowerCase())==="spam"?"bg-yellow-600 text-black":"bg-green-600"}`,children:(((Rn=e.detection)==null?void 0:Rn.primary_classification)||"Unknown").toUpperCase()})]})]})}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[t.jsxs("h2",{className:"text-xl font-bold mb-6 flex items-center",children:[t.jsx(ed,{className:"w-6 h-6 mr-2 text-blue-400"}),"Multi-Dimensional Risk Breakdown"]}),t.jsxs("div",{className:"font-mono text-sm space-y-1",children:[t.jsxs("div",{className:`font-bold text-lg ${w>=70?"text-red-400":w>=40?"text-orange-400":"text-green-400"}`,children:["Overall Risk: ",w,"/100 (",f,")",w>=70&&" "]}),e.se_analysis&&t.jsxs("div",{className:"ml-4 border-l-2 border-gray-600 pl-4 mt-4",children:[t.jsxs("div",{className:`flex items-center space-x-2 ${e.se_analysis.se_score>=70?"text-red-400":e.se_analysis.se_score>=40?"text-orange-400":"text-green-400"}`,children:[t.jsx("span",{className:"text-gray-500",children:""}),t.jsx(nt,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-semibold",children:["Social Engineering: ",e.se_analysis.se_score,"/100"]}),e.se_analysis.se_score>=70&&t.jsx("span",{children:""})]}),e.se_analysis.heuristic_breakdown&&t.jsx("div",{className:"ml-8 space-y-1 mt-2",children:Object.entries(e.se_analysis.heuristic_breakdown).map(([m,M],G,ne)=>t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:G===ne.length-1?"":""}),t.jsxs("span",{className:"capitalize",children:[m,":"]}),t.jsxs("span",{className:`font-semibold ${M>=70?"text-red-400":M>=40?"text-yellow-400":"text-green-400"}`,children:[M,"/100"]})]},m))}),((Ln=e.se_analysis.techniques)==null?void 0:Ln.length)>0&&t.jsxs("div",{className:"ml-8 mt-2",children:[t.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Techniques detected:"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.se_analysis.techniques.map((m,M)=>t.jsx("span",{className:"px-2 py-0.5 bg-purple-900/50 text-purple-400 text-xs rounded",children:m},M))})]})]}),e.lookalike_analysis&&((Pn=e.lookalike_analysis.matches)==null?void 0:Pn.length)>0&&t.jsxs("div",{className:"ml-4 border-l-2 border-gray-600 pl-4 mt-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[t.jsx("span",{className:"text-gray-500",children:""}),t.jsx(Kl,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-semibold",children:["Brand Impersonation: ",Math.round((e.lookalike_analysis.highest_confidence||0)*100),"/100 "]})]}),t.jsx("div",{className:"ml-8 space-y-2 mt-2",children:e.lookalike_analysis.matches.slice(0,3).map((m,M)=>t.jsxs("div",{className:"bg-gray-900 rounded p-2",children:[m.suspicious_domain&&t.jsxs("div",{className:"flex items-center space-x-2 text-red-400 mb-1",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsxs("span",{children:["Suspicious domain: ",t.jsx("span",{className:"font-bold font-mono",children:m.suspicious_domain})]})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsxs("span",{children:["Impersonating: ",t.jsx("span",{className:"font-bold capitalize",children:m.target_brand||m.brand||m.target})]})]}),m.legitimate_domain&&t.jsxs("div",{className:"ml-8 text-green-400 text-xs",children:["Real domain: ",m.legitimate_domain]}),m.description&&t.jsx("div",{className:"ml-8 text-yellow-400/80 text-xs mt-1",children:m.description})]},M))})]}),e.content_analysis&&t.jsxs("div",{className:"ml-4 border-l-2 border-gray-600 pl-4 mt-4",children:[t.jsxs("div",{className:`flex items-center space-x-2 ${e.content_analysis.intent_score>=70?"text-red-400":e.content_analysis.intent_score>=40?"text-orange-400":"text-green-400"}`,children:[t.jsx("span",{className:"text-gray-500",children:""}),t.jsx(et,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-semibold",children:["Content Analysis: ",e.content_analysis.intent_score||50,"/100"]})]}),t.jsxs("div",{className:"ml-8 space-y-1 mt-2",children:[e.content_analysis.primary_intent&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"Intent:"}),t.jsx("span",{className:"text-yellow-400 font-semibold",children:e.content_analysis.primary_intent})]}),e.content_analysis.target&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"Target:"}),t.jsx("span",{className:"text-orange-400",children:e.content_analysis.target})]}),e.content_analysis.action_requested&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"Action:"}),t.jsx("span",{className:"text-red-400",children:e.content_analysis.action_requested})]})]})]}),(e.ti_results||e.enrichment)&&t.jsxs("div",{className:"ml-4 border-l-2 border-gray-600 pl-4 mt-4",children:[t.jsxs("div",{className:`flex items-center space-x-2 ${(((Mn=e.ti_results)==null?void 0:Mn.fused_verdict)||"").toLowerCase()==="malicious"?"text-red-400":(((W=e.ti_results)==null?void 0:W.fused_verdict)||"").toLowerCase()==="suspicious"?"text-orange-400":"text-green-400"}`,children:[t.jsx("span",{className:"text-gray-500",children:""}),t.jsx(Ze,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-semibold",children:["Threat Intelligence: ",((le=e.ti_results)==null?void 0:le.fused_score)||0,"/100"]}),(((Ee=e.ti_results)==null?void 0:Ee.fused_verdict)||"").toLowerCase()==="malicious"&&" "]}),t.jsxs("div",{className:"ml-8 space-y-1 mt-2",children:[((ce=(fe=e.enrichment)==null?void 0:fe.domain)==null?void 0:ce.virustotal)&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"VirusTotal:"}),t.jsx("span",{className:e.enrichment.domain.virustotal.malicious>0?"text-red-400":"text-green-400",children:e.enrichment.domain.virustotal.malicious>0?`${e.enrichment.domain.virustotal.malicious} detections`:"CLEAN"})]}),((Mt=(Ne=e.ti_results)==null?void 0:Ne.sources)==null?void 0:Mt.urlhaus)&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"URLhaus:"}),t.jsx("span",{className:e.ti_results.sources.urlhaus.verdict==="malicious"?"text-red-400 font-bold":e.ti_results.sources.urlhaus.verdict==="suspicious"?"text-orange-400":"text-green-400",children:(e.ti_results.sources.urlhaus.verdict||"CLEAN").toUpperCase()})]}),((us=(we=e.enrichment)==null?void 0:we.ip)==null?void 0:us.abuseipdb)&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"AbuseIPDB:"}),t.jsxs("span",{className:e.enrichment.ip.abuseipdb.abuse_confidence_score>50?"text-red-400":e.enrichment.ip.abuseipdb.abuse_confidence_score>20?"text-orange-400":"text-green-400",children:[e.enrichment.ip.abuseipdb.abuse_confidence_score,"% abuse confidence"]})]}),((Qs=(Ks=(Ws=e.enrichment)==null?void 0:Ws.domain)==null?void 0:Ks.whois)==null?void 0:Qs.domain_age_days)!==void 0&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx("span",{children:"Domain Age:"}),t.jsxs("span",{className:e.enrichment.domain.whois.domain_age_days<30?"text-red-400":e.enrichment.domain.whois.domain_age_days<90?"text-orange-400":"text-green-400",children:[e.enrichment.domain.whois.domain_age_days," days",e.enrichment.domain.whois.domain_age_days<30&&"  NEW"]})]})]})]}),t.jsxs("div",{className:"ml-4 border-l-2 border-gray-600 pl-4 mt-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-blue-400",children:[t.jsx("span",{className:"text-gray-500",children:""}),t.jsx(vt,{className:"w-4 h-4"}),t.jsx("span",{className:"font-semibold",children:"Technical Indicators"})]}),t.jsxs("div",{className:"ml-8 space-y-1 mt-2",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(fs,{className:"w-3 h-3"}),t.jsx("span",{children:"SPF:"}),t.jsx("span",{className:N.result==="pass"?"text-green-400":N.result==="fail"?"text-red-400":"text-yellow-400",children:(N.result||"none").toUpperCase()})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(fs,{className:"w-3 h-3"}),t.jsx("span",{children:"DKIM:"}),t.jsx("span",{className:j.result==="pass"?"text-green-400":j.result==="fail"?"text-red-400":"text-yellow-400",children:(j.result||"none").toUpperCase()})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(fs,{className:"w-3 h-3"}),t.jsx("span",{children:"DMARC:"}),t.jsx("span",{className:S.result==="pass"?"text-green-400":S.result==="fail"?"text-red-400":"text-yellow-400",children:(S.result||"none").toUpperCase()})]}),((Xe=(Gs=e.email)==null?void 0:Gs.sender)==null?void 0:Xe.domain)&&t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(Ke,{className:"w-3 h-3"}),t.jsx("span",{children:"TLD:"}),t.jsxs("span",{className:[".xyz",".top",".club",".work",".click",".link",".buzz"].some(m=>e.email.sender.domain.endsWith(m))?"text-orange-400":"text-gray-300",children:[".",e.email.sender.domain.split(".").pop(),[".xyz",".top",".club",".work",".click",".link",".buzz"].some(m=>e.email.sender.domain.endsWith(m))&&"  Suspicious"]})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(hr,{className:"w-3 h-3"}),t.jsx("span",{children:"Attachments:"}),t.jsxs("span",{className:((mt=(pe=e.email)==null?void 0:pe.attachments)==null?void 0:mt.length)>0?"text-yellow-400":"text-gray-500",children:[((es=(Xs=e.email)==null?void 0:Xs.attachments)==null?void 0:es.length)||0,((it=(Ys=e.email)==null?void 0:Ys.attachments)==null?void 0:it.some(m=>[".exe",".dll",".scr",".bat",".cmd",".ps1",".vbs",".js",".iso",".img"].some(M=>{var G;return(G=m.filename)==null?void 0:G.toLowerCase().endsWith(M)})))&&"  Executable"]})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-gray-400",children:[t.jsx("span",{className:"text-gray-600",children:""}),t.jsx(jt,{className:"w-3 h-3"}),t.jsx("span",{children:"URLs:"}),t.jsx("span",{className:((Dn=($n=e.email)==null?void 0:$n.urls)==null?void 0:Dn.length)>0?"text-yellow-400":"text-gray-500",children:((On=(In=e.email)==null?void 0:In.urls)==null?void 0:On.length)||0})]})]})]})]})]}),((je=(zn=e.detection)==null?void 0:zn.rules_triggered)==null?void 0:je.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(oe,{className:"w-6 h-6 mr-2 text-orange-400"}),"Triggered Detection Rules (",e.detection.rules_triggered.length,")"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:e.detection.rules_triggered.map((m,M)=>{var G,ne,Se,Me,He,$t;return t.jsxs("div",{className:`p-3 rounded-lg border ${((G=m.severity)==null?void 0:G.toLowerCase())==="critical"?"bg-red-900/30 border-red-500":((ne=m.severity)==null?void 0:ne.toLowerCase())==="high"?"bg-orange-900/30 border-orange-500":((Se=m.severity)==null?void 0:Se.toLowerCase())==="medium"?"bg-yellow-900/30 border-yellow-500":"bg-blue-900/30 border-blue-500"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:`text-xs font-bold uppercase px-2 py-0.5 rounded ${((Me=m.severity)==null?void 0:Me.toLowerCase())==="critical"?"bg-red-600":((He=m.severity)==null?void 0:He.toLowerCase())==="high"?"bg-orange-600":(($t=m.severity)==null?void 0:$t.toLowerCase())==="medium"?"bg-yellow-600 text-black":"bg-blue-600"}`,children:m.severity||"INFO"}),m.mitre_id&&t.jsx("span",{className:"text-xs text-gray-500",children:m.mitre_id})]}),t.jsx("div",{className:"font-semibold text-sm text-white",children:m.name||m.rule_name}),m.matched_content&&t.jsxs("div",{className:"text-xs text-gray-400 mt-1 truncate",children:["Match: ",m.matched_content]})]},M)})})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(ae,{className:"w-6 h-6 mr-2 text-yellow-400"}),"Key Findings"]}),t.jsxs("div",{className:"space-y-3",children:[w>=70&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-900/30 rounded-lg border border-red-500",children:[t.jsx(at,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-red-400",children:"Critical Risk Detected"}),t.jsxs("div",{className:"text-sm text-gray-300",children:["This email exhibits multiple high-risk indicators consistent with ",(($a=e.detection)==null?void 0:$a.primary_classification)||"malicious"," activity."]})]})]}),e.se_analysis&&e.se_analysis.se_score>=60&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-purple-900/30 rounded-lg border border-purple-500",children:[t.jsx(nt,{className:"w-5 h-5 text-purple-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-purple-400",children:"Social Engineering Tactics Detected"}),t.jsx("div",{className:"text-sm text-gray-300",children:((st=e.se_analysis.techniques)==null?void 0:st.length)>0?`Uses ${e.se_analysis.techniques.slice(0,3).join(", ")} to manipulate the recipient.`:"Email uses psychological manipulation techniques to influence recipient behavior."})]})]}),((od=(id=e.lookalike_analysis)==null?void 0:id.matches)==null?void 0:od.length)>0&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-orange-900/30 rounded-lg border border-orange-500",children:[t.jsx(Kl,{className:"w-5 h-5 text-orange-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-orange-400",children:"Brand Impersonation"}),t.jsxs("div",{className:"text-sm text-gray-300",children:["Domain appears to impersonate ",((cd=e.lookalike_analysis.matches[0])==null?void 0:cd.brand)||((dd=e.lookalike_analysis.matches[0])==null?void 0:dd.target),".",((ud=e.lookalike_analysis.matches[0])==null?void 0:ud.description)&&` ${e.lookalike_analysis.matches[0].description}`]})]})]}),N.result==="fail"&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-900/30 rounded-lg border border-red-500",children:[t.jsx(fs,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-red-400",children:"Email Authentication Failed"}),t.jsx("div",{className:"text-sm text-gray-300",children:"SPF check failed, indicating the sender may be spoofing their email address."})]})]}),((md=e.ti_results)==null?void 0:md.fused_verdict)==="malicious"&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-red-900/30 rounded-lg border border-red-500",children:[t.jsx(Ze,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-red-400",children:"Known Threat Indicators"}),t.jsx("div",{className:"text-sm text-gray-300",children:"Threat intelligence sources have flagged elements in this email as malicious."})]})]}),w<20&&t.jsxs("div",{className:"flex items-start space-x-3 p-3 bg-green-900/30 rounded-lg border border-green-500",children:[t.jsx(Ce,{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-green-400",children:"Low Risk Email"}),t.jsx("div",{className:"text-sm text-gray-300",children:"No significant threat indicators detected in this email."})]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700",children:[t.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(Ce,{className:"w-6 h-6 mr-2 text-green-400"}),"Recommended Actions"]}),t.jsx("div",{className:"space-y-2",children:w>=70?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[t.jsx("span",{className:"font-bold",children:"1."}),t.jsx("span",{children:"Block sender and domain immediately"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-red-400",children:[t.jsx("span",{className:"font-bold",children:"2."}),t.jsx("span",{children:"Alert users who may have received similar emails"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[t.jsx("span",{className:"font-bold",children:"3."}),t.jsx("span",{children:"Search mail logs for related messages"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-yellow-400",children:[t.jsx("span",{className:"font-bold",children:"4."}),t.jsx("span",{children:"Submit IOCs to threat intelligence platform"})]})]}):w>=40?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center space-x-2 text-orange-400",children:[t.jsx("span",{className:"font-bold",children:"1."}),t.jsx("span",{children:"Verify sender through alternate channel"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-yellow-400",children:[t.jsx("span",{className:"font-bold",children:"2."}),t.jsx("span",{children:"Do not click links or open attachments until verified"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-blue-400",children:[t.jsx("span",{className:"font-bold",children:"3."}),t.jsx("span",{children:"Monitor for similar messages"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center space-x-2 text-green-400",children:[t.jsx("span",{className:"font-bold",children:"1."}),t.jsx("span",{children:"No immediate action required"})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-blue-400",children:[t.jsx("span",{className:"font-bold",children:"2."}),t.jsx("span",{children:"Continue standard security practices"})]})]})})]})]}),n==="headers"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(R0,{className:"w-5 h-5 mr-2 text-blue-400"}),"Email Routing (Received Chain)"]}),((xd=P==null?void 0:P.received_chain)==null?void 0:xd.length)>0?t.jsx("div",{className:"space-y-2",children:(P.received_chain||[]).map((m,M)=>t.jsxs("div",{className:"flex items-start bg-gray-900 rounded p-3",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-blue-600 flex items-center justify-center text-sm font-bold mr-3",children:M+1}),t.jsxs("div",{className:"flex-grow",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[m.from_host&&t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"font-mono text-sm text-gray-300",children:m.from_host}),m.from_ip&&t.jsxs("span",{className:"text-xs text-gray-500",children:["(",m.from_ip,")"]}),t.jsx(yy,{className:"w-4 h-4 text-gray-500"})]}),t.jsx("span",{className:"font-mono text-sm text-green-400",children:m.by_host||"Unknown"})]}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-400",children:[m.timestamp&&t.jsxs("span",{className:"flex items-center",children:[t.jsx(os,{className:"w-3 h-3 mr-1"}),new Date(m.timestamp).toLocaleString()]}),m.delay_seconds!==void 0&&m.delay_seconds>0&&t.jsxs("span",{className:`${m.delay_seconds>60?"text-yellow-400":""}`,children:["+",m.delay_seconds,"s delay"]}),m.protocol&&t.jsx("span",{className:"bg-gray-700 px-1.5 py-0.5 rounded",children:m.protocol})]})]})]},M))}):t.jsx("p",{className:"text-gray-400",children:"No received headers found"})]}),((P==null?void 0:P.originating_ip)||B)&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ki,{className:"w-5 h-5 mr-2 text-red-400"}),"Originating IP Analysis"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"IP Address"}),t.jsxs("p",{className:"text-white font-mono flex items-center",children:[(P==null?void 0:P.originating_ip)||(B==null?void 0:B.ip_address),t.jsx("button",{onClick:()=>c((P==null?void 0:P.originating_ip)||(B==null?void 0:B.ip_address),"ip"),className:"ml-2 text-gray-400 hover:text-white",children:t.jsx(De,{className:"w-4 h-4"})})]})]}),(B==null?void 0:B.country)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"Location"}),t.jsxs("p",{className:"text-white",children:[B.city,", ",B.country]})]}),(B==null?void 0:B.asn)&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"ASN"}),t.jsxs("p",{className:"text-white",children:["AS",B.asn," - ",B.as_org]})]}),(B==null?void 0:B.abuseipdb_score)!==void 0&&t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase",children:"AbuseIPDB Score"}),t.jsxs("p",{className:`font-bold ${B.abuseipdb_score>50?"text-red-400":"text-green-400"}`,children:[B.abuseipdb_score,"% abuse confidence"]})]})]}),t.jsx("div",{className:"mt-3 flex space-x-2",children:p("ip",(P==null?void 0:P.originating_ip)||(B==null?void 0:B.ip_address)).map(m=>t.jsxs("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded flex items-center",children:[t.jsx(Ye,{className:"w-3 h-3 mr-1"}),m.name]},m.name))})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(et,{className:"w-5 h-5 mr-2 text-gray-400"}),"Raw Headers"]}),t.jsx("div",{className:"bg-gray-900 rounded p-3 font-mono text-xs overflow-x-auto max-h-96 overflow-y-auto",children:(pd=e.email)!=null&&pd.raw_headers?Object.entries(e.email.raw_headers).map(([m,M])=>t.jsxs("div",{className:"mb-1",children:[t.jsxs("span",{className:"text-blue-400",children:[m,":"]}),t.jsx("span",{className:"text-gray-300 ml-2",children:String(M)})]},m)):t.jsx("p",{className:"text-gray-400",children:"No raw headers available"})})]})]}),n==="threatintel"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:`rounded-lg p-4 border-2 ${(C==null?void 0:C.fused_verdict)==="malicious"?"bg-red-900/30 border-red-700":(C==null?void 0:C.fused_verdict)==="suspicious"?"bg-orange-900/30 border-orange-700":"bg-gray-800 border-gray-700"}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx(Ze,{className:`w-8 h-8 ${(C==null?void 0:C.fused_verdict)==="malicious"?"text-red-400":(C==null?void 0:C.fused_verdict)==="suspicious"?"text-orange-400":"text-blue-400"}`}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-semibold",children:"Threat Intelligence Summary"}),t.jsx("p",{className:"text-sm text-gray-400",children:C?`Fused score: ${C.fused_score}/100`:"Enrichment data from external sources"})]})]}),(C==null?void 0:C.fused_verdict)&&t.jsx("span",{className:`px-3 py-1 rounded-lg font-bold text-sm ${C.fused_verdict==="malicious"?"bg-red-600 text-white":C.fused_verdict==="suspicious"?"bg-orange-600 text-white":"bg-green-600 text-white"}`,children:(C.fused_verdict||"clean").toUpperCase()})]}),(C==null?void 0:C.findings)&&C.findings.length>0&&t.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-700",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-400 mb-2",children:"Key Findings"}),t.jsx("ul",{className:"space-y-1",children:C.findings.map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm",children:[t.jsx(ae,{className:"w-4 h-4 mr-2 text-yellow-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-gray-300",children:m})]},M))})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ke,{className:"w-5 h-5 mr-2 text-blue-400"}),"Sender Domain Analysis"]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Domain"}),t.jsx("p",{className:"font-mono text-sm text-blue-400",children:((gd=(hd=e.email)==null?void 0:hd.sender)==null?void 0:gd.domain)||"Unknown"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Sender"}),t.jsx("p",{className:"font-mono text-sm text-gray-300 truncate",children:((yd=(fd=e.email)==null?void 0:fd.sender)==null?void 0:yd.email)||"Unknown"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Display Name"}),t.jsx("p",{className:"text-sm text-gray-300",children:((jd=(bd=e.email)==null?void 0:bd.sender)==null?void 0:jd.display_name)||"None"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Envelope From"}),t.jsx("p",{className:"font-mono text-sm text-gray-300 truncate",children:((Nd=(vd=e.email)==null?void 0:vd.envelope_from)==null?void 0:Nd.email)||"Same as From"})]})]}),z&&t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"VirusTotal"}),z.virustotal_positives!==void 0?t.jsxs("div",{className:`text-xl font-bold ${z.virustotal_positives>0?"text-red-400":"text-green-400"}`,children:[z.virustotal_positives,"/",z.virustotal_total,t.jsx("span",{className:"text-sm font-normal text-gray-400 ml-1",children:"detections"})]}):t.jsx("div",{className:"text-gray-500",children:"Not scanned"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Domain Age"}),z.creation_date?t.jsx("div",{className:`text-xl font-bold ${z.is_newly_registered?"text-yellow-400":"text-green-400"}`,children:z.is_newly_registered?" NEW":" Established"}):t.jsx("div",{className:"text-gray-500",children:"Unknown"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Registrar"}),t.jsx("div",{className:"text-sm text-gray-300 truncate",children:z.registrar||"Unknown"})]})]}),(z==null?void 0:z.dns_records)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"DNS Security Records"}),t.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[z.dns_records.spf&&t.jsxs("div",{className:"bg-gray-800 rounded p-2",children:[t.jsx("span",{className:"text-blue-400 font-medium",children:"SPF:"}),t.jsx("span",{className:"ml-2 font-mono text-xs text-gray-400 break-all",children:z.dns_records.spf})]}),z.dns_records.dmarc&&t.jsxs("div",{className:"bg-gray-800 rounded p-2",children:[t.jsx("span",{className:"text-purple-400 font-medium",children:"DMARC:"}),t.jsx("span",{className:"ml-2 font-mono text-xs text-gray-400 break-all",children:z.dns_records.dmarc})]})]})]}),z&&(z.blacklist_count>0||((wd=z.blacklists_listed)==null?void 0:wd.length)>0)&&t.jsxs("div",{className:"bg-red-900/30 rounded-lg p-3 border border-red-700 mt-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-red-400 mb-2 flex items-center",children:[t.jsx(ae,{className:"w-4 h-4 mr-2"})," Domain Blacklisted (",z.blacklist_count||((_d=z.blacklists_listed)==null?void 0:_d.length)||0," lists)"]}),z.blacklists_listed&&z.blacklists_listed.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:z.blacklists_listed.map((m,M)=>t.jsx("span",{className:"px-2 py-1 text-xs bg-red-900/50 text-red-300 rounded border border-red-700",children:m},M))})]}),!z&&t.jsx("div",{className:"bg-gray-900/50 rounded-lg p-3 border border-dashed border-gray-700 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:[t.jsx(Ts,{className:"w-4 h-4 inline mr-1"}),"Configure VirusTotal API key in Settings for domain reputation data"]})})]}),(B||((kd=e.email)==null?void 0:kd.originating_ip)||((Sd=e.enrichment)==null?void 0:Sd.originating_ip))&&(()=>{var G,ne,Se,Me,He,$t;const m=B||((G=e.enrichment)==null?void 0:G.originating_ip)||{},M=m.ip||m.ip_address||((ne=e.email)==null?void 0:ne.originating_ip)||"Unknown";return t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ki,{className:"w-5 h-5 mr-2 text-green-400"}),"Originating IP & Geolocation"]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4",children:[t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"IP Address"}),t.jsx("p",{className:"font-mono text-lg text-green-400",children:M})]}),(m.country||m.country_code)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Country"}),t.jsxs("p",{className:"text-lg text-gray-200",children:[t.jsx("span",{className:"mr-2",children:m.country_code&&h(m.country_code)}),m.country||m.country_code]})]}),m.city&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"City"}),t.jsxs("p",{className:"text-lg text-gray-200",children:[m.city,m.region?`, ${m.region}`:""]})]}),m.timezone&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Timezone"}),t.jsx("p",{className:"text-sm text-gray-200",children:m.timezone})]})]}),(m.lat||m.lon)&&t.jsx("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700 mb-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"Coordinates"}),t.jsxs("p",{className:"font-mono text-sm text-gray-300",children:[(Se=m.lat)==null?void 0:Se.toFixed(4),", ",(Me=m.lon)==null?void 0:Me.toFixed(4)]})]}),t.jsxs("a",{href:`https://www.google.com/maps?q=${m.lat},${m.lon}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm transition-colors",children:[t.jsx(Ki,{className:"w-4 h-4"}),"View on Map"]})]})}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 mb-4",children:[(m.isp||m.org)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"ISP / Organization"}),t.jsx("p",{className:"text-sm text-gray-300",children:m.isp||m.org})]}),(m.asn||m.as_org)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"ASN"}),t.jsxs("p",{className:"text-sm text-gray-300",children:[m.asn&&t.jsxs("span",{className:"font-mono text-blue-400",children:["AS",m.asn]}),m.as_org&&t.jsx("span",{className:"ml-2 text-gray-400",children:m.as_org})]})]}),(m.abuseipdb_score!==void 0||m.abuse_score!==void 0)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-1",children:"AbuseIPDB Score"}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("div",{className:`text-2xl font-bold ${(m.abuseipdb_score||m.abuse_score)>50?"text-red-400":(m.abuseipdb_score||m.abuse_score)>20?"text-orange-400":"text-green-400"}`,children:[m.abuseipdb_score||m.abuse_score,"%"]}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${(m.abuseipdb_score||m.abuse_score)>50?"bg-red-900/50 text-red-400":(m.abuseipdb_score||m.abuse_score)>20?"bg-orange-900/50 text-orange-400":"bg-green-900/50 text-green-400"}`,children:(m.abuseipdb_score||m.abuse_score)>50?"HIGH RISK":(m.abuseipdb_score||m.abuse_score)>20?"MODERATE":"LOW RISK"})]})]})]}),(m.is_proxy||m.is_datacenter||m.is_mobile||m.is_tor||m.is_vpn)&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsx("label",{className:"text-xs text-gray-500 uppercase block mb-2",children:"Risk Indicators"}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.is_proxy&&t.jsxs("span",{className:"px-3 py-1 rounded-lg text-sm bg-orange-900/50 text-orange-400 border border-orange-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-4 h-4"}),"Proxy Detected"]}),m.is_vpn&&t.jsxs("span",{className:"px-3 py-1 rounded-lg text-sm bg-yellow-900/50 text-yellow-400 border border-yellow-700 flex items-center gap-1",children:[t.jsx(Yo,{className:"w-4 h-4"}),"VPN Detected"]}),m.is_tor&&t.jsxs("span",{className:"px-3 py-1 rounded-lg text-sm bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-4 h-4"}),"Tor Exit Node"]}),m.is_datacenter&&t.jsxs("span",{className:"px-3 py-1 rounded-lg text-sm bg-blue-900/50 text-blue-400 border border-blue-700 flex items-center gap-1",children:[t.jsx(vt,{className:"w-4 h-4"}),"Datacenter/Hosting"]}),m.is_mobile&&t.jsxs("span",{className:"px-3 py-1 rounded-lg text-sm bg-purple-900/50 text-purple-400 border border-purple-700 flex items-center gap-1",children:[t.jsx(R0,{className:"w-4 h-4"}),"Mobile Network"]})]})]}),(m.blacklist_count>0||((He=m.blacklists_listed)==null?void 0:He.length)>0)&&t.jsxs("div",{className:"bg-red-900/30 rounded-lg p-3 border border-red-700 mt-4",children:[t.jsxs("h3",{className:"text-sm font-semibold text-red-400 mb-2 flex items-center",children:[t.jsx(ae,{className:"w-4 h-4 mr-2"})," IP Blacklisted (",m.blacklist_count||(($t=m.blacklists_listed)==null?void 0:$t.length)||0," lists)"]}),m.blacklists_listed&&m.blacklists_listed.length>0&&t.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:m.blacklists_listed.map((wr,_r)=>t.jsx("span",{className:"px-2 py-1 text-xs bg-red-900/50 text-red-300 rounded border border-red-700",children:wr},_r))})]}),t.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t.jsxs("a",{href:`https://www.abuseipdb.com/check/${M}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm text-gray-300 transition-colors",children:[t.jsx(Ye,{className:"w-3 h-3"}),"AbuseIPDB"]}),t.jsxs("a",{href:`https://www.virustotal.com/gui/ip-address/${M}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm text-gray-300 transition-colors",children:[t.jsx(Ye,{className:"w-3 h-3"}),"VirusTotal"]}),t.jsxs("a",{href:`https://www.shodan.io/host/${M}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm text-gray-300 transition-colors",children:[t.jsx(Ye,{className:"w-3 h-3"}),"Shodan"]}),t.jsxs("a",{href:`https://ipinfo.io/${M}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1.5 bg-gray-700 hover:bg-gray-600 rounded text-sm text-gray-300 transition-colors",children:[t.jsx(Ye,{className:"w-3 h-3"}),"IPInfo"]})]})]})})(),((Ed=(Cd=e.email)==null?void 0:Cd.urls)==null?void 0:Ed.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(jt,{className:"w-5 h-5 mr-2 text-purple-400"}),"URL Analysis (",e.email.urls.length," URLs)"]}),t.jsxs("div",{className:"space-y-3",children:[e.email.urls.slice(0,10).map((m,M)=>{const G=typeof m=="string"?m:m.url,ne=de.find(He=>He.url===G),Se=typeof m=="object"?m:{url:G};let Me="";try{Me=new URL(G).hostname}catch{Me=G.split("/")[2]||G}return t.jsx("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-grow min-w-0",children:[t.jsx("p",{className:"font-mono text-sm text-yellow-400 break-all",children:u(G)}),t.jsxs("div",{className:"flex items-center flex-wrap gap-2 mt-2",children:[t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-gray-700 text-gray-300",children:Me}),Se.is_shortened&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-yellow-900/50 text-yellow-400 border border-yellow-700",children:" URL Shortener"}),Se.is_data_uri&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-red-900/50 text-red-400 border border-red-700",children:" Data URI"}),Se.has_ip_address&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-orange-900/50 text-orange-400 border border-orange-700",children:" IP in URL"}),Se.suspicious_tld&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-orange-900/50 text-orange-400 border border-orange-700",children:" Suspicious TLD"}),Se.has_at_symbol&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-red-900/50 text-red-400 border border-red-700",children:" @ Symbol"}),(ne==null?void 0:ne.virustotal_positives)!==void 0&&t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs ${ne.virustotal_positives>0?"bg-red-900/50 text-red-400 border border-red-700":"bg-green-900/50 text-green-400 border border-green-700"}`,children:["VT: ",ne.virustotal_positives,"/",ne.virustotal_total]}),(ne==null?void 0:ne.phishtank_in_database)&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-red-900/50 text-red-400 border border-red-700",children:" PhishTank: KNOWN PHISH"})]})]}),t.jsx("button",{onClick:()=>c(G,`url-${M}`),className:"p-2 text-gray-400 hover:text-white hover:bg-gray-700 rounded ml-2 flex-shrink-0",title:"Copy URL",children:t.jsx(De,{className:"w-4 h-4"})})]})},M)}),e.email.urls.length>10&&t.jsxs("p",{className:"text-sm text-gray-500 text-center",children:["+",e.email.urls.length-10," more URLs (see IOCs tab for full list)"]})]}),de.length===0&&t.jsx("div",{className:"mt-3 bg-gray-900/50 rounded-lg p-3 border border-dashed border-gray-700 text-center",children:t.jsxs("p",{className:"text-sm text-gray-500",children:[t.jsx(Ts,{className:"w-4 h-4 inline mr-1"}),"Configure VirusTotal/URLhaus API keys for URL reputation scanning"]})})]}),((Ad=(Td=e.email)==null?void 0:Td.attachments)==null?void 0:Ad.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(hr,{className:"w-5 h-5 mr-2 text-orange-400"}),"Attachment Analysis (",e.email.attachments.length," files)"]}),t.jsx("div",{className:"space-y-4",children:e.email.attachments.map((m,M)=>{var $t,wr,_r,uu,mu,xu,pu,hu;const G=xe.find(St=>St.sha256===m.sha256),ne=(($t=m.threat_level)==null?void 0:$t.toLowerCase())||"unknown",Se=m.threat_score||0,He=((St,Vt)=>St==="critical"||Vt>=70?{bg:"bg-red-900/30",border:"border-red-600",headerBg:"bg-red-900/50",text:"text-red-400"}:St==="high"||Vt>=50?{bg:"bg-orange-900/30",border:"border-orange-600",headerBg:"bg-orange-900/50",text:"text-orange-400"}:St==="medium"||Vt>=25?{bg:"bg-yellow-900/30",border:"border-yellow-600",headerBg:"bg-yellow-900/50",text:"text-yellow-400"}:St==="low"||Vt>0?{bg:"bg-blue-900/30",border:"border-blue-700",headerBg:"bg-blue-900/50",text:"text-blue-400"}:{bg:"bg-gray-900",border:"border-gray-700",headerBg:"bg-gray-800",text:"text-green-400"})(ne,Se);return t.jsxs("div",{className:`${He.bg} rounded-lg border ${He.border} overflow-hidden`,children:[t.jsxs("div",{className:`${He.headerBg} px-4 py-3 flex items-center justify-between`,children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(hr,{className:"w-5 h-5 text-gray-400"}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-200",children:m.filename}),t.jsxs("p",{className:"text-xs text-gray-500",children:[m.content_type,"  ",((m.size_bytes||m.size||0)/1024).toFixed(1)," KB",m.entropy&&`  Entropy: ${m.entropy.toFixed(2)}`]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[Se>0&&t.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full ${He.bg} border ${He.border}`,children:[t.jsx(oe,{className:`w-4 h-4 ${He.text}`}),t.jsxs("span",{className:`text-sm font-bold ${He.text}`,children:[Se,"/100"]})]}),ne==="clean"&&Se===0&&t.jsx("span",{className:"px-3 py-1 rounded-full bg-green-900/50 text-green-400 text-sm font-medium border border-green-700",children:" Clean"})]})]}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex flex-wrap gap-2",children:[m.is_executable&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," Executable"]}),(m.has_macros||m.is_office_with_macros)&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-orange-900/50 text-orange-400 border border-orange-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," VBA Macros"]}),m.has_auto_exec_macros&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(at,{className:"w-3 h-3"})," Auto-Execute Macros"]}),m.has_dde&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," DDE Links"]}),m.has_ole_objects&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-yellow-900/50 text-yellow-400 border border-yellow-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," OLE Objects"]}),m.has_javascript&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," JavaScript"]}),m.has_embedded_files&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-yellow-900/50 text-yellow-400 border border-yellow-700 flex items-center gap-1",children:[t.jsx(et,{className:"w-3 h-3"})," Embedded Files"]}),m.is_packed&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-purple-900/50 text-purple-400 border border-purple-700 flex items-center gap-1",children:[t.jsx(Yo,{className:"w-3 h-3"})," Packed"]}),m.has_suspicious_imports&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"})," Suspicious API Imports"]}),m.type_mismatch&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(at,{className:"w-3 h-3"})," Type Mismatch"]}),m.has_double_extension&&t.jsxs("span",{className:"px-2 py-1 rounded text-xs bg-red-900/50 text-red-400 border border-red-700 flex items-center gap-1",children:[t.jsx(at,{className:"w-3 h-3"})," Double Extension"]}),m.is_archive&&t.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-900/50 text-blue-400 border border-blue-700",children:"Archive"}),m.is_script&&t.jsx("span",{className:"px-2 py-1 rounded text-xs bg-yellow-900/50 text-yellow-400 border border-yellow-700",children:"Script"}),(G==null?void 0:G.virustotal_positives)!==void 0&&t.jsxs("span",{className:`px-2 py-1 rounded text-xs font-medium ${G.virustotal_positives>0?"bg-red-900/50 text-red-400 border border-red-700":"bg-green-900/50 text-green-400 border border-green-700"}`,children:["VT: ",G.virustotal_positives,"/",G.virustotal_total]})]}),m.threat_summary&&Se>0&&t.jsx("div",{className:`p-3 rounded-lg bg-gray-900/50 border ${He.border}`,children:t.jsx("p",{className:`text-sm ${He.text}`,children:m.threat_summary})}),(((wr=m.extracted_urls)==null?void 0:wr.length)>0||((_r=m.extracted_ips)==null?void 0:_r.length)>0||((uu=m.suspicious_strings)==null?void 0:uu.length)>0)&&t.jsxs("div",{className:"bg-gray-900/50 rounded-lg p-3 border border-gray-700",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2 uppercase tracking-wide",children:"Extracted from File Content"}),t.jsxs("div",{className:"space-y-2",children:[((mu=m.extracted_urls)==null?void 0:mu.length)>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"URLs:"}),t.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[m.extracted_urls.slice(0,5).map((St,Vt)=>t.jsx("code",{className:"text-xs bg-purple-900/30 text-purple-400 px-2 py-0.5 rounded border border-purple-700/50 max-w-xs truncate",children:St},Vt)),m.extracted_urls.length>5&&t.jsxs("span",{className:"text-xs text-gray-500",children:["+",m.extracted_urls.length-5," more"]})]})]}),((xu=m.extracted_ips)==null?void 0:xu.length)>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"IPs:"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:m.extracted_ips.slice(0,5).map((St,Vt)=>t.jsx("code",{className:"text-xs bg-blue-900/30 text-blue-400 px-2 py-0.5 rounded border border-blue-700/50",children:St},Vt))})]}),((pu=m.suspicious_strings)==null?void 0:pu.length)>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-xs text-gray-500 mr-2",children:"Suspicious Strings:"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:m.suspicious_strings.slice(0,5).map((St,Vt)=>t.jsx("code",{className:"text-xs bg-red-900/30 text-red-400 px-2 py-0.5 rounded border border-red-700/50 max-w-[200px] truncate",children:St},Vt))})]})]})]}),(m.sha256||m.md5)&&t.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2 uppercase tracking-wide",children:"File Hashes"}),t.jsxs("div",{className:"space-y-1",children:[m.sha256&&t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"SHA256:"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("code",{className:"font-mono text-gray-400",children:m.sha256}),t.jsx("button",{onClick:()=>c(m.sha256,`sha256-${M}`),className:"ml-2 text-gray-500 hover:text-white",children:t.jsx(De,{className:"w-3 h-3"})})]})]}),m.sha1&&t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"SHA1:"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("code",{className:"font-mono text-gray-400",children:m.sha1}),t.jsx("button",{onClick:()=>c(m.sha1,`sha1-${M}`),className:"ml-2 text-gray-500 hover:text-white",children:t.jsx(De,{className:"w-3 h-3"})})]})]}),m.md5&&t.jsxs("div",{className:"flex items-center justify-between text-xs",children:[t.jsx("span",{className:"text-gray-500",children:"MD5:"}),t.jsxs("div",{className:"flex items-center",children:[t.jsx("code",{className:"font-mono text-gray-400",children:m.md5}),t.jsx("button",{onClick:()=>c(m.md5,`md5-${M}`),className:"ml-2 text-gray-500 hover:text-white",children:t.jsx(De,{className:"w-3 h-3"})})]})]})]}),m.sha256&&t.jsxs("a",{href:`https://www.virustotal.com/gui/file/${m.sha256}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 mt-2 text-xs text-blue-400 hover:text-blue-300",children:[t.jsx(Ye,{className:"w-3 h-3"}),"Check on VirusTotal"]})]}),((hu=G==null?void 0:G.virustotal_threat_names)==null?void 0:hu.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded p-3",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-400 mb-2 uppercase tracking-wide",children:"VirusTotal Detections"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:G.virustotal_threat_names.slice(0,10).map((St,Vt)=>t.jsx("span",{className:"text-xs px-2 py-0.5 bg-red-900/50 text-red-400 rounded border border-red-700",children:St},Vt))})]})]})]},M)})})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ye,{className:"w-5 h-5 mr-2 text-cyan-400"}),"External Lookup Resources"]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:((Ld=(Rd=e.email)==null?void 0:Rd.sender)==null?void 0:Ld.domain)&&t.jsxs(t.Fragment,{children:[t.jsxs("a",{href:`https://www.virustotal.com/gui/domain/${e.email.sender.domain}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-3 py-2 bg-gray-900 hover:bg-gray-700 rounded-lg border border-gray-700 text-sm text-gray-300 transition-colors",children:[t.jsx(Ke,{className:"w-4 h-4 text-blue-400"}),"VirusTotal"]}),t.jsxs("a",{href:`https://urlhaus.abuse.ch/browse.php?search=${e.email.sender.domain}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-3 py-2 bg-gray-900 hover:bg-gray-700 rounded-lg border border-gray-700 text-sm text-gray-300 transition-colors",children:[t.jsx(Ze,{className:"w-4 h-4 text-purple-400"}),"URLhaus"]}),t.jsxs("a",{href:`https://www.whois.com/whois/${e.email.sender.domain}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-3 py-2 bg-gray-900 hover:bg-gray-700 rounded-lg border border-gray-700 text-sm text-gray-300 transition-colors",children:[t.jsx(Br,{className:"w-4 h-4 text-green-400"}),"WHOIS"]}),t.jsxs("a",{href:`https://mxtoolbox.com/SuperTool.aspx?action=mx%3a${e.email.sender.domain}&run=toolpage`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-3 py-2 bg-gray-900 hover:bg-gray-700 rounded-lg border border-gray-700 text-sm text-gray-300 transition-colors",children:[t.jsx(Ut,{className:"w-4 h-4 text-orange-400"}),"MX Lookup"]})]})})]}),!((Md=(Pd=e.email)==null?void 0:Pd.urls)!=null&&Md.length)&&!((Dd=($d=e.email)==null?void 0:$d.attachments)!=null&&Dd.length)&&!z&&!C&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 border border-gray-700 text-center",children:[t.jsx(Ze,{className:"w-16 h-16 mx-auto mb-4 text-gray-600"}),t.jsx("h3",{className:"text-xl font-semibold text-gray-400 mb-2",children:"Limited Threat Intel Data"}),t.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:"This email has no URLs or attachments to analyze. Configure API keys in Settings to enable automatic threat intelligence enrichment for sender domains."})]})]}),n==="iocs"&&t.jsxs("div",{className:"space-y-6",children:[((Od=(Id=e.iocs)==null?void 0:Id.domains)==null?void 0:Od.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ke,{className:"w-5 h-5 mr-2 text-blue-400"}),"Domains (",e.iocs.domains.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.iocs.domains.map((m,M)=>t.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-2",children:[t.jsx("span",{className:"font-mono text-sm text-yellow-400",children:u(m)}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>c(m,`domain-${M}`),className:"p-1 text-gray-400 hover:text-white",children:t.jsx(De,{className:"w-4 h-4"})}),p("domain",m).slice(0,2).map(G=>t.jsx("a",{href:G.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:G.name},G.name))]})]},M))})]}),((Ud=(zd=e.iocs)==null?void 0:zd.urls)==null?void 0:Ud.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(jt,{className:"w-5 h-5 mr-2 text-purple-400"}),"URLs (",e.iocs.urls.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.iocs.urls.map((m,M)=>t.jsx("div",{className:"bg-gray-900 rounded p-2",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsx("span",{className:"font-mono text-sm text-yellow-400 break-all",children:u(m)}),t.jsx("button",{onClick:()=>c(m,`ioc-url-${M}`),className:"p-1 text-gray-400 hover:text-white flex-shrink-0 ml-2",children:t.jsx(De,{className:"w-4 h-4"})})]})},M))})]}),((Bd=(Fd=e.iocs)==null?void 0:Fd.ips)==null?void 0:Bd.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(vt,{className:"w-5 h-5 mr-2 text-green-400"}),"IP Addresses (",e.iocs.ips.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.iocs.ips.map((m,M)=>t.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-2",children:[t.jsx("span",{className:"font-mono text-sm",children:u(m)}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>c(m,`ip-${M}`),className:"p-1 text-gray-400 hover:text-white",children:t.jsx(De,{className:"w-4 h-4"})}),p("ip",m).slice(0,2).map(G=>t.jsx("a",{href:G.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:G.name},G.name))]})]},M))})]}),((Vd=(Hd=e.iocs)==null?void 0:Hd.file_hashes_sha256)==null?void 0:Vd.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ql,{className:"w-5 h-5 mr-2 text-orange-400"}),"File Hashes (",e.iocs.file_hashes_sha256.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.iocs.file_hashes_sha256.map((m,M)=>t.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-2",children:[t.jsx("span",{className:"font-mono text-xs text-gray-300",children:m}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>c(m,`hash-ioc-${M}`),className:"p-1 text-gray-400 hover:text-white",children:t.jsx(De,{className:"w-4 h-4"})}),p("hash",m).slice(0,2).map(G=>t.jsx("a",{href:G.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-1 bg-gray-700 hover:bg-gray-600 rounded",children:G.name},G.name))]})]},M))})]}),((Wd=(qd=e.iocs)==null?void 0:qd.email_addresses)==null?void 0:Wd.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ut,{className:"w-5 h-5 mr-2 text-cyan-400"}),"Email Addresses (",e.iocs.email_addresses.length,")"]}),t.jsx("div",{className:"space-y-2",children:e.iocs.email_addresses.map((m,M)=>t.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-2",children:[t.jsx("span",{className:"font-mono text-sm",children:u(m)}),t.jsx("button",{onClick:()=>c(m,`email-${M}`),className:"p-1 text-gray-400 hover:text-white",children:t.jsx(De,{className:"w-4 h-4"})})]},M))})]})]}),n==="rules"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(oe,{className:"w-5 h-5 mr-2 text-red-400"}),"Triggered Detection Rules (",((Qd=(Kd=e.detection)==null?void 0:Kd.rules_triggered)==null?void 0:Qd.length)||0,")"]}),((Xd=(Gd=e.detection)==null?void 0:Gd.rules_triggered)==null?void 0:Xd.length)>0?t.jsx("div",{className:"space-y-2",children:e.detection.rules_triggered.map((m,M)=>t.jsxs("div",{className:`rounded p-3 border ${m.severity==="critical"?"bg-red-900/20 border-red-700":m.severity==="high"?"bg-orange-900/20 border-orange-700":m.severity==="medium"?"bg-yellow-900/20 border-yellow-700":"bg-blue-900/20 border-blue-700"}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("span",{className:`px-2 py-0.5 text-xs font-bold uppercase rounded ${m.severity==="critical"?"bg-red-600 text-white":m.severity==="high"?"bg-orange-600 text-white":m.severity==="medium"?"bg-yellow-600 text-black":"bg-blue-600 text-white"}`,children:m.severity}),t.jsx("span",{className:"font-medium",children:m.rule_name||m.name})]}),t.jsx("span",{className:"text-sm text-gray-400",children:m.category})]}),m.description&&t.jsx("p",{className:"text-sm text-gray-400 mt-2",children:m.description}),m.evidence&&t.jsxs("p",{className:"text-xs font-mono text-gray-500 mt-1 bg-gray-900 p-2 rounded",children:["Evidence: ",m.evidence]}),m.mitre_technique&&t.jsxs("div",{className:"flex items-center mt-2 space-x-2",children:[t.jsx(Ot,{className:"w-4 h-4 text-purple-400"}),t.jsxs("a",{href:`https://attack.mitre.org/techniques/${m.mitre_technique.includes(".")?m.mitre_technique.replace(".","/"):m.mitre_technique}/`,target:"_blank",rel:"noopener noreferrer",className:"text-xs px-2 py-0.5 bg-purple-900/50 text-purple-400 rounded hover:bg-purple-900 flex items-center gap-1",children:[m.mitre_technique,t.jsx(Ye,{className:"w-3 h-3"})]})]})]},M))}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Zo,{className:"w-12 h-12 mx-auto mb-4 text-green-500"}),t.jsx("p",{className:"text-green-400 font-medium",children:"No Detection Rules Triggered"}),t.jsx("p",{className:"text-gray-500 text-sm",children:"This email did not match any of the 51 detection rules"})]})]}),((Jd=(Yd=e.ai_triage)==null?void 0:Yd.mitre_techniques)==null?void 0:Jd.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ot,{className:"w-5 h-5 mr-2 text-purple-400"}),"MITRE ATT&CK Techniques"]}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:e.ai_triage.mitre_techniques.map((m,M)=>{const G=typeof m=="string"?m:m.technique_id,ne=typeof m=="string"?null:m.name,Se=typeof m=="string"?null:m.tactic,Me=G?`https://attack.mitre.org/techniques/${G.includes(".")?G.replace(".","/"):G}/`:"#";return t.jsxs("a",{href:Me,target:"_blank",rel:"noopener noreferrer",className:"bg-gray-900 rounded p-3 border border-gray-700 hover:border-purple-500 transition-colors",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-purple-400 font-mono text-sm",children:G||"Unknown"}),t.jsx(Ye,{className:"w-4 h-4 text-gray-500"})]}),ne&&t.jsx("p",{className:"text-white font-medium",children:ne}),Se&&t.jsx("p",{className:"text-sm text-gray-400",children:Se})]},M)})})]})]}),n==="ai"&&t.jsx("div",{className:"space-y-6",children:e.ai_triage?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(nt,{className:"w-5 h-5 mr-2 text-cyan-400"}),"AI Threat Assessment",e.ai_triage.model_used&&t.jsx("span",{className:"ml-2 text-xs bg-gray-700 px-2 py-0.5 rounded text-gray-400",children:e.ai_triage.model_used})]}),t.jsx("div",{className:"bg-gray-900 rounded p-4",children:t.jsx("p",{className:"text-gray-300 leading-relaxed",children:e.ai_triage.summary})})]}),e.ai_triage.detailed_analysis&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(et,{className:"w-5 h-5 mr-2 text-blue-400"}),"Analysis Description"]}),t.jsx("div",{className:"bg-gray-900 rounded p-4",children:t.jsx("p",{className:"text-gray-300 leading-relaxed whitespace-pre-wrap",children:e.ai_triage.detailed_analysis})})]}),((Zd=e.ai_triage.key_findings)==null?void 0:Zd.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(bn,{className:"w-5 h-5 mr-2 text-yellow-400"}),"Key Findings"]}),t.jsx("ul",{className:"space-y-2",children:e.ai_triage.key_findings.map((m,M)=>t.jsxs("li",{className:"flex items-start bg-gray-900 rounded p-3",children:[t.jsx(ae,{className:"w-5 h-5 mr-3 text-yellow-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-gray-300",children:m})]},M))})]}),((eu=e.ai_triage.recommended_actions)==null?void 0:eu.length)>0&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(gt,{className:"w-5 h-5 mr-2 text-green-400"}),"Recommended Actions"]}),t.jsx("div",{className:"space-y-3",children:e.ai_triage.recommended_actions.map((m,M)=>t.jsxs("div",{className:"bg-gray-900 rounded p-3 border-l-4 border-green-500",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"font-semibold text-green-400",children:m.action}),t.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${m.priority==="high"?"bg-red-900/50 text-red-400":m.priority==="medium"?"bg-yellow-900/50 text-yellow-400":"bg-blue-900/50 text-blue-400"}`,children:[m.priority," priority"]})]}),t.jsx("p",{className:"text-sm text-gray-400",children:m.details})]},M))})]})]}):t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 text-center",children:[t.jsx(nt,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"AI Analysis Not Available"}),t.jsx("p",{className:"text-gray-500",children:"Configure an AI provider (OpenAI or Anthropic) in Settings to enable AI-powered threat analysis."})]})}),n==="sandbox"&&t.jsx("div",{className:"space-y-6",children:t.jsx(hj,{sandboxAnalysis:e.sandbox_analysis})}),n==="enhanced"&&t.jsxs("div",{className:"space-y-6",children:[e.se_analysis&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(nt,{className:"w-5 h-5 mr-2 text-purple-400"}),"Social Engineering Analysis",t.jsxs("span",{className:`ml-2 px-2 py-0.5 text-xs rounded font-bold ${e.se_analysis.se_level==="critical"?"bg-red-600":e.se_analysis.se_level==="high"?"bg-orange-600":e.se_analysis.se_level==="medium"?"bg-yellow-600 text-black":"bg-green-600"}`,children:[e.se_analysis.se_score,"/100"]})]}),t.jsx("div",{className:"grid grid-cols-5 gap-2 mb-4",children:Object.entries(e.se_analysis.heuristic_breakdown||{}).map(([m,M])=>t.jsxs("div",{className:"bg-gray-900 rounded p-2 text-center",children:[t.jsx("div",{className:"text-xs text-gray-400 uppercase",children:m}),t.jsx("div",{className:`text-lg font-bold ${M>70?"text-red-400":M>40?"text-yellow-400":"text-green-400"}`,children:M})]},m))}),((tu=e.se_analysis.techniques)==null?void 0:tu.length)>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Techniques Detected"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:e.se_analysis.techniques.map((m,M)=>t.jsx("span",{className:"px-2 py-1 bg-purple-900/50 text-purple-400 text-xs rounded",children:m},M))})]}),((su=e.se_analysis.key_indicators)==null?void 0:su.length)>0&&t.jsxs("div",{className:"mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Key Indicators"}),t.jsx("ul",{className:"space-y-1",children:e.se_analysis.key_indicators.map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm",children:[t.jsx(ae,{className:"w-4 h-4 mr-2 text-yellow-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-gray-300",children:m})]},M))})]}),e.se_analysis.explanation&&t.jsx("div",{className:"bg-gray-900 rounded p-3",children:t.jsx("p",{className:"text-sm text-gray-300",children:e.se_analysis.explanation})})]}),e.content_analysis&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(et,{className:"w-5 h-5 mr-2 text-blue-400"}),"Content Deconstruction",t.jsx("span",{className:"ml-2 px-2 py-0.5 text-xs bg-blue-900/50 text-blue-400 rounded",children:(ru=e.content_analysis.intent)==null?void 0:ru.replace(/_/g," ")})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[((nu=e.content_analysis.requested_actions)==null?void 0:nu.length)>0&&t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Requested Actions"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.content_analysis.requested_actions.map((m,M)=>t.jsx("span",{className:"px-2 py-0.5 bg-orange-900/50 text-orange-400 text-xs rounded",children:m.replace(/_/g," ")},M))})]}),((au=e.content_analysis.target_data)==null?void 0:au.length)>0&&t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Target Data"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.content_analysis.target_data.map((m,M)=>t.jsx("span",{className:"px-2 py-0.5 bg-red-900/50 text-red-400 text-xs rounded",children:m.replace(/_/g," ")},M))})]})]}),e.content_analysis.business_process_abused&&e.content_analysis.business_process_abused!=="none"&&t.jsxs("div",{className:"bg-gray-900 rounded p-3 mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-1",children:"Business Process Abused"}),t.jsx("span",{className:"text-yellow-400",children:e.content_analysis.business_process_abused.replace(/_/g," ")})]}),e.content_analysis.spoofed_brand&&t.jsxs("div",{className:"bg-red-900/20 border border-red-700 rounded p-3 mb-4",children:[t.jsx("h3",{className:"text-sm font-semibold text-red-400 mb-1",children:"Spoofed Brand Detected"}),t.jsx("span",{className:"text-white font-medium",children:e.content_analysis.spoofed_brand}),e.content_analysis.spoofed_entity_type&&t.jsxs("span",{className:"ml-2 text-xs text-gray-400",children:["(",e.content_analysis.spoofed_entity_type,")"]})]}),((lu=e.content_analysis.potential_impact)==null?void 0:lu.length)>0&&t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Potential Impact"}),t.jsx("div",{className:"flex flex-wrap gap-1",children:e.content_analysis.potential_impact.map((m,M)=>t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs rounded",children:m.replace(/_/g," ")},M))})]})]}),e.lookalike_analysis&&e.lookalike_analysis.has_lookalikes&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-red-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ke,{className:"w-5 h-5 mr-2 text-red-400"}),"Lookalike Domain Detection",t.jsxs("span",{className:"ml-2 px-2 py-0.5 text-xs bg-red-600 text-white rounded font-bold",children:[((iu=e.lookalike_analysis.matches)==null?void 0:iu.length)||0," found"]})]}),t.jsx("div",{className:"space-y-3",children:(ou=e.lookalike_analysis.matches)==null?void 0:ou.map((m,M)=>{var G,ne;return t.jsxs("div",{className:"bg-red-900/20 border border-red-700 rounded p-3",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-mono text-red-400",children:m.suspicious_domain}),t.jsxs("span",{className:`px-2 py-0.5 text-xs rounded ${m.confidence>.8?"bg-red-600":m.confidence>.5?"bg-orange-600":"bg-yellow-600 text-black"}`,children:[Math.round(m.confidence*100),"% confidence"]})]}),m.description&&t.jsx("p",{className:"text-sm text-gray-300 mb-3 leading-relaxed",children:m.description}),t.jsxs("div",{className:"text-sm text-gray-400",children:[t.jsxs("span",{className:"mr-4",children:["Impersonating: ",t.jsx("span",{className:"text-white font-medium capitalize",children:m.target_brand})]}),t.jsxs("span",{className:"mr-4",children:["Real domain: ",t.jsx("span",{className:"text-green-400",children:m.legitimate_domain})]})]}),((G=m.detection_methods)==null?void 0:G.length)>0&&t.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:m.detection_methods.map((Se,Me)=>{const He=Se.replace(/_/g," ").replace(/edit distance (\d+)/i,"Edit distance: $1").replace(/^(\w)/,$t=>$t.toUpperCase());return t.jsx("span",{className:"px-2 py-0.5 bg-gray-700 text-gray-300 text-xs rounded",children:He},Me)})}),((ne=m.homoglyphs_found)==null?void 0:ne.length)>0&&t.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["Homoglyphs: ",m.homoglyphs_found.join(", ")]})]},M)})})]}),e.ti_results&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Ze,{className:"w-5 h-5 mr-2 text-cyan-400"}),"Threat Intelligence Fusion",t.jsxs("span",{className:`ml-2 px-2 py-0.5 text-xs rounded font-bold ${e.ti_results.fused_verdict==="malicious"?"bg-red-600":e.ti_results.fused_verdict==="suspicious"?"bg-orange-600":"bg-green-600"}`,children:[e.ti_results.fused_score,"/100"]})]}),e.ti_results.api_status&&Object.keys(e.ti_results.api_status).length>0&&t.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:Object.entries(e.ti_results.api_status).map(([m,M])=>t.jsxs("div",{className:"bg-gray-900 rounded p-2 flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-gray-400",children:m}),t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${String(M||"").toLowerCase().includes("ok")?"bg-green-900/50 text-green-400":String(M||"").toLowerCase().includes("limit")?"bg-yellow-900/50 text-yellow-400":"bg-red-900/50 text-red-400"}`,children:M})]},m))}),((cu=e.ti_results.findings)==null?void 0:cu.length)>0&&t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Findings"}),t.jsx("ul",{className:"space-y-1",children:e.ti_results.findings.map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm",children:[t.jsx(Ts,{className:"w-4 h-4 mr-2 text-cyan-400 flex-shrink-0 mt-0.5"}),t.jsx("span",{className:"text-gray-300",children:m})]},M))})]})]}),e.risk_score&&e.risk_score.dimensions&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[t.jsx(Gl,{className:"w-5 h-5 mr-2 text-green-400"}),"Multi-Dimensional Risk Score",t.jsxs("span",{className:`ml-2 px-2 py-0.5 text-xs rounded font-bold ${e.risk_score.overall_level==="critical"?"bg-red-600":e.risk_score.overall_level==="high"?"bg-orange-600":e.risk_score.overall_level==="medium"?"bg-yellow-600 text-black":"bg-green-600"}`,children:[e.risk_score.overall_score,"/100"]})]}),t.jsx("div",{className:"space-y-3 mb-4",children:Object.entries(e.risk_score.dimensions).map(([m,M])=>{var G;return t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("span",{className:"text-sm font-medium text-gray-300",children:m.replace(/_/g," ")}),t.jsx("span",{className:`text-sm font-bold ${M.level==="critical"?"text-red-400":M.level==="high"?"text-orange-400":M.level==="medium"?"text-yellow-400":"text-green-400"}`,children:M.score})]}),t.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full ${M.level==="critical"?"bg-red-500":M.level==="high"?"bg-orange-500":M.level==="medium"?"bg-yellow-500":"bg-green-500"}`,style:{width:`${M.score}%`}})}),((G=M.indicators)==null?void 0:G.length)>0&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:M.indicators.slice(0,3).map((ne,Se)=>t.jsx("span",{className:"text-xs text-gray-500",children:ne},Se))})]},m)})}),((du=e.risk_score.top_indicators)==null?void 0:du.length)>0&&t.jsxs("div",{className:"bg-gray-900 rounded p-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-400 mb-2",children:"Top Indicators"}),t.jsx("ol",{className:"space-y-1",children:e.risk_score.top_indicators.slice(0,5).map((m,M)=>t.jsxs("li",{className:"flex items-start text-sm",children:[t.jsxs("span",{className:"text-yellow-400 font-bold mr-2",children:[M+1,"."]}),t.jsx("span",{className:"text-gray-300",children:m})]},M))})]})]}),!e.se_analysis&&!e.content_analysis&&!e.lookalike_analysis&&!e.ti_results&&t.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 border border-gray-700 text-center",children:[t.jsx(gt,{className:"w-12 h-12 mx-auto mb-4 text-gray-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-400 mb-2",children:"Enhanced Analysis Not Available"}),t.jsx("p",{className:"text-gray-500",children:"Run analysis with Enhanced mode enabled to see social engineering scoring, content deconstruction, and lookalike domain detection."})]})]})]})]})}catch(m){return console.error("AdvancedAnalysisView render error:",m),t.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-8",children:t.jsxs("div",{className:"bg-red-900/50 border border-red-500 rounded-lg p-6 max-w-2xl",children:[t.jsx("h2",{className:"text-xl font-bold text-red-400 mb-2",children:"Error Rendering Analysis View"}),t.jsx("p",{className:"text-gray-300 mb-4",children:"An error occurred while rendering the analysis:"}),t.jsx("pre",{className:"bg-black/50 p-4 rounded text-sm text-red-300 overflow-auto max-h-40",children:String(m)}),t.jsx("button",{onClick:r,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700",children:"Go Back"})]})})}},fj=e=>{switch(e.toLowerCase()){case"critical":return"text-red-400 bg-red-500/20 border-red-500";case"high":return"text-orange-400 bg-orange-500/20 border-orange-500";case"medium":return"text-yellow-400 bg-yellow-500/20 border-yellow-500";case"low":return"text-blue-400 bg-blue-500/20 border-blue-500";default:return"text-green-400 bg-green-500/20 border-green-500"}},yj=e=>{switch((e||"").toLowerCase()){case"critical":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";default:return"bg-blue-500"}},bj=e=>{switch(e.toLowerCase()){case"sms":return t.jsx(ec,{className:"w-5 h-5"});case"url":return t.jsx(jt,{className:"w-5 h-5"});case"whatsapp":return t.jsx(Xt,{className:"w-5 h-5"});case"telegram":return t.jsx(Xt,{className:"w-5 h-5"});default:return t.jsx(Xt,{className:"w-5 h-5"})}},jj=({result:e,onClose:s,onSOCTools:r})=>{const n={analysis_id:(e==null?void 0:e.analysis_id)||"",analyzed_at:(e==null?void 0:e.analyzed_at)||new Date().toISOString(),analysis_type:(e==null?void 0:e.analysis_type)||"url",source:(e==null?void 0:e.source)||"url",original_text:(e==null?void 0:e.original_text)||"",message_length:(e==null?void 0:e.message_length)||((e==null?void 0:e.original_text)||"").length||0,overall_score:(e==null?void 0:e.overall_score)||0,overall_level:(e==null?void 0:e.overall_level)||"low",classification:(e==null?void 0:e.classification)||"unknown",is_threat:(e==null?void 0:e.is_threat)||!1,confidence:(e==null?void 0:e.confidence)||0,urls_found:(e==null?void 0:e.urls_found)||[],domains_found:(e==null?void 0:e.domains_found)||[],ips_found:(e==null?void 0:e.ips_found)||[],phone_numbers_found:(e==null?void 0:e.phone_numbers_found)||[],url_enrichment:(e==null?void 0:e.url_enrichment)||[],url_sandbox:(e==null?void 0:e.url_sandbox)||[],patterns_matched:(e==null?void 0:e.patterns_matched)||[],threat_indicators:(e==null?void 0:e.threat_indicators)||[],ai_analysis:(e==null?void 0:e.ai_analysis)||{enabled:!1,provider:"",summary:"",threat_assessment:"",key_findings:[],social_engineering_tactics:[]},recommendations:(e==null?void 0:e.recommendations)||[],mitre_techniques:(e==null?void 0:e.mitre_techniques)||[]},[a,l]=bs.useState({indicators:!0,patterns:!0,ai:!0,urls:!0,recommendations:!0}),i=c=>{l(u=>({...u,[c]:!u[c]}))},o=c=>{navigator.clipboard.writeText(c)},d=n.source==="url";return t.jsxs("div",{className:"space-y-4 md:space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h1",{className:"text-xl md:text-2xl font-bold flex items-center gap-2",children:[bj(n.source),d?"URL Analysis":`${n.source.toUpperCase()} Analysis`]}),t.jsxs("div",{className:"flex items-center gap-2",children:[r&&t.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-3 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg transition-colors text-sm font-medium",children:[t.jsx(oe,{className:"w-4 h-4"}),"SOC Tools"]}),s&&t.jsx("button",{onClick:s,className:"flex items-center gap-2 px-3 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition-colors text-sm",children:" Back"})]})]}),t.jsxs("div",{className:`p-4 md:p-6 rounded-xl border-2 ${fj(n.overall_level)}`,children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[t.jsx("div",{className:`w-12 h-12 md:w-16 md:h-16 rounded-xl flex items-center justify-center ${n.is_threat?"bg-red-500/30":"bg-green-500/30"}`,children:n.is_threat?t.jsx(ae,{className:"w-6 h-6 md:w-8 md:h-8 text-red-400"}):t.jsx(Ce,{className:"w-6 h-6 md:w-8 md:h-8 text-green-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg md:text-xl font-bold",children:n.classification.replace(/_/g," ").toUpperCase()}),t.jsx("p",{className:"text-xs md:text-sm text-slate-400 mt-1",children:n.is_threat?" Threat Detected":" No Immediate Threat"})]})]}),t.jsxs("div",{className:"text-center self-end sm:self-auto",children:[t.jsx("div",{className:`w-16 h-16 md:w-20 md:h-20 rounded-full border-4 flex items-center justify-center ${n.overall_score>=70?"border-red-500":n.overall_score>=40?"border-orange-500":n.overall_score>=20?"border-yellow-500":"border-green-500"}`,children:t.jsx("span",{className:"text-xl md:text-2xl font-bold",children:n.overall_score})}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400 mt-1",children:"Risk Score"})]})]}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 md:gap-4 mt-4 md:mt-6",children:[t.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("p",{className:"text-lg md:text-2xl font-bold text-blue-400",children:n.urls_found.length}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400",children:"URLs"})]}),t.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("p",{className:"text-lg md:text-2xl font-bold text-purple-400",children:n.patterns_matched.length}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400",children:"Patterns"})]}),t.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("p",{className:"text-lg md:text-2xl font-bold text-orange-400",children:n.phone_numbers_found.length}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400",children:"Phones"})]}),t.jsxs("div",{className:"bg-slate-800/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsxs("p",{className:"text-lg md:text-2xl font-bold text-green-400",children:[Math.round(n.confidence*100),"%"]}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400",children:"Confidence"})]})]})]}),t.jsxs("div",{className:"bg-slate-800 rounded-xl p-3 md:p-4 border border-slate-700",children:[t.jsxs("h3",{className:"text-sm font-semibold text-slate-300 mb-2 flex items-center gap-2",children:[t.jsx(Xt,{className:"w-4 h-4"}),"Original Content"]}),t.jsx("div",{className:"bg-slate-900 rounded-lg p-3 md:p-4 font-mono text-xs md:text-sm text-slate-300 whitespace-pre-wrap break-all max-h-32 md:max-h-40 overflow-y-auto",children:n.original_text||"(No content)"}),t.jsxs("div",{className:"flex items-center justify-between mt-2 text-[10px] md:text-xs text-slate-500",children:[t.jsxs("span",{children:[n.message_length," characters"]}),t.jsxs("button",{onClick:()=>o(n.original_text),className:"flex items-center gap-1 hover:text-slate-300",children:[t.jsx(De,{className:"w-3 h-3"})," Copy"]})]})]}),t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[t.jsxs("button",{onClick:()=>i("ai"),className:"w-full p-4 flex items-center justify-between hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(nt,{className:"w-5 h-5 text-purple-400"}),t.jsx("h3",{className:"font-semibold",children:"AI Analysis"}),n.ai_analysis.enabled?t.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded",children:n.ai_analysis.provider||"AI"}):t.jsx("span",{className:"text-xs bg-slate-600/50 text-slate-400 px-2 py-0.5 rounded",children:"Not Configured"})]}),a.ai?t.jsx(Er,{className:"w-4 h-4"}):t.jsx(Qt,{className:"w-4 h-4"})]}),a.ai&&t.jsx("div",{className:"p-4 pt-0 space-y-4",children:n.ai_analysis.enabled?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-slate-900 rounded-lg p-4",children:t.jsx("p",{className:"text-slate-300",children:n.ai_analysis.summary})}),n.ai_analysis.threat_assessment&&t.jsxs("div",{className:`inline-flex items-center gap-2 px-3 py-1 rounded-full ${n.ai_analysis.threat_assessment==="MALICIOUS"?"bg-red-500/20 text-red-300":n.ai_analysis.threat_assessment==="SUSPICIOUS"?"bg-orange-500/20 text-orange-300":"bg-green-500/20 text-green-300"}`,children:[t.jsx(oe,{className:"w-4 h-4"}),n.ai_analysis.threat_assessment]}),n.ai_analysis.key_findings.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Key Findings"}),t.jsx("ul",{className:"space-y-1",children:n.ai_analysis.key_findings.map((c,u)=>t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx(bn,{className:"w-4 h-4 text-yellow-400 mt-0.5 flex-shrink-0"}),c]},u))})]}),n.ai_analysis.social_engineering_tactics.length>0&&t.jsxs("div",{children:[t.jsx("h4",{className:"text-sm font-medium text-slate-400 mb-2",children:"Social Engineering Tactics"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.ai_analysis.social_engineering_tactics.map((c,u)=>t.jsx("span",{className:"px-2 py-1 bg-orange-500/20 text-orange-300 rounded text-xs",children:c},u))})]})]}):t.jsxs("div",{className:"bg-slate-900 rounded-lg p-4 text-center",children:[t.jsx(Ts,{className:"w-8 h-8 text-slate-500 mx-auto mb-2"}),t.jsx("p",{className:"text-slate-400 text-sm",children:n.ai_analysis.summary||"AI analysis not available"}),t.jsx("p",{className:"text-slate-500 text-xs mt-2",children:"Configure OPENAI_API_KEY or ANTHROPIC_API_KEY in settings"})]})})]}),t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[t.jsxs("button",{onClick:()=>i("indicators"),className:"w-full p-4 flex items-center justify-between hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ae,{className:"w-5 h-5 text-orange-400"}),t.jsx("h3",{className:"font-semibold",children:"Threat Indicators"}),t.jsx("span",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded",children:n.threat_indicators.length})]}),a.indicators?t.jsx(Er,{className:"w-4 h-4"}):t.jsx(Qt,{className:"w-4 h-4"})]}),a.indicators&&t.jsx("div",{className:"p-4 pt-0",children:t.jsx("ul",{className:"space-y-2",children:n.threat_indicators.map((c,u)=>t.jsx("li",{className:"flex items-start gap-2 text-sm text-slate-300 bg-slate-900 rounded-lg p-2",children:c},u))})})]}),n.patterns_matched.length>0&&t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[t.jsxs("button",{onClick:()=>i("patterns"),className:"w-full p-4 flex items-center justify-between hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ot,{className:"w-5 h-5 text-red-400"}),t.jsx("h3",{className:"font-semibold",children:"Detected Patterns"}),t.jsx("span",{className:"text-xs bg-red-500/20 text-red-300 px-2 py-0.5 rounded",children:n.patterns_matched.length})]}),a.patterns?t.jsx(Er,{className:"w-4 h-4"}):t.jsx(Qt,{className:"w-4 h-4"})]}),a.patterns&&t.jsx("div",{className:"p-4 pt-0 space-y-3",children:n.patterns_matched.map((c,u)=>t.jsxs("div",{className:"bg-slate-900 rounded-lg p-3",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${yj(c.severity)}`}),t.jsx("span",{className:"font-medium text-slate-200",children:c.name}),t.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${c.severity==="critical"?"bg-red-500/20 text-red-300":c.severity==="high"?"bg-orange-500/20 text-orange-300":"bg-yellow-500/20 text-yellow-300"}`,children:c.severity}),c.mitre_technique&&t.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-1.5 py-0.5 rounded",children:c.mitre_technique})]}),t.jsx("p",{className:"text-sm text-slate-400",children:c.description}),c.matched_text&&t.jsxs("p",{className:"text-xs text-slate-500 mt-1 font-mono bg-slate-800 p-1 rounded",children:['Matched: "',c.matched_text,'"']})]},u))})]}),n.urls_found.length>0&&t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[t.jsxs("button",{onClick:()=>i("urls"),className:"w-full p-4 flex items-center justify-between hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(jt,{className:"w-5 h-5 text-blue-400"}),t.jsx("h3",{className:"font-semibold",children:"URLs & Threat Intel"}),t.jsx("span",{className:"text-xs bg-blue-500/20 text-blue-300 px-2 py-0.5 rounded",children:n.urls_found.length})]}),a.urls?t.jsx(Er,{className:"w-4 h-4"}):t.jsx(Qt,{className:"w-4 h-4"})]}),a.urls&&t.jsx("div",{className:"p-4 pt-0 space-y-3",children:n.url_enrichment.length>0?n.url_enrichment.map((c,u)=>{var h,b;return t.jsxs("div",{className:`rounded-lg p-3 border ${c.is_malicious?"bg-red-500/10 border-red-500/50":"bg-slate-900 border-slate-700"}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[c.is_malicious?t.jsx(at,{className:"w-4 h-4 text-red-400 flex-shrink-0"}):t.jsx(Ke,{className:"w-4 h-4 text-slate-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-slate-300 truncate",children:c.url})]}),t.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[c.threat_score>0&&t.jsxs("span",{className:`text-xs px-2 py-0.5 rounded ${c.threat_score>=70?"bg-red-500/20 text-red-300":c.threat_score>=40?"bg-orange-500/20 text-orange-300":"bg-yellow-500/20 text-yellow-300"}`,children:["Score: ",c.threat_score]}),t.jsx("a",{href:`https://www.virustotal.com/gui/url/${btoa(c.url)}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300",children:t.jsx(Ye,{className:"w-4 h-4"})})]})]}),((h=c.sources)==null?void 0:h.length)>0&&t.jsxs("div",{className:"flex items-center gap-1 mt-2",children:[t.jsx("span",{className:"text-xs text-slate-500",children:"Sources:"}),c.sources.map((w,f)=>t.jsx("span",{className:"text-xs bg-slate-700 px-1.5 py-0.5 rounded",children:w},f))]}),((b=c.categories)==null?void 0:b.length)>0&&t.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[t.jsx("span",{className:"text-xs text-slate-500",children:"Categories:"}),c.categories.map((w,f)=>t.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-1.5 py-0.5 rounded",children:w},f))]})]},u)}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"bg-slate-900/50 rounded-lg p-3 mb-3 border border-slate-700",children:t.jsxs("div",{className:"flex items-center gap-2 text-slate-400 text-sm",children:[t.jsx(Ts,{className:"w-4 h-4"}),t.jsx("span",{children:"No threat intelligence data available. Configure API keys in settings for full analysis."})]})}),n.urls_found.map((c,u)=>t.jsxs("div",{className:"bg-slate-900 rounded-lg p-3 flex items-center justify-between",children:[t.jsx("span",{className:"text-sm text-slate-300 truncate",children:c}),t.jsx("a",{href:`https://www.virustotal.com/gui/url/${btoa(c)}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-400 hover:text-blue-300 ml-2",title:"Check on VirusTotal",children:t.jsx(Ye,{className:"w-4 h-4"})})]},u))]})})]}),n.url_sandbox&&n.url_sandbox.length>0&&t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-orange-600/50 overflow-hidden",children:[t.jsxs("div",{className:"p-4 bg-orange-500/10 border-b border-orange-600/30",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{className:"w-5 h-5 text-orange-400"}),t.jsx("h3",{className:"font-semibold",children:"URL Sandbox Analysis"}),t.jsx("span",{className:"text-xs bg-orange-500/20 text-orange-300 px-2 py-0.5 rounded",children:"Dynamic Analysis"})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-1",children:"Real-time URL detonation and behavioral analysis"})]}),t.jsx("div",{className:"p-4 space-y-4",children:n.url_sandbox.map((c,u)=>{var h,b,w,f;return t.jsxs("div",{className:`rounded-lg p-4 border ${c.is_malicious?"bg-red-500/10 border-red-500/50":"bg-slate-900 border-slate-700"}`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[c.is_malicious?t.jsx(at,{className:"w-5 h-5 text-red-400"}):t.jsx(Ce,{className:"w-5 h-5 text-green-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200 truncate max-w-md",children:c.url})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${c.threat_level==="malicious"?"bg-red-500/20 text-red-300":c.threat_level==="suspicious"?"bg-orange-500/20 text-orange-300":c.threat_level==="low"?"bg-yellow-500/20 text-yellow-300":"bg-green-500/20 text-green-300"}`,children:(c.threat_level||"unknown").toUpperCase()}),t.jsxs("span",{className:"text-xs bg-slate-700 px-2 py-0.5 rounded",children:["Score: ",c.threat_score]}),t.jsx("span",{className:"text-xs bg-purple-500/20 text-purple-300 px-2 py-0.5 rounded",children:c.provider})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[c.page_title&&t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:"Page Title:"}),t.jsx("span",{className:"text-slate-300 ml-2",children:c.page_title})]}),c.final_url&&c.final_url!==c.url&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-slate-500",children:"Final URL:"}),t.jsx("span",{className:"text-orange-300 ml-2 break-all",children:c.final_url})]}),((h=c.contacted_domains)==null?void 0:h.length)>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:"Contacted Domains:"}),t.jsxs("div",{className:"flex flex-wrap gap-1 mt-1",children:[c.contacted_domains.slice(0,5).map((y,v)=>t.jsx("span",{className:"text-xs bg-slate-700 px-1.5 py-0.5 rounded text-slate-300",children:y},v)),c.contacted_domains.length>5&&t.jsxs("span",{className:"text-xs text-slate-500",children:["+",c.contacted_domains.length-5," more"]})]})]}),((b=c.contacted_ips)==null?void 0:b.length)>0&&t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:"Contacted IPs:"}),t.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:c.contacted_ips.slice(0,5).map((y,v)=>t.jsx("span",{className:"text-xs bg-slate-700 px-1.5 py-0.5 rounded font-mono text-slate-300",children:y},v))})]}),((w=c.redirects)==null?void 0:w.length)>0&&t.jsxs("div",{className:"col-span-2",children:[t.jsxs("span",{className:"text-slate-500",children:["Redirect Chain (",c.redirects.length,"):"]}),t.jsx("div",{className:"flex flex-wrap items-center gap-1 mt-1",children:c.redirects.map((y,v)=>t.jsxs(bs.Fragment,{children:[t.jsx("span",{className:"text-xs bg-slate-700 px-1.5 py-0.5 rounded text-slate-300 truncate max-w-[200px]",children:y}),v<c.redirects.length-1&&t.jsx("span",{className:"text-slate-500",children:""})]},v))})]}),((f=c.indicators)==null?void 0:f.length)>0&&t.jsxs("div",{className:"col-span-2",children:[t.jsx("span",{className:"text-slate-500",children:"Behavioral Indicators:"}),t.jsx("ul",{className:"mt-1 space-y-1",children:c.indicators.slice(0,5).map((y,v)=>t.jsxs("li",{className:"text-xs text-orange-300 flex items-start gap-1",children:[t.jsx(ae,{className:"w-3 h-3 mt-0.5 flex-shrink-0"}),y]},v))})]})]}),t.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-slate-700",children:[c.screenshot_url&&t.jsx("a",{href:c.screenshot_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center gap-1 px-2 py-1 bg-slate-700 hover:bg-slate-600 rounded text-slate-300",children:" Screenshot"}),c.report_url&&t.jsxs("a",{href:c.report_url,target:"_blank",rel:"noopener noreferrer",className:"text-xs flex items-center gap-1 px-2 py-1 bg-blue-500/20 hover:bg-blue-500/30 rounded text-blue-300",children:[t.jsx(Ye,{className:"w-3 h-3"}),"Full Report"]}),t.jsxs("span",{className:"text-xs text-slate-500 ml-auto",children:["Analysis time: ",c.analysis_time_ms,"ms"]})]})]},u)})})]}),n.mitre_techniques.length>0&&t.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[t.jsxs("h3",{className:"text-sm font-semibold text-slate-300 mb-3 flex items-center gap-2",children:[t.jsx(Ot,{className:"w-4 h-4 text-purple-400"}),"MITRE ATT&CK Techniques"]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:n.mitre_techniques.map((c,u)=>t.jsxs("a",{href:`https://attack.mitre.org/techniques/${c.id}/`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1.5 bg-purple-500/20 text-purple-300 rounded-lg text-sm hover:bg-purple-500/30 transition",children:[t.jsx("span",{className:"font-mono",children:c.id}),t.jsx("span",{className:"text-slate-400",children:"|"}),t.jsx("span",{children:c.name}),t.jsx(Ye,{className:"w-3 h-3"})]},u))})]}),t.jsxs("div",{className:"bg-slate-800 rounded-xl border border-slate-700 overflow-hidden",children:[t.jsxs("button",{onClick:()=>i("recommendations"),className:"w-full p-4 flex items-center justify-between hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{className:"w-5 h-5 text-green-400"}),t.jsx("h3",{className:"font-semibold",children:"Recommendations"}),t.jsx("span",{className:"text-xs bg-green-500/20 text-green-300 px-2 py-0.5 rounded",children:n.recommendations.length||(n.is_threat?3:1)})]}),a.recommendations?t.jsx(Er,{className:"w-4 h-4"}):t.jsx(Qt,{className:"w-4 h-4"})]}),a.recommendations&&t.jsx("div",{className:"p-4 pt-0",children:t.jsx("ul",{className:"space-y-2",children:n.recommendations.length>0?n.recommendations.map((c,u)=>t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx("span",{className:"text-green-400 mt-0.5",children:""}),c]},u)):n.is_threat?t.jsxs(t.Fragment,{children:[t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx("span",{className:"text-red-400 mt-0.5",children:""}),"DO NOT click any links in this message"]}),t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx("span",{className:"text-red-400 mt-0.5",children:""}),"DO NOT provide any personal information"]}),t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx("span",{className:"text-orange-400 mt-0.5",children:""}),"Block and report the sender"]})]}):t.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-300",children:[t.jsx("span",{className:"text-green-400 mt-0.5",children:""}),"No immediate action required, but remain cautious"]})})})]}),t.jsxs("div",{className:"text-xs text-slate-500 text-center",children:["Analysis ID: ",n.analysis_id," | Analyzed: ",new Date(n.analyzed_at).toLocaleString()]})]})},vj=({steps:e,isComplete:s,currentStep:r,analysisType:n="email"})=>{const[a,l]=k.useState(new Set),i=()=>{switch(n){case"url":return s?"URL analysis complete":"Analyzing URL...";case"sms":return s?"SMS analysis complete":"Analyzing SMS/Message...";default:return s?"Email analysis complete":"Analyzing email..."}},o=u=>{const h=new Set(a);h.has(u)?h.delete(u):h.add(u),l(h)},d=u=>{switch(u){case"success":return t.jsx(Ce,{className:"w-5 h-5 text-green-500"});case"error":return t.jsx(at,{className:"w-5 h-5 text-red-500"});case"warning":return t.jsx(ae,{className:"w-5 h-5 text-yellow-500"});case"running":return t.jsx(Np,{className:"w-5 h-5 text-indigo-500 animate-spin"});default:return t.jsx("div",{className:"w-5 h-5 rounded-full border-2 border-gray-300"})}},c=u=>{switch(u){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"warning":return"border-yellow-200 bg-yellow-50";case"running":return"border-indigo-200 bg-indigo-50";default:return"border-gray-200 bg-gray-50"}};return t.jsxs("div",{className:"bg-white rounded-lg border shadow-sm",children:[t.jsxs("div",{className:"p-4 border-b bg-gray-50",children:[t.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[t.jsx(Br,{className:"w-5 h-5 text-indigo-600"}),"Analysis Progress"]}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:i()})]}),t.jsx("div",{className:"p-4 space-y-2",children:e.map((u,h)=>t.jsxs("div",{className:`rounded-lg border transition-all ${c(u.status)}`,children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 cursor-pointer",onClick:()=>u.findings&&u.findings.length>0&&o(u.id),children:[d(u.status),t.jsx("div",{className:"text-gray-600",children:u.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"font-medium text-gray-900",children:u.name}),u.status==="running"&&t.jsx("span",{className:"text-xs text-indigo-600 animate-pulse",children:"Processing..."})]}),t.jsx("p",{className:"text-xs text-gray-500",children:u.description})]}),u.duration!==void 0&&t.jsxs("span",{className:"text-xs text-gray-400 flex items-center gap-1",children:[t.jsx(os,{className:"w-3 h-3"}),u.duration,"ms"]}),u.findings&&u.findings.length>0&&t.jsx("div",{className:"text-gray-400",children:a.has(u.id)?t.jsx(Qt,{className:"w-4 h-4"}):t.jsx(Fr,{className:"w-4 h-4"})})]}),a.has(u.id)&&u.findings&&t.jsx("div",{className:"px-3 pb-3",children:t.jsx("div",{className:"ml-8 p-2 bg-white rounded border text-sm",children:t.jsx("ul",{className:"space-y-1",children:u.findings.map((b,w)=>t.jsxs("li",{className:"flex items-start gap-2 text-gray-700",children:[t.jsx("span",{className:"text-gray-400",children:""}),b]},w))})})})]},u.id))}),t.jsxs("div",{className:"p-4 border-t",children:[t.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600 mb-2",children:[t.jsx("span",{children:"Overall Progress"}),t.jsxs("span",{children:[e.filter(u=>u.status==="success"||u.status==="warning").length,"/",e.length," steps"]})]}),t.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 transition-all duration-500",style:{width:`${e.filter(u=>u.status==="success"||u.status==="warning"||u.status==="error").length/e.length*100}%`}})})]})]})},tl=()=>[{id:"parse",name:"Parse Email",description:"Extract headers, body, and metadata",status:"pending",icon:t.jsx(Ut,{className:"w-4 h-4"})},{id:"urls",name:"Extract URLs",description:"Find and analyze embedded links",status:"pending",icon:t.jsx(jt,{className:"w-4 h-4"})},{id:"attachments",name:"Process Attachments",description:"Analyze file types and calculate hashes",status:"pending",icon:t.jsx(hr,{className:"w-4 h-4"})},{id:"auth",name:"Check Authentication",description:"Verify SPF, DKIM, and DMARC",status:"pending",icon:t.jsx(fs,{className:"w-4 h-4"})},{id:"enrichment",name:"Threat Intelligence",description:"Query external threat feeds",status:"pending",icon:t.jsx(Ze,{className:"w-4 h-4"})},{id:"geoip",name:"GeoIP Lookup",description:"Determine sender location",status:"pending",icon:t.jsx(Ke,{className:"w-4 h-4"})},{id:"detection",name:"Run Detection Rules",description:"Check against 51+ detection rules",status:"pending",icon:t.jsx(oe,{className:"w-4 h-4"})},{id:"scoring",name:"Calculate Risk Score",description:"Compute overall threat level",status:"pending",icon:t.jsx(Ot,{className:"w-4 h-4"})},{id:"ai",name:"AI Analysis",description:"Generate insights and recommendations",status:"pending",icon:t.jsx(nt,{className:"w-4 h-4"})},{id:"report",name:"Generate Report",description:"Compile final analysis results",status:"pending",icon:t.jsx(et,{className:"w-4 h-4"})}],Y0=(e="url")=>[{id:"parse",name:e==="url"?"Parse URL":"Parse Message",description:e==="url"?"Extract URL components and domain":"Extract URLs and text patterns",status:"pending",icon:e==="url"?t.jsx(jt,{className:"w-4 h-4"}):t.jsx(Xt,{className:"w-4 h-4"})},{id:"patterns",name:"Pattern Detection",description:"Detect smishing, phishing, and scam patterns",status:"pending",icon:t.jsx(oe,{className:"w-4 h-4"})},{id:"enrichment",name:"URL Threat Intelligence",description:"Check URLhaus, PhishTank, VirusTotal",status:"pending",icon:t.jsx(Ze,{className:"w-4 h-4"})},{id:"sandbox",name:"URL Sandbox Analysis",description:"Dynamic analysis via URLScan.io",status:"pending",icon:t.jsx(Ke,{className:"w-4 h-4"})},{id:"scoring",name:"Calculate Risk Score",description:"Compute overall threat level",status:"pending",icon:t.jsx(Ot,{className:"w-4 h-4"})},{id:"ai",name:"AI Analysis",description:"Generate threat assessment",status:"pending",icon:t.jsx(nt,{className:"w-4 h-4"})},{id:"report",name:"Generate Report",description:"Compile analysis results",status:"pending",icon:t.jsx(et,{className:"w-4 h-4"})}],Nj=({result:e,onExport:s,onViewFullAnalysis:r})=>{var be,ue,se,ke,_,I,E,F,J,R,A,D,q;const[n,a]=k.useState(new Set(["ai","detection","auth"])),[l,i]=k.useState(null);if(!e)return t.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-8 text-center",children:[t.jsx(oe,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("div",{className:"text-gray-400",children:"No analysis result available"})]});const o=T=>{const Y=new Set(n);Y.has(T)?Y.delete(T):Y.add(T),a(Y)},d=(T,Y)=>{navigator.clipboard.writeText(T),i(Y),setTimeout(()=>i(null),2e3)},c=T=>typeof T=="number"?T:T&&typeof T=="object"&&"overall_score"in T?T.overall_score:0,u=c((be=e==null?void 0:e.detection)==null?void 0:be.risk_score)||c(e==null?void 0:e.risk_score)||0,h=String(((ue=e==null?void 0:e.detection)==null?void 0:ue.risk_level)||(e==null?void 0:e.risk_level)||"unknown").toLowerCase(),w=((T,Y)=>{const ve=T==null?void 0:T.toLowerCase();return ve==="critical"||ve==="high"||Y>=60?"malicious":ve==="medium"||Y>=30?"suspicious":ve==="low"||ve==="minimal"||Y<30?"clean":"unknown"})(h,u),f=((se=e==null?void 0:e.detection)==null?void 0:se.rules_triggered)||(e==null?void 0:e.rules_triggered)||[],y=(e==null?void 0:e.email)||(e==null?void 0:e.parsed_email)||{},v=(y==null?void 0:y.urls)||(e==null?void 0:e.urls)||(e==null?void 0:e.extracted_urls)||[],g=(y==null?void 0:y.attachments)||(e==null?void 0:e.attachments)||[],p={spf:(y==null?void 0:y.spf_result)||((ke=y==null?void 0:y.header_analysis)==null?void 0:ke.spf_result),dkim:(y==null?void 0:y.dkim_result)||((_=y==null?void 0:y.header_analysis)==null?void 0:_.dkim_result),dmarc:(y==null?void 0:y.dmarc_result)||((I=y==null?void 0:y.header_analysis)==null?void 0:I.dmarc_result)},x=(e==null?void 0:e.ai_triage)||(e==null?void 0:e.ai_analysis)||(e==null?void 0:e.ai_summary)||null,N=(e==null?void 0:e.iocs)||{domains:[],ips:[],urls:[],hashes:[]},j=T=>{switch(T){case"malicious":return{bg:"bg-red-600",ring:"ring-red-500/30",text:"text-red-400"};case"suspicious":return{bg:"bg-orange-600",ring:"ring-orange-500/30",text:"text-orange-400"};case"clean":return{bg:"bg-green-600",ring:"ring-green-500/30",text:"text-green-400"};default:return{bg:"bg-gray-600",ring:"ring-gray-500/30",text:"text-gray-400"}}},S=T=>T>=70?"border-red-500":T>=40?"border-orange-500":T>=20?"border-yellow-500":"border-green-500",C=T=>{switch(T==null?void 0:T.toLowerCase()){case"critical":return"bg-red-900/50 text-red-400 border-red-700/50";case"high":return"bg-orange-900/50 text-orange-400 border-orange-700/50";case"medium":return"bg-yellow-900/50 text-yellow-400 border-yellow-700/50";case"low":return"bg-blue-900/50 text-blue-400 border-blue-700/50";default:return"bg-gray-800 text-gray-400 border-gray-700"}},P=T=>T?typeof T=="string"?T:typeof T=="object"?T.result||T.status||T.verdict||"":String(T):"",$=T=>{switch(P(T).toLowerCase()){case"pass":return t.jsx(Ce,{className:"w-4 h-4 text-green-400"});case"fail":return t.jsx(at,{className:"w-4 h-4 text-red-400"});case"softfail":return t.jsx(Cy,{className:"w-4 h-4 text-yellow-400"});default:return t.jsx(ae,{className:"w-4 h-4 text-gray-500"})}},z=T=>{switch(P(T).toLowerCase()){case"pass":return"text-green-400";case"fail":return"text-red-400";case"softfail":return"text-yellow-400";default:return"text-gray-500"}},B=T=>P(T)||"N/A",de=j(w),xe=({id:T,title:Y,icon:ve,children:Le,badge:ut})=>{const he=n.has(T);return t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden bg-gray-800/50",children:[t.jsxs("button",{onClick:()=>o(T),className:"w-full flex items-center justify-between p-3 hover:bg-gray-800 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[ve,t.jsx("span",{className:"font-medium text-gray-200 text-sm",children:Y}),ut]}),he?t.jsx(Qt,{className:"w-4 h-4 text-gray-500"}):t.jsx(Fr,{className:"w-4 h-4 text-gray-500"})]}),he&&t.jsx("div",{className:"border-t border-gray-700 p-3",children:Le})]})};try{return t.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 overflow-hidden",children:[t.jsx("div",{className:"p-4 border-b border-gray-700 bg-gray-800/50",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:`relative w-16 h-16 rounded-full border-4 ${S(u)} flex items-center justify-center bg-gray-900`,children:t.jsxs("div",{className:"text-center",children:[t.jsx("span",{className:"text-2xl font-bold text-gray-100",children:u}),t.jsx("div",{className:"text-[10px] text-gray-500 uppercase tracking-wide",children:"Risk"})]})}),t.jsxs("div",{className:"space-y-1",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2.5 py-1 rounded text-xs font-bold text-white ${de.bg}`,children:(w||"unknown").toUpperCase()}),t.jsx("span",{className:"text-xs text-gray-400 bg-gray-800 px-2 py-1 rounded border border-gray-700",children:h})]}),t.jsx("h3",{className:"font-semibold text-gray-100 text-sm truncate max-w-[280px]",children:y.subject||"(No Subject)"}),t.jsxs("p",{className:"text-xs text-gray-500",children:["From: ",((E=y.sender)==null?void 0:E.email)||y.sender||"Unknown"]})]})]}),t.jsxs("button",{onClick:r,className:"flex items-center gap-2 px-4 py-2 text-sm bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors font-medium",children:[t.jsx(kn,{className:"w-4 h-4"}),"Full Analysis"]})]})}),t.jsxs("div",{className:"grid grid-cols-4 gap-2 md:gap-3 p-3 md:p-4 bg-gray-900 border-b border-gray-700",children:[t.jsxs("div",{className:"text-center p-2 md:p-3 bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"text-lg md:text-xl font-bold text-indigo-400",children:f.length}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-500 uppercase tracking-wide",children:"Rules"})]}),t.jsxs("div",{className:"text-center p-2 md:p-3 bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"text-lg md:text-xl font-bold text-purple-400",children:v.length}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-500 uppercase tracking-wide",children:"URLs"})]}),t.jsxs("div",{className:"text-center p-2 md:p-3 bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"text-lg md:text-xl font-bold text-blue-400",children:g.length}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-500 uppercase tracking-wide",children:"Files"})]}),t.jsxs("div",{className:"text-center p-2 md:p-3 bg-gray-800 rounded-lg border border-gray-700",children:[t.jsx("div",{className:"text-lg md:text-xl font-bold text-orange-400",children:(((F=N.domains)==null?void 0:F.length)||0)+(((J=N.ips)==null?void 0:J.length)||0)+(((R=N.hashes)==null?void 0:R.length)||0)}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-500 uppercase tracking-wide",children:"IOCs"})]})]}),t.jsxs("div",{className:"p-3 md:p-4 space-y-3 max-h-[400px] md:max-h-[500px] overflow-auto",children:[x&&t.jsx(xe,{id:"ai",title:"AI Analysis",icon:t.jsx(nt,{className:"w-4 h-4 text-purple-400"}),badge:t.jsx("span",{className:"text-[10px] bg-purple-900/50 text-purple-400 px-2 py-0.5 rounded border border-purple-700/50",children:x.provider||"AI"}),children:t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:t.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:x.summary||x.executive_summary||"No summary available"})}),x.key_findings&&x.key_findings.length>0&&t.jsxs("div",{children:[t.jsxs("h5",{className:"text-xs font-semibold text-gray-400 mb-2 flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3 text-orange-400"}),"Key Findings"]}),t.jsx("ul",{className:"space-y-1.5",children:x.key_findings.slice(0,3).map((T,Y)=>t.jsxs("li",{className:"text-xs text-gray-400 flex items-start gap-2",children:[t.jsx("span",{className:"text-orange-400 mt-0.5",children:""}),t.jsx("span",{children:T})]},Y))})]}),x.recommendations&&x.recommendations.length>0&&t.jsxs("div",{children:[t.jsxs("h5",{className:"text-xs font-semibold text-gray-400 mb-2 flex items-center gap-1",children:[t.jsx(ky,{className:"w-3 h-3 text-yellow-400"}),"Recommendations"]}),t.jsx("ul",{className:"space-y-1.5",children:x.recommendations.slice(0,3).map((T,Y)=>t.jsxs("li",{className:"text-xs text-gray-400 flex items-start gap-2",children:[t.jsx(Ce,{className:"w-3 h-3 text-green-400 mt-0.5 flex-shrink-0"}),t.jsx("span",{children:T})]},Y))})]}),x.mitre_techniques&&x.mitre_techniques.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.mitre_techniques.map((T,Y)=>t.jsx("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-2 py-0.5 rounded border border-red-700/50",children:T.id||T},Y))})]})}),t.jsx(xe,{id:"detection",title:"Detection Rules Triggered",icon:t.jsx(oe,{className:"w-4 h-4 text-red-400"}),badge:f.length>0&&t.jsx("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-2 py-0.5 rounded border border-red-700/50",children:f.length}),children:f.length===0?t.jsxs("div",{className:"text-center py-4 text-gray-500 text-sm",children:[t.jsx(Ce,{className:"w-8 h-8 mx-auto mb-2 text-green-500 opacity-50"}),"No detection rules triggered"]}):t.jsxs("div",{className:"space-y-2",children:[f.slice(0,5).map((T,Y)=>t.jsx("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:t.jsx("div",{className:"flex items-start justify-between gap-2",children:t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("div",{className:"flex items-center gap-2 mb-1",children:t.jsx("span",{className:`px-2 py-0.5 text-[10px] font-medium rounded border ${C(T.severity)}`,children:(T.severity||"unknown").toUpperCase()})}),t.jsx("p",{className:"text-sm text-gray-300",children:T.description||T.rule_name||T.name})]})})},Y)),f.length>5&&t.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["+",f.length-5," more rules"]})]})}),t.jsx(xe,{id:"auth",title:"Email Authentication",icon:t.jsx(fs,{className:"w-4 h-4 text-blue-400"}),children:t.jsx("div",{className:"grid grid-cols-3 gap-3",children:["spf","dkim","dmarc"].map(T=>{const Y=p[T];return t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700 text-center",children:[t.jsx("div",{className:"flex justify-center mb-2",children:$(Y)}),t.jsx("div",{className:"text-xs font-bold text-gray-300 uppercase mb-1",children:T}),t.jsx("div",{className:`text-xs font-medium ${z(Y)}`,children:B(Y)})]},T)})})}),v.length>0&&t.jsx(xe,{id:"urls",title:"URLs",icon:t.jsx(jt,{className:"w-4 h-4 text-purple-400"}),badge:t.jsx("span",{className:"text-[10px] bg-purple-900/50 text-purple-400 px-2 py-0.5 rounded border border-purple-700/50",children:v.length}),children:t.jsxs("div",{className:"space-y-2",children:[v.slice(0,5).map((T,Y)=>{const ve=typeof T=="string"?T:(T==null?void 0:T.url)||"";return t.jsxs("div",{className:"flex items-center justify-between bg-gray-900 rounded p-2 border border-gray-700",children:[t.jsx("code",{className:"text-xs text-gray-400 truncate flex-1 mr-2",children:ve}),t.jsx("button",{onClick:()=>d(ve,`url-${Y}`),className:"text-gray-500 hover:text-gray-300 flex-shrink-0",children:t.jsx(De,{className:"w-3.5 h-3.5"})})]},Y)}),v.length>5&&t.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["+",v.length-5," more URLs"]})]})}),g.length>0&&t.jsx(xe,{id:"attachments",title:"Attachments",icon:t.jsx(hr,{className:"w-4 h-4 text-blue-400"}),badge:t.jsx("span",{className:"text-[10px] bg-blue-900/50 text-blue-400 px-2 py-0.5 rounded border border-blue-700/50",children:g.length}),children:t.jsx("div",{className:"space-y-3",children:g.map((T,Y)=>{var Ge,Q,H,ge,O,Z,re;const ve=((Ge=T.threat_level)==null?void 0:Ge.toLowerCase())||"unknown",Le=T.threat_score||0,he=((V,ee)=>V==="critical"||ee>=70?{bg:"bg-red-900/30",border:"border-red-700/50",badge:"bg-red-600",text:"text-red-400"}:V==="high"||ee>=50?{bg:"bg-orange-900/30",border:"border-orange-700/50",badge:"bg-orange-600",text:"text-orange-400"}:V==="medium"||ee>=25?{bg:"bg-yellow-900/30",border:"border-yellow-700/50",badge:"bg-yellow-600",text:"text-yellow-400"}:V==="low"||ee>0?{bg:"bg-blue-900/30",border:"border-blue-700/50",badge:"bg-blue-600",text:"text-blue-400"}:{bg:"bg-gray-900",border:"border-gray-700",badge:"bg-green-600",text:"text-green-400"})(ve,Le);return t.jsxs("div",{className:`${he.bg} rounded-lg p-3 border ${he.border}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[t.jsx(et,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-gray-300 truncate",children:T.filename||T.name})]}),Le>0&&t.jsxs("div",{className:`flex items-center gap-1 px-2 py-0.5 rounded ${he.badge}`,children:[t.jsx(oe,{className:"w-3 h-3 text-white"}),t.jsxs("span",{className:"text-[10px] text-white font-bold",children:[Le,"/100"]})]})]}),t.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex items-center gap-2 flex-wrap",children:[t.jsx("span",{children:T.content_type}),t.jsx("span",{children:""}),t.jsxs("span",{children:[((T.size_bytes||T.size||0)/1024).toFixed(1)," KB"]}),T.entropy&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:""}),t.jsxs("span",{children:["Entropy: ",T.entropy.toFixed(2)]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-1.5 mt-2",children:[T.is_executable&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"EXECUTABLE"]}),(T.has_macros||T.is_office_with_macros)&&t.jsxs("span",{className:"text-[10px] bg-orange-900/50 text-orange-400 px-1.5 py-0.5 rounded border border-orange-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"MACROS"]}),T.has_auto_exec_macros&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(at,{className:"w-2.5 h-2.5"}),"AUTO-EXEC"]}),T.has_dde&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"DDE"]}),T.has_ole_objects&&t.jsxs("span",{className:"text-[10px] bg-yellow-900/50 text-yellow-400 px-1.5 py-0.5 rounded border border-yellow-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"OLE"]}),T.has_javascript&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"JS"]}),T.has_embedded_files&&t.jsxs("span",{className:"text-[10px] bg-yellow-900/50 text-yellow-400 px-1.5 py-0.5 rounded border border-yellow-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"EMBEDDED"]}),T.is_packed&&t.jsxs("span",{className:"text-[10px] bg-purple-900/50 text-purple-400 px-1.5 py-0.5 rounded border border-purple-700/50 flex items-center gap-1",children:[t.jsx(Yo,{className:"w-2.5 h-2.5"}),"PACKED"]}),T.has_suspicious_imports&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(ae,{className:"w-2.5 h-2.5"}),"SUS IMPORTS"]}),T.type_mismatch&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(at,{className:"w-2.5 h-2.5"}),"TYPE MISMATCH"]}),T.has_double_extension&&t.jsxs("span",{className:"text-[10px] bg-red-900/50 text-red-400 px-1.5 py-0.5 rounded border border-red-700/50 flex items-center gap-1",children:[t.jsx(at,{className:"w-2.5 h-2.5"}),"DOUBLE EXT"]}),T.is_archive&&t.jsx("span",{className:"text-[10px] bg-blue-900/50 text-blue-400 px-1.5 py-0.5 rounded border border-blue-700/50",children:"ARCHIVE"}),T.is_script&&t.jsx("span",{className:"text-[10px] bg-yellow-900/50 text-yellow-400 px-1.5 py-0.5 rounded border border-yellow-700/50",children:"SCRIPT"}),ve==="clean"&&Le===0&&t.jsxs("span",{className:"text-[10px] bg-green-900/50 text-green-400 px-1.5 py-0.5 rounded border border-green-700/50 flex items-center gap-1",children:[t.jsx(Ce,{className:"w-2.5 h-2.5"}),"CLEAN"]})]}),T.threat_summary&&Le>0&&t.jsx("div",{className:`mt-2 text-xs ${he.text} bg-gray-900/50 rounded p-2`,children:T.threat_summary}),(((Q=T.extracted_urls)==null?void 0:Q.length)>0||((H=T.extracted_ips)==null?void 0:H.length)>0||((ge=T.suspicious_strings)==null?void 0:ge.length)>0)&&t.jsxs("div",{className:"mt-2 border-t border-gray-700/50 pt-2",children:[t.jsx("div",{className:"text-[10px] text-gray-500 mb-1 font-medium",children:"EXTRACTED FROM FILE:"}),t.jsxs("div",{className:"flex flex-wrap gap-1",children:[(O=T.extracted_urls)==null?void 0:O.slice(0,3).map((V,ee)=>t.jsxs("span",{className:"text-[10px] bg-purple-900/30 text-purple-400 px-1.5 py-0.5 rounded border border-purple-700/30 max-w-[200px] truncate",children:[" ",V]},`url-${ee}`)),(Z=T.extracted_ips)==null?void 0:Z.slice(0,3).map((V,ee)=>t.jsxs("span",{className:"text-[10px] bg-blue-900/30 text-blue-400 px-1.5 py-0.5 rounded border border-blue-700/30",children:[" ",V]},`ip-${ee}`)),(re=T.suspicious_strings)==null?void 0:re.slice(0,3).map((V,ee)=>t.jsxs("span",{className:"text-[10px] bg-red-900/30 text-red-400 px-1.5 py-0.5 rounded border border-red-700/30 max-w-[150px] truncate",children:[" ",V]},`sus-${ee}`))]})]}),t.jsx("div",{className:"mt-2 flex items-center gap-2 text-[10px] text-gray-600",children:t.jsxs("button",{onClick:()=>d(T.sha256||"",`sha256-${Y}`),className:"flex items-center gap-1 hover:text-gray-400 transition-colors",title:"Copy SHA256",children:[t.jsx(Ql,{className:"w-3 h-3"}),t.jsxs("span",{className:"font-mono",children:[(T.sha256||"").slice(0,16),"..."]}),t.jsx(De,{className:"w-2.5 h-2.5"})]})})]},Y)})})}),(((A=N.domains)==null?void 0:A.length)||0)+(((D=N.ips)==null?void 0:D.length)||0)+(((q=N.hashes)==null?void 0:q.length)||0)>0&&t.jsx(xe,{id:"iocs",title:"Indicators of Compromise",icon:t.jsx(Ot,{className:"w-4 h-4 text-orange-400"}),children:t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[N.domains&&N.domains.length>0&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsxs("div",{className:"font-medium text-gray-300 mb-2 text-xs flex items-center gap-1.5",children:[t.jsx(Ke,{className:"w-3.5 h-3.5 text-blue-400"}),"Domains (",N.domains.length,")"]}),t.jsx("div",{className:"space-y-1 max-h-24 overflow-auto",children:N.domains.slice(0,5).map((T,Y)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("code",{className:"text-[11px] text-gray-400",children:T}),t.jsx("button",{onClick:()=>d(T,`domain-${Y}`),className:"text-gray-600 hover:text-gray-400",children:t.jsx(De,{className:"w-3 h-3"})})]},Y))})]}),N.ips&&N.ips.length>0&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700",children:[t.jsxs("div",{className:"font-medium text-gray-300 mb-2 text-xs flex items-center gap-1.5",children:[t.jsx(vt,{className:"w-3.5 h-3.5 text-green-400"}),"IPs (",N.ips.length,")"]}),t.jsx("div",{className:"space-y-1 max-h-24 overflow-auto",children:N.ips.slice(0,5).map((T,Y)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("code",{className:"text-[11px] text-gray-400",children:T}),t.jsx("button",{onClick:()=>d(T,`ip-${Y}`),className:"text-gray-600 hover:text-gray-400",children:t.jsx(De,{className:"w-3 h-3"})})]},Y))})]}),N.hashes&&N.hashes.length>0&&t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 border border-gray-700 col-span-2",children:[t.jsxs("div",{className:"font-medium text-gray-300 mb-2 text-xs flex items-center gap-1.5",children:[t.jsx(Ql,{className:"w-3.5 h-3.5 text-purple-400"}),"File Hashes (",N.hashes.length,")"]}),t.jsx("div",{className:"space-y-1 max-h-24 overflow-auto",children:N.hashes.slice(0,3).map((T,Y)=>t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsxs("span",{className:"text-[10px] text-gray-500",children:[T.type||"SHA256",":"]}),t.jsxs("code",{className:"text-[11px] text-gray-400 ml-1",children:[(T.value||T).slice(0,24),"..."]})]}),t.jsx("button",{onClick:()=>d(T.value||T,`hash-${Y}`),className:"text-gray-600 hover:text-gray-400",children:t.jsx(De,{className:"w-3 h-3"})})]},Y))})]})]})})]}),t.jsx("div",{className:"p-4 border-t border-gray-700 bg-gray-800/50",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs text-gray-500",children:"Export Analysis"}),t.jsx("div",{className:"flex gap-2",children:["JSON","PDF","MARKDOWN","CSV","STIX"].map(T=>t.jsx("button",{onClick:()=>s(T.toLowerCase()),className:"px-3 py-1.5 text-xs bg-gray-700 hover:bg-gray-600 text-gray-300 rounded-lg transition-colors font-medium border border-gray-600",children:T},T))})]})}),l&&t.jsx("div",{className:"fixed bottom-4 right-4 bg-gray-800 text-gray-200 px-4 py-2 rounded-lg text-sm shadow-lg border border-gray-700 z-50",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ce,{className:"w-4 h-4 text-green-400"}),"Copied to clipboard!"]})})]})}catch(T){return console.error("ResultsPanel render error:",T),t.jsxs("div",{className:"bg-red-900/30 border border-red-700 rounded-xl p-6",children:[t.jsx("h3",{className:"text-red-400 font-semibold mb-2",children:"Error Rendering Results"}),t.jsx("p",{className:"text-sm text-red-300",children:String(T)})]})}};function wj({isOpen:e,onClose:s,onSettingsChange:r}){var D,q,T,Y,ve,Le,ut,he,Ge,Q,H,ge;const[n,a]=k.useState("threat-intel"),[l,i]=k.useState(!0),[o,d]=k.useState(!1),[c,u]=k.useState(null),[h,b]=k.useState(null),[w,f]=k.useState({}),[y,v]=k.useState({}),[g,p]=k.useState(null),[x,N]=k.useState({}),[j,S]=k.useState(!0),[C,P]=k.useState(!1),[$,z]=k.useState("openai"),[B,de]=k.useState(""),[xe,be]=k.useState("");k.useEffect(()=>{e&&(ue(),se())},[e]);const ue=async()=>{try{i(!0);const Z=(await Ie.get("/settings")).data;u(Z),S(Z.enrichment_enabled),P(Z.ai_enabled),z(Z.ai_provider||"openai"),r==null||r(Z)}catch(O){console.error("Failed to load settings:",O),qt.error("Failed to load settings")}finally{i(!1)}},se=async()=>{try{const O=await Ie.get("/settings/detection-config");b(O.data)}catch(O){console.error("Failed to load detection config:",O)}},ke=async()=>{var O,Z;try{d(!0);const re={enable_enrichment:j,enable_ai:C,ai_provider:$},V={};Object.entries(w).forEach(([ee,Ae])=>{Ae&&Ae.trim()&&(V[ee]=Ae.trim())}),Object.keys(V).length>0&&(re.api_keys=V),await Ie.patch("/settings",re),qt.success("Settings saved successfully"),f({}),await ue()}catch(re){console.error("Failed to save settings:",re),qt.error(((Z=(O=re==null?void 0:re.response)==null?void 0:O.data)==null?void 0:Z.detail)||"Failed to save settings")}finally{d(!1)}},_=async O=>{try{p(O),N(V=>({...V,[O]:{success:!1}}));const re=(await Ie.post(`/settings/test-connection/${O}`)).data;N(V=>({...V,[O]:{success:re.success,message:re.message||re.error}})),re.success?qt.success(`${O} connection successful!`):qt.error(`${O} connection failed: ${re.error||"Unknown error"}`)}catch{N(re=>({...re,[O]:{success:!1,message:"Connection failed"}})),qt.error(`Failed to test ${O} connection`)}finally{p(null)}},I=O=>{v(Z=>({...Z,[O]:!Z[O]}))},E=(O,Z)=>{f(re=>({...re,[O]:Z}))},F=async()=>{if(B.trim())try{const Z=(await Ie.post(`/settings/detection-config/whitelist-domain?domain=${encodeURIComponent(B)}`)).data;Z.success?(qt.success(Z.message),de(""),se()):qt.error(Z.message)}catch{qt.error("Failed to add domain")}},J=async()=>{if(xe.trim())try{const Z=(await Ie.post(`/settings/detection-config/whitelist-sender?email=${encodeURIComponent(xe)}`)).data;Z.success?(qt.success(Z.message),be(""),se()):qt.error(Z.message)}catch{qt.error("Failed to add sender")}};if(!e)return null;const R=c?Object.values(c.api_keys_configured).filter(Boolean).length:0;return t.jsx("div",{className:"fixed inset-0 z-50 flex items-end md:items-center justify-center bg-black/70 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-slate-800 rounded-t-2xl md:rounded-xl shadow-2xl w-full md:max-w-4xl max-h-[95vh] md:max-h-[90vh] overflow-hidden border border-slate-700 animate-slide-up md:animate-fade-in",children:[t.jsxs("div",{className:"flex items-center justify-between px-4 md:px-6 py-3 md:py-4 border-b border-slate-700 bg-slate-900",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[t.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:t.jsx(jn,{className:"w-4 h-4 md:w-5 md:h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg md:text-xl font-semibold text-white",children:"Settings"}),t.jsxs("p",{className:"text-xs md:text-sm text-slate-400",children:[R,"/",6," services configured"]})]})]}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-slate-700 rounded-lg transition-colors",children:t.jsx(ws,{className:"w-5 h-5 text-slate-400"})})]}),t.jsxs("div",{className:"flex border-b border-slate-700 bg-slate-900/50 overflow-x-auto hide-scrollbar",children:[t.jsxs("button",{onClick:()=>a("threat-intel"),className:`flex items-center gap-1.5 md:gap-2 px-3 md:px-6 py-2.5 md:py-3 font-medium transition-colors whitespace-nowrap text-sm md:text-base ${n==="threat-intel"?"text-blue-400 border-b-2 border-blue-400 bg-slate-800/50":"text-slate-400 hover:text-slate-200"}`,children:[t.jsx(oe,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Threat"})," Intel"]}),t.jsxs("button",{onClick:()=>a("ai"),className:`flex items-center gap-1.5 md:gap-2 px-3 md:px-6 py-2.5 md:py-3 font-medium transition-colors whitespace-nowrap text-sm md:text-base ${n==="ai"?"text-purple-400 border-b-2 border-purple-400 bg-slate-800/50":"text-slate-400 hover:text-slate-200"}`,children:[t.jsx(nt,{className:"w-4 h-4"}),"AI"]}),t.jsxs("button",{onClick:()=>a("detection"),className:`flex items-center gap-1.5 md:gap-2 px-3 md:px-6 py-2.5 md:py-3 font-medium transition-colors whitespace-nowrap text-sm md:text-base ${n==="detection"?"text-green-400 border-b-2 border-green-400 bg-slate-800/50":"text-slate-400 hover:text-slate-200"}`,children:[t.jsx(gt,{className:"w-4 h-4"}),"Detection"]}),t.jsxs("button",{onClick:()=>a("advanced"),className:`flex items-center gap-1.5 md:gap-2 px-3 md:px-6 py-2.5 md:py-3 font-medium transition-colors whitespace-nowrap text-sm md:text-base ${n==="advanced"?"text-orange-400 border-b-2 border-orange-400 bg-slate-800/50":"text-slate-400 hover:text-slate-200"}`,children:[t.jsx(vt,{className:"w-4 h-4"}),"Advanced"]})]}),t.jsx("div",{className:"p-4 md:p-6 overflow-y-auto max-h-[65vh] md:max-h-[60vh]",children:l?t.jsx("div",{className:"flex items-center justify-center py-12",children:t.jsx(yr,{className:"w-8 h-8 animate-spin text-blue-500"})}):t.jsxs(t.Fragment,{children:[n==="threat-intel"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${j?"bg-green-500":"bg-slate-500"}`}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-white",children:"Enable Threat Intelligence"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Query external threat feeds during analysis"})]})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:j,onChange:O=>S(O.target.checked),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-slate-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),t.jsx(ps,{name:"VirusTotal",description:"Scan URLs, domains, and file hashes against VT database",keyName:"virustotal_api_key",value:w.virustotal_api_key||"",onChange:O=>E("virustotal_api_key",O),showKey:y.virustotal||!1,onToggleShow:()=>I("virustotal"),isConfigured:((D=c==null?void 0:c.api_keys_configured)==null?void 0:D.virustotal)||!1,onTest:()=>_("virustotal"),isTesting:g==="virustotal",testResult:x.virustotal,signupUrl:"https://www.virustotal.com/gui/join-us",icon:t.jsx(Ke,{className:"w-5 h-5 text-blue-400"}),rateLimit:"4 req/min (free tier)"}),t.jsx(ps,{name:"AbuseIPDB",description:"Check IP reputation and abuse reports",keyName:"abuseipdb_api_key",value:w.abuseipdb_api_key||"",onChange:O=>E("abuseipdb_api_key",O),showKey:y.abuseipdb||!1,onToggleShow:()=>I("abuseipdb"),isConfigured:((q=c==null?void 0:c.api_keys_configured)==null?void 0:q.abuseipdb)||!1,onTest:()=>_("abuseipdb"),isTesting:g==="abuseipdb",testResult:x.abuseipdb,signupUrl:"https://www.abuseipdb.com/register",icon:t.jsx(oe,{className:"w-5 h-5 text-orange-400"}),rateLimit:"1000 req/day (free tier)"}),t.jsx(ps,{name:"PhishTank",description:"Check URLs against known phishing database",keyName:"phishtank_api_key",value:w.phishtank_api_key||"",onChange:O=>E("phishtank_api_key",O),showKey:y.phishtank||!1,onToggleShow:()=>I("phishtank"),isConfigured:((T=c==null?void 0:c.api_keys_configured)==null?void 0:T.phishtank)||!1,onTest:()=>_("phishtank"),isTesting:g==="phishtank",testResult:x.phishtank,signupUrl:"https://phishtank.org/register.php",icon:t.jsx(bn,{className:"w-5 h-5 text-yellow-400"}),rateLimit:"Optional API key"}),t.jsx(ps,{name:"MXToolbox",description:"DNS, MX records, SPF/DKIM/DMARC validation, blacklist checks",keyName:"mxtoolbox_api_key",value:w.mxtoolbox_api_key||"",onChange:O=>E("mxtoolbox_api_key",O),showKey:y.mxtoolbox||!1,onToggleShow:()=>I("mxtoolbox"),isConfigured:((Y=c==null?void 0:c.api_keys_configured)==null?void 0:Y.mxtoolbox)||!1,onTest:()=>_("mxtoolbox"),isTesting:g==="mxtoolbox",testResult:x.mxtoolbox,signupUrl:"https://mxtoolbox.com/User/Api/",icon:t.jsx(vt,{className:"w-5 h-5 text-purple-400"}),rateLimit:"Varies by plan"}),t.jsx(ps,{name:"IPQualityScore",description:"Advanced URL scanning with phishing, malware detection, and domain age analysis",keyName:"ipqualityscore_api_key",value:w.ipqualityscore_api_key||"",onChange:O=>E("ipqualityscore_api_key",O),showKey:y.ipqualityscore||!1,onToggleShow:()=>I("ipqualityscore"),isConfigured:((ve=c==null?void 0:c.api_keys_configured)==null?void 0:ve.ipqualityscore)||!1,onTest:()=>_("ipqualityscore"),isTesting:g==="ipqualityscore",testResult:x.ipqualityscore,signupUrl:"https://www.ipqualityscore.com/create-account",icon:t.jsx(gt,{className:"w-5 h-5 text-cyan-400"}),rateLimit:"5000 req/month (free)"}),t.jsx(ps,{name:"Google Safe Browsing",description:"Check URLs against Google's constantly updated threat lists (malware, phishing, unwanted software)",keyName:"google_safebrowsing_api_key",value:w.google_safebrowsing_api_key||"",onChange:O=>E("google_safebrowsing_api_key",O),showKey:y.google_safebrowsing||!1,onToggleShow:()=>I("google_safebrowsing"),isConfigured:((Le=c==null?void 0:c.api_keys_configured)==null?void 0:Le.google_safebrowsing)||!1,onTest:()=>_("google_safebrowsing"),isTesting:g==="google_safebrowsing",testResult:x.google_safebrowsing,signupUrl:"https://console.cloud.google.com/apis/library/safebrowsing.googleapis.com",icon:t.jsx(oe,{className:"w-5 h-5 text-green-400"}),rateLimit:"10,000 req/day (free)"}),t.jsx(ps,{name:"Hybrid Analysis",description:"Dynamic malware sandbox for attachment analysis. Detects malware, MITRE ATT&CK techniques, network IOCs.",keyName:"hybrid_analysis_api_key",value:w.hybrid_analysis_api_key||"",onChange:O=>E("hybrid_analysis_api_key",O),showKey:y.hybrid_analysis||!1,onToggleShow:()=>I("hybrid_analysis"),isConfigured:((ut=c==null?void 0:c.api_keys_configured)==null?void 0:ut.hybrid_analysis)||!1,onTest:()=>_("hybrid_analysis"),isTesting:g==="hybrid_analysis",testResult:x.hybrid_analysis,signupUrl:"https://www.hybrid-analysis.com/apikeys/info",icon:t.jsx(oe,{className:"w-5 h-5 text-pink-400"}),rateLimit:"100 submissions/month (free)"}),t.jsx(ps,{name:"URLScan.io",description:"Live URL scanning and screenshot capture. Analyzes JavaScript, network requests, and page behavior.",keyName:"urlscan_api_key",value:w.urlscan_api_key||"",onChange:O=>E("urlscan_api_key",O),showKey:y.urlscan||!1,onToggleShow:()=>I("urlscan"),isConfigured:((he=c==null?void 0:c.api_keys_configured)==null?void 0:he.urlscan)||!1,onTest:()=>_("urlscan"),isTesting:g==="urlscan",testResult:x.urlscan,signupUrl:"https://urlscan.io/user/signup",icon:t.jsx(Ke,{className:"w-5 h-5 text-indigo-400"}),rateLimit:"1000 scans/day (free)"}),t.jsx("div",{className:"p-4 bg-blue-900/30 rounded-lg border border-blue-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Ts,{className:"w-5 h-5 text-blue-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-blue-200",children:[t.jsx("p",{className:"font-medium",children:"Free Tier APIs Available"}),t.jsx("p",{className:"text-blue-300/80",children:"VirusTotal, AbuseIPDB, PhishTank, IPQualityScore, Google Safe Browsing, and URLScan.io all offer free API access for personal/research use. Requests are automatically throttled to respect rate limits."})]})]})})]}),n==="ai"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`w-3 h-3 rounded-full ${C?"bg-purple-500":"bg-slate-500"}`}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-white",children:"Enable AI Analysis"}),t.jsx("p",{className:"text-sm text-slate-400",children:"Use AI to generate insights and recommendations"})]})]}),t.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:C,onChange:O=>P(O.target.checked),className:"sr-only peer"}),t.jsx("div",{className:"w-11 h-6 bg-slate-600 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-800 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-slate-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"})]})]}),t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsx("h3",{className:"font-medium text-white mb-3",children:"Preferred AI Provider"}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("label",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${$==="anthropic"?"border-orange-500 bg-orange-500/10":"border-slate-600 hover:border-slate-500 bg-slate-800/50"}`,children:[t.jsx("input",{type:"radio",name:"ai-provider",value:"anthropic",checked:$==="anthropic",onChange:()=>z("anthropic"),className:"sr-only"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-orange-900/50 rounded-lg flex items-center justify-center",children:t.jsx(nt,{className:"w-5 h-5 text-orange-400"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-white",children:"Anthropic Claude"}),t.jsx("div",{className:"text-sm text-slate-400",children:"claude-3-sonnet"})]}),((Ge=c==null?void 0:c.api_keys_configured)==null?void 0:Ge.anthropic)&&t.jsx(Ce,{className:"w-4 h-4 text-green-400 ml-auto"})]})]}),t.jsxs("label",{className:`p-4 border-2 rounded-lg cursor-pointer transition-all ${$==="openai"?"border-green-500 bg-green-500/10":"border-slate-600 hover:border-slate-500 bg-slate-800/50"}`,children:[t.jsx("input",{type:"radio",name:"ai-provider",value:"openai",checked:$==="openai",onChange:()=>z("openai"),className:"sr-only"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-green-900/50 rounded-lg flex items-center justify-center",children:t.jsx(gt,{className:"w-5 h-5 text-green-400"})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-white",children:"OpenAI"}),t.jsx("div",{className:"text-sm text-slate-400",children:"gpt-4-turbo"})]}),((Q=c==null?void 0:c.api_keys_configured)==null?void 0:Q.openai)&&t.jsx(Ce,{className:"w-4 h-4 text-green-400 ml-auto"})]})]})]})]}),t.jsx(ps,{name:"Anthropic",description:"Claude AI for threat analysis and recommendations",keyName:"anthropic_api_key",value:w.anthropic_api_key||"",onChange:O=>E("anthropic_api_key",O),showKey:y.anthropic||!1,onToggleShow:()=>I("anthropic"),isConfigured:((H=c==null?void 0:c.api_keys_configured)==null?void 0:H.anthropic)||!1,onTest:()=>_("anthropic"),isTesting:g==="anthropic",testResult:x.anthropic,signupUrl:"https://console.anthropic.com/",icon:t.jsx(nt,{className:"w-5 h-5 text-orange-400"}),rateLimit:"Pay per token"}),t.jsx(ps,{name:"OpenAI",description:"GPT-4 for threat analysis and recommendations",keyName:"openai_api_key",value:w.openai_api_key||"",onChange:O=>E("openai_api_key",O),showKey:y.openai||!1,onToggleShow:()=>I("openai"),isConfigured:((ge=c==null?void 0:c.api_keys_configured)==null?void 0:ge.openai)||!1,onTest:()=>_("openai"),isTesting:g==="openai",testResult:x.openai,signupUrl:"https://platform.openai.com/signup",icon:t.jsx(gt,{className:"w-5 h-5 text-green-400"}),rateLimit:"Pay per token"}),t.jsx("div",{className:"p-4 bg-purple-900/30 rounded-lg border border-purple-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(nt,{className:"w-5 h-5 text-purple-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-purple-200",children:[t.jsx("p",{className:"font-medium",children:"AI-Powered Analysis Features"}),t.jsx("p",{className:"text-purple-300/80",children:"When enabled, AI will analyze email content and provide threat assessment, key findings, social engineering detection, and MITRE ATT&CK technique mapping."})]})]})})]}),n==="detection"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"p-6 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[t.jsx("div",{className:"w-16 h-16 bg-green-900/50 rounded-xl flex items-center justify-center",children:t.jsx(gt,{className:"w-8 h-8 text-green-400"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-xl font-semibold text-white",children:"Detection Engine"}),t.jsx("p",{className:"text-slate-400",children:"Built-in rule-based threat detection"})]})]}),t.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[t.jsxs("div",{className:"p-4 bg-slate-800 rounded-lg border border-slate-700",children:[t.jsx("div",{className:"text-3xl font-bold text-green-400",children:(c==null?void 0:c.detection_rules_count)||51}),t.jsx("div",{className:"text-sm text-slate-400",children:"Detection Rules"})]}),t.jsxs("div",{className:"p-4 bg-slate-800 rounded-lg border border-slate-700",children:[t.jsx("div",{className:"text-3xl font-bold text-blue-400",children:"7"}),t.jsx("div",{className:"text-sm text-slate-400",children:"Categories"})]}),t.jsxs("div",{className:"p-4 bg-slate-800 rounded-lg border border-slate-700",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Sp,{className:"w-6 h-6 text-green-400"}),t.jsx("span",{className:"text-lg font-bold text-green-400",children:"Active"})]}),t.jsx("div",{className:"text-sm text-slate-400",children:"Engine Status"})]})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h4",{className:"font-medium text-white",children:"Rule Categories"}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{name:"Phishing Detection",count:12,bgColor:"bg-red-900/30",textColor:"text-red-400",borderColor:"border-red-800"},{name:"BEC Detection",count:8,bgColor:"bg-orange-900/30",textColor:"text-orange-400",borderColor:"border-orange-800"},{name:"Brand Impersonation",count:6,bgColor:"bg-yellow-900/30",textColor:"text-yellow-400",borderColor:"border-yellow-800"},{name:"Social Engineering",count:8,bgColor:"bg-purple-900/30",textColor:"text-purple-400",borderColor:"border-purple-800"},{name:"Malware Indicators",count:5,bgColor:"bg-pink-900/30",textColor:"text-pink-400",borderColor:"border-pink-800"},{name:"Authentication",count:6,bgColor:"bg-blue-900/30",textColor:"text-blue-400",borderColor:"border-blue-800"},{name:"Lookalike Domains",count:4,bgColor:"bg-cyan-900/30",textColor:"text-cyan-400",borderColor:"border-cyan-800"},{name:"IP Reputation",count:2,bgColor:"bg-green-900/30",textColor:"text-green-400",borderColor:"border-green-800"}].map(O=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsx("span",{className:"text-sm text-slate-300",children:O.name}),t.jsxs("span",{className:`px-2 py-1 text-xs font-medium rounded ${O.bgColor} ${O.textColor} border ${O.borderColor}`,children:[O.count," rules"]})]},O.name))})]}),t.jsx("div",{className:"p-4 bg-green-900/30 rounded-lg border border-green-700",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx(Ce,{className:"w-5 h-5 text-green-400 flex-shrink-0 mt-0.5"}),t.jsxs("div",{className:"text-sm text-green-200",children:[t.jsx("p",{className:"font-medium",children:"No API Key Required"}),t.jsx("p",{className:"text-green-300/80",children:"The detection engine runs locally and doesn't require any external API keys. All rules include MITRE ATT&CK mapping."})]})]})})]}),n==="advanced"&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("h4",{className:"font-medium text-white mb-3 flex items-center gap-2",children:[t.jsx(oe,{className:"w-4 h-4 text-green-400"}),"Whitelisted Domains"]}),t.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Domains in this list will not trigger detection rules."}),t.jsxs("div",{className:"flex gap-2 mb-3",children:[t.jsx("input",{type:"text",value:B,onChange:O=>de(O.target.value),placeholder:"example.com",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeyDown:O=>O.key==="Enter"&&F()}),t.jsx("button",{onClick:F,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition",children:"Add"})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:h!=null&&h.config.whitelisted_domains&&h.config.whitelisted_domains.length>0?h.config.whitelisted_domains.map((O,Z)=>t.jsx("span",{className:"px-2 py-1 bg-green-900/30 text-green-400 text-sm rounded border border-green-700 flex items-center gap-1",children:O},Z)):t.jsx("span",{className:"text-slate-500 text-sm",children:"No domains whitelisted"})})]}),t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("h4",{className:"font-medium text-white mb-3 flex items-center gap-2",children:[t.jsx(Ce,{className:"w-4 h-4 text-blue-400"}),"Whitelisted Senders"]}),t.jsx("p",{className:"text-sm text-slate-400 mb-3",children:"Emails from these senders will bypass detection."}),t.jsxs("div",{className:"flex gap-2 mb-3",children:[t.jsx("input",{type:"email",value:xe,onChange:O=>be(O.target.value),placeholder:"user@example.com",className:"flex-1 px-3 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",onKeyDown:O=>O.key==="Enter"&&J()}),t.jsx("button",{onClick:J,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition",children:"Add"})]}),t.jsx("div",{className:"flex flex-wrap gap-2",children:h!=null&&h.config.whitelisted_senders&&h.config.whitelisted_senders.length>0?h.config.whitelisted_senders.map((O,Z)=>t.jsx("span",{className:"px-2 py-1 bg-blue-900/30 text-blue-400 text-sm rounded border border-blue-700 flex items-center gap-1",children:O},Z)):t.jsx("span",{className:"text-slate-500 text-sm",children:"No senders whitelisted"})})]}),t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("h4",{className:"font-medium text-white mb-3 flex items-center gap-2",children:[t.jsx(ae,{className:"w-4 h-4 text-yellow-400"}),"Risk Thresholds"]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-slate-400",children:"High Risk Threshold"}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx("span",{className:"text-2xl font-bold text-yellow-400",children:(h==null?void 0:h.config.risk_threshold_high)||40}),t.jsx("span",{className:"text-slate-500",children:"/ 100"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-sm text-slate-400",children:"Critical Risk Threshold"}),t.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[t.jsx("span",{className:"text-2xl font-bold text-red-400",children:(h==null?void 0:h.config.risk_threshold_critical)||70}),t.jsx("span",{className:"text-slate-500",children:"/ 100"})]})]})]})]}),t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsx("h4",{className:"font-medium text-white mb-3",children:"Feature Toggles"}),t.jsx("div",{className:"space-y-3",children:[{name:"GeoIP Lookup",enabled:h==null?void 0:h.config.enable_geoip,desc:"Resolve IP locations"},{name:"WHOIS Lookup",enabled:h==null?void 0:h.config.enable_whois,desc:"Query domain registration"},{name:"AI Descriptions",enabled:h==null?void 0:h.config.enable_ai_description,desc:"Generate AI threat summaries"}].map(O=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-800 rounded-lg",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-white",children:O.name}),t.jsx("p",{className:"text-xs text-slate-500",children:O.desc})]}),t.jsx("div",{className:`px-2 py-1 text-xs rounded ${O.enabled?"bg-green-900/50 text-green-400":"bg-slate-700 text-slate-400"}`,children:O.enabled?"Enabled":"Disabled"})]},O.name))})]})]})]})}),t.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-t border-slate-700 bg-slate-900",children:[t.jsxs("button",{onClick:ue,className:"flex items-center gap-2 px-4 py-2 text-slate-400 hover:text-white transition-colors",children:[t.jsx(Ns,{className:"w-4 h-4"}),"Refresh"]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:s,className:"px-4 py-2 text-slate-400 hover:text-white transition-colors",children:"Cancel"}),t.jsxs("button",{onClick:ke,disabled:o,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[o?t.jsx(yr,{className:"w-4 h-4 animate-spin"}):t.jsx(wp,{className:"w-4 h-4"}),"Save Changes"]})]})]})]})})}function ps({name:e,description:s,value:r,onChange:n,showKey:a,onToggleShow:l,isConfigured:i,onTest:o,isTesting:d,testResult:c,signupUrl:u,icon:h,rateLimit:b}){return t.jsxs("div",{className:"p-4 bg-slate-900/50 rounded-lg border border-slate-700",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-slate-800 rounded-lg flex items-center justify-center",children:h}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("h4",{className:"font-medium text-white",children:e}),i?t.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-green-900/50 text-green-400 text-xs rounded-full border border-green-700",children:[t.jsx(Ce,{className:"w-3 h-3"}),"Configured"]}):t.jsxs("span",{className:"flex items-center gap-1 px-2 py-0.5 bg-slate-700 text-slate-400 text-xs rounded-full",children:[t.jsx(at,{className:"w-3 h-3"}),"Not configured"]}),c&&t.jsxs("span",{className:`flex items-center gap-1 px-2 py-0.5 text-xs rounded-full ${c.success?"bg-green-900/50 text-green-400 border border-green-700":"bg-red-900/50 text-red-400 border border-red-700"}`,children:[c.success?t.jsx(Sp,{className:"w-3 h-3"}):t.jsx(kp,{className:"w-3 h-3"}),c.success?"Connected":"Failed"]})]}),t.jsx("p",{className:"text-sm text-slate-400",children:s}),b&&t.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Rate limit: ",b]})]})]}),t.jsxs("a",{href:u,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-sm text-blue-400 hover:text-blue-300",children:["Get API Key",t.jsx(Ye,{className:"w-3 h-3"})]})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(fs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-500"}),t.jsx("input",{type:a?"text":"password",value:r,onChange:w=>n(w.target.value),placeholder:i?"":"Enter API key...",className:"w-full pl-10 pr-10 py-2 bg-slate-800 border border-slate-600 rounded-lg text-white placeholder-slate-500 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),t.jsx("button",{type:"button",onClick:l,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-slate-500 hover:text-slate-300",children:a?t.jsx(Ny,{className:"w-4 h-4"}):t.jsx(kn,{className:"w-4 h-4"})})]}),t.jsxs("button",{type:"button",onClick:o,disabled:d||!i&&!r,className:"flex items-center gap-2 px-4 py-2 bg-slate-700 border border-slate-600 rounded-lg hover:bg-slate-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-slate-300",children:[d?t.jsx(yr,{className:"w-4 h-4 animate-spin"}):t.jsx(Ns,{className:"w-4 h-4"}),"Test"]})]})]})}function _j({settings:e,onOpenSettings:s}){var h,b,w,f;const[r,n]=k.useState(!1),a=k.useRef(null);if(k.useEffect(()=>{function y(v){a.current&&!a.current.contains(v.target)&&n(!1)}return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]),!e)return t.jsxs("button",{onClick:s,className:"flex items-center gap-2 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded-lg transition text-sm",children:[t.jsx(kp,{className:"w-4 h-4 text-slate-400"}),t.jsx("span",{className:"text-slate-300",children:"No Connection"})]});const l=Object.values(e.api_keys_configured).filter(Boolean).length,i=Object.keys(e.api_keys_configured).length,o=((h=e.api_keys_configured)==null?void 0:h.virustotal)||((b=e.api_keys_configured)==null?void 0:b.abuseipdb),d=((w=e.api_keys_configured)==null?void 0:w.anthropic)||((f=e.api_keys_configured)==null?void 0:f.openai),c=()=>l===0?"bg-red-500":l<3?"bg-yellow-500":"bg-green-500",u=[{name:"VirusTotal",key:"virustotal",icon:Ke,color:"blue",category:"Threat Intel"},{name:"AbuseIPDB",key:"abuseipdb",icon:oe,color:"orange",category:"Threat Intel"},{name:"PhishTank",key:"phishtank",icon:bn,color:"yellow",category:"Threat Intel"},{name:"MXToolbox",key:"mxtoolbox",icon:vt,color:"purple",category:"Threat Intel"},{name:"Anthropic",key:"anthropic",icon:nt,color:"orange",category:"AI"},{name:"OpenAI",key:"openai",icon:gt,color:"green",category:"AI"}];return t.jsxs("div",{className:"relative",ref:a,children:[t.jsxs("button",{onClick:()=>n(!r),className:"flex items-center gap-2 px-3 py-1.5 bg-slate-700 hover:bg-slate-600 rounded-lg transition text-sm group",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("div",{className:`w-2 h-2 rounded-full ${c()}`}),t.jsxs("span",{className:"text-slate-300",children:[l,"/",i," APIs"]})]}),t.jsx(Qt,{className:`w-4 h-4 text-slate-400 transition-transform ${r?"rotate-180":""}`})]}),r&&t.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-slate-800 border border-slate-700 rounded-xl shadow-xl z-50 overflow-hidden",children:[t.jsx("div",{className:"p-3 border-b border-slate-700 bg-slate-900/50",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-sm font-medium text-white",children:"API Services Status"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${c()}`}),t.jsxs("span",{className:"text-xs text-slate-400",children:[l," configured"]})]})]})}),t.jsxs("div",{className:"p-3 grid grid-cols-2 gap-2 border-b border-slate-700",children:[t.jsxs("div",{className:`p-2 rounded-lg ${o&&e.enrichment_enabled?"bg-green-900/30 border border-green-700":"bg-slate-900/50 border border-slate-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{className:`w-4 h-4 ${o&&e.enrichment_enabled?"text-green-400":"text-slate-500"}`}),t.jsx("span",{className:`text-xs font-medium ${o&&e.enrichment_enabled?"text-green-400":"text-slate-500"}`,children:"Threat Intel"})]}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:o&&e.enrichment_enabled?"Active":"Not configured"})]}),t.jsxs("div",{className:`p-2 rounded-lg ${d&&e.ai_enabled?"bg-purple-900/30 border border-purple-700":"bg-slate-900/50 border border-slate-600"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(nt,{className:`w-4 h-4 ${d&&e.ai_enabled?"text-purple-400":"text-slate-500"}`}),t.jsx("span",{className:`text-xs font-medium ${d&&e.ai_enabled?"text-purple-400":"text-slate-500"}`,children:"AI Analysis"})]}),t.jsx("p",{className:"text-xs text-slate-500 mt-1",children:d&&e.ai_enabled?`${e.ai_provider==="anthropic"?"Claude":"GPT-4"}`:"Not configured"})]})]}),t.jsx("div",{className:"p-2 max-h-64 overflow-y-auto",children:u.map(y=>{const v=e.api_keys_configured[y.key],g=y.icon;return t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-slate-700/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(g,{className:`w-4 h-4 text-${y.color}-400`}),t.jsxs("div",{children:[t.jsx("span",{className:"text-sm text-white",children:y.name}),t.jsx("span",{className:"text-xs text-slate-500 ml-2",children:y.category})]})]}),v?t.jsxs("div",{className:"flex items-center gap-1 text-green-400",children:[t.jsx(Ce,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:"Ready"})]}):t.jsxs("div",{className:"flex items-center gap-1 text-slate-500",children:[t.jsx(at,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:"Not set"})]})]},y.key)})}),t.jsx("div",{className:"p-3 border-t border-slate-700 bg-slate-900/50",children:t.jsxs("button",{onClick:()=>{n(!1),s()},className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition text-sm font-medium",children:[t.jsx(jn,{className:"w-4 h-4"}),"Open Settings"]})})]})]})}function kj({configuredCount:e,totalCount:s,onOpenSettings:r}){const[n,a]=k.useState(!1);return e>=2||n?null:t.jsx("div",{className:"bg-amber-900/50 border-b border-amber-700 px-6 py-2",children:t.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ae,{className:"w-5 h-5 text-amber-400"}),t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-amber-200 font-medium",children:e===0?"No API keys configured":`Only ${e} API${e>1?"s":""} configured`}),t.jsx("span",{className:"text-amber-300/80 ml-2",children:"Add API keys to enable threat intelligence and AI analysis features."})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 px-3 py-1 bg-amber-600 hover:bg-amber-700 text-white text-sm rounded-lg transition",children:[t.jsx(jn,{className:"w-4 h-4"}),"Configure"]}),t.jsx("button",{onClick:()=>a(!0),className:"p-1 text-amber-400 hover:text-amber-200 transition",children:t.jsx(ws,{className:"w-4 h-4"})})]})]})})}const Yp=(e,s)=>e==="url@analysis.local"||s!=null&&s.includes("URL Analysis")?"url":e==="sms@analysis.local"||s!=null&&s.includes("SMS Analysis")?"sms":"email",J0=(e,s=null)=>{switch(Yp(e,s)){case"url":return{icon:Ke,color:"text-blue-500 bg-blue-100",label:"URL",title:"URL Analysis"};case"sms":return{icon:Xt,color:"text-green-500 bg-green-100",label:"SMS",title:"SMS/Text Analysis"};default:return{icon:Ut,color:"text-indigo-500 bg-indigo-100",label:"Email",title:"Email Analysis"}}},Sj=({isOpen:e,onClose:s,onViewAnalysis:r,onExportAnalysis:n})=>{const[a,l]=k.useState([]),[i,o]=k.useState(!1),[d,c]=k.useState(0),[u,h]=k.useState(1),[b]=k.useState(15),[w,f]=k.useState(""),[y,v]=k.useState(""),[g,p]=k.useState(""),[x,N]=k.useState("analyzed_at"),[j,S]=k.useState("desc"),[C,P]=k.useState(new Set),[$,z]=k.useState(!1),[B,de]=k.useState(null),[xe,be]=k.useState(!1),ue=k.useCallback(async()=>{o(!0);try{const D=(await Ie.get("/analyses",{params:{page:u,page_size:b,sort_by:x,sort_order:j,...w&&{search:w},...y&&{risk_level:y},...g&&{classification:g}}})).data;l(D.analyses||[]),c(D.total||0)}catch(A){console.error("Failed to fetch analyses:",A),ie.error("Failed to load history")}finally{o(!1)}},[u,b,w,y,g,x,j]);k.useEffect(()=>{e&&ue()},[e,ue]);const se=async A=>{try{await Ie.delete(`/analyses/${A}`),ie.success("Analysis deleted"),de(null),ue()}catch{ie.error("Failed to delete analysis")}},ke=async()=>{try{const A=await Ie.delete("/analyses");ie.success(`Deleted ${A.data.count} analyses`),be(!1),ue()}catch{ie.error("Failed to delete analyses")}},_=async()=>{for(const A of C)await Ie.delete(`/analyses/${A}`);ie.success(`Deleted ${C.size} analyses`),P(new Set),ue()},I=A=>{const D=new Set(C);D.has(A)?D.delete(A):D.add(A),P(D)},E=()=>{P($?new Set:new Set(a.map(A=>A.analysis_id))),z(!$)},F=A=>{switch(A==null?void 0:A.toLowerCase()){case"critical":return"bg-red-100 text-red-800 border-red-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"low":return"bg-blue-100 text-blue-800 border-blue-200";default:return"bg-green-100 text-green-800 border-green-200"}},J=A=>({phishing:"bg-red-500",bec:"bg-orange-500",malware:"bg-purple-500",spam:"bg-yellow-500",legitimate:"bg-green-500"})[A==null?void 0:A.toLowerCase()]||"bg-gray-500",R=Math.ceil(d/b);return e?t.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-end md:items-center justify-center p-0 md:p-4",children:t.jsxs("div",{className:"bg-white rounded-t-2xl md:rounded-xl shadow-2xl w-full md:max-w-6xl max-h-[95vh] md:max-h-[90vh] flex flex-col animate-slide-up md:animate-fade-in",children:[t.jsxs("div",{className:"flex items-center justify-between p-3 md:p-4 border-b bg-gray-50 rounded-t-2xl md:rounded-t-xl",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[t.jsx("div",{className:"p-1.5 md:p-2 bg-indigo-100 rounded-lg",children:t.jsx(vp,{className:"w-4 h-4 md:w-5 md:h-5 text-indigo-600"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-base md:text-lg font-bold text-gray-900",children:"Analysis History"}),t.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:[d," analyses stored"]})]})]}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-200 rounded-lg transition-colors",children:t.jsx(ws,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"p-3 md:p-4 border-b bg-white space-y-2 md:space-y-3",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 md:gap-3",children:[t.jsxs("div",{className:"flex-grow min-w-0 relative",children:[t.jsx(Br,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search...",value:w,onChange:A=>{f(A.target.value),h(1)},className:"w-full pl-10 pr-4 py-2.5 md:py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 text-sm"})]}),t.jsxs("select",{value:y,onChange:A=>{v(A.target.value),h(1)},className:"px-3 py-2.5 md:py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 text-sm",children:[t.jsx("option",{value:"",children:"All Risk Levels"}),t.jsx("option",{value:"critical",children:"Critical"}),t.jsx("option",{value:"high",children:"High"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"minimal",children:"Minimal"})]}),t.jsxs("select",{value:g,onChange:A=>{p(A.target.value),h(1)},className:"px-3 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500",children:[t.jsx("option",{value:"",children:"All Classifications"}),t.jsx("option",{value:"phishing",children:"Phishing"}),t.jsx("option",{value:"bec",children:"BEC"}),t.jsx("option",{value:"malware",children:"Malware"}),t.jsx("option",{value:"spam",children:"Spam"}),t.jsx("option",{value:"legitimate",children:"Legitimate"})]}),t.jsxs("button",{onClick:ue,disabled:i,className:"px-3 py-2 border rounded-lg hover:bg-gray-50 transition-colors flex items-center gap-2",children:[t.jsx(Ns,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"Refresh"]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:$,onChange:E,className:"w-4 h-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Select all"})]}),C.size>0&&t.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[t.jsxs("span",{className:"text-sm text-gray-500",children:[C.size," selected"]}),t.jsxs("button",{onClick:_,className:"px-3 py-1.5 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 flex items-center gap-1",children:[t.jsx(yl,{className:"w-3 h-3"}),"Delete Selected"]})]})]}),t.jsxs("button",{onClick:()=>be(!0),className:"px-3 py-1.5 text-sm text-red-600 hover:bg-red-50 rounded flex items-center gap-1",children:[t.jsx(yl,{className:"w-4 h-4"}),"Clear All History"]})]})]}),t.jsx("div",{className:"flex-grow overflow-auto",children:i?t.jsx("div",{className:"flex items-center justify-center py-20",children:t.jsx(yr,{className:"w-8 h-8 animate-spin text-indigo-500"})}):a.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-500",children:[t.jsx(Ze,{className:"w-12 h-12 mb-4 text-gray-300"}),t.jsx("p",{className:"font-medium",children:"No analyses found"}),t.jsx("p",{className:"text-sm",children:"Upload an email to get started"})]}):t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gray-50 sticky top-0",children:t.jsxs("tr",{children:[t.jsx("th",{className:"w-10 px-4 py-3",children:t.jsx("input",{type:"checkbox",checked:$,onChange:E,className:"w-4 h-4 rounded border-gray-300 text-indigo-600"})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t.jsxs("button",{onClick:()=>{N("analyzed_at"),S(j==="desc"?"asc":"desc")},className:"flex items-center gap-1 hover:text-gray-700",children:["Date",x==="analyzed_at"&&(j==="desc"?t.jsx(S0,{className:"w-3 h-3"}):t.jsx(C0,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t.jsxs("button",{onClick:()=>{N("risk_score"),S(j==="desc"?"asc":"desc")},className:"flex items-center gap-1 hover:text-gray-700",children:["Risk",x==="risk_score"&&(j==="desc"?t.jsx(S0,{className:"w-3 h-3"}):t.jsx(C0,{className:"w-3 h-3"}))]})}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Classification"}),t.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Indicators"}),t.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map(A=>{var D,q;return t.jsxs("tr",{className:`hover:bg-gray-50 transition-colors ${C.has(A.analysis_id)?"bg-indigo-50":""}`,children:[t.jsx("td",{className:"px-4 py-3",children:t.jsx("input",{type:"checkbox",checked:C.has(A.analysis_id),onChange:()=>I(A.analysis_id),className:"w-4 h-4 rounded border-gray-300 text-indigo-600"})}),t.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(os,{className:"w-4 h-4 text-gray-400"}),new Date(A.analyzed_at).toLocaleDateString(),t.jsx("span",{className:"text-xs text-gray-400",children:new Date(A.analyzed_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("div",{className:"max-w-[200px] truncate text-sm font-medium text-gray-900",children:A.subject||"(No Subject)"})}),t.jsx("td",{className:"px-4 py-3",children:(()=>{const T=J0(A.sender_email,A.subject),Y=T.icon;return t.jsxs("div",{className:"flex items-center gap-2",title:T.title,children:[t.jsx("div",{className:`p-1.5 rounded ${T.color}`,children:t.jsx(Y,{className:"w-3.5 h-3.5"})}),t.jsx("span",{className:"text-xs font-medium text-gray-600",children:T.label})]})})()}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-sm font-bold text-gray-900",children:A.risk_score}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full border ${F(A.risk_level)}`,children:(D=A.risk_level)==null?void 0:D.toUpperCase()})]})}),t.jsx("td",{className:"px-4 py-3",children:t.jsx("span",{className:`px-2 py-1 text-xs font-medium text-white rounded ${J(A.classification)}`,children:(q=A.classification)==null?void 0:q.toUpperCase()})}),t.jsx("td",{className:"px-4 py-3",children:t.jsxs("div",{className:"flex items-center gap-3 text-gray-400",children:[A.has_attachments&&t.jsxs("div",{className:"flex items-center gap-1",title:`${A.attachment_count} attachments`,children:[t.jsx(hr,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:A.attachment_count})]}),A.has_urls&&t.jsxs("div",{className:"flex items-center gap-1",title:`${A.url_count} URLs`,children:[t.jsx(jt,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs",children:A.url_count})]})]})}),t.jsx("td",{className:"px-4 py-3 text-right",children:t.jsxs("div",{className:"flex items-center justify-end gap-1",children:[(()=>{J0(A.sender_email,A.subject);const T=Yp(A.sender_email,A.subject),ve={email:{icon:kn,color:"text-indigo-600 hover:bg-indigo-100",title:"View Email Analysis"},url:{icon:Ke,color:"text-blue-600 hover:bg-blue-100",title:"View URL Report"},sms:{icon:Xt,color:"text-green-600 hover:bg-green-100",title:"View SMS Report"}}[T],Le=ve.icon;return t.jsx("button",{onClick:()=>r(A.analysis_id,T),className:`p-1.5 rounded ${ve.color}`,title:ve.title,children:t.jsx(Le,{className:"w-4 h-4"})})})(),t.jsx("button",{onClick:()=>n(A.analysis_id,"json"),className:"p-1.5 hover:bg-gray-100 rounded text-gray-600",title:"Export JSON",children:t.jsx(Rs,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>de(A.analysis_id),className:"p-1.5 hover:bg-red-100 rounded text-red-600",title:"Delete",children:t.jsx(yl,{className:"w-4 h-4"})})]})})]},A.analysis_id)})})]})}),R>1&&t.jsxs("div",{className:"flex items-center justify-between p-4 border-t bg-gray-50 rounded-b-xl",children:[t.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(u-1)*b+1," to ",Math.min(u*b,d)," of ",d]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>h(A=>Math.max(1,A-1)),disabled:u===1,className:"p-2 border rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(td,{className:"w-4 h-4"})}),Array.from({length:Math.min(5,R)},(A,D)=>{let q;return R<=5||u<=3?q=D+1:u>=R-2?q=R-4+D:q=u-2+D,t.jsx("button",{onClick:()=>h(q),className:`w-8 h-8 rounded text-sm ${u===q?"bg-indigo-600 text-white":"border hover:bg-gray-100"}`,children:q},q)}),t.jsx("button",{onClick:()=>h(A=>Math.min(R,A+1)),disabled:u===R,className:"p-2 border rounded hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed",children:t.jsx(Fr,{className:"w-4 h-4"})})]})]}),B&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-60",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm mx-4 shadow-xl",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:t.jsx(ae,{className:"w-5 h-5 text-red-600"})}),t.jsx("h3",{className:"font-semibold text-gray-900",children:"Delete Analysis?"})]}),t.jsx("p",{className:"text-gray-600 mb-6",children:"This will permanently delete this analysis. This action cannot be undone."}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>de(null),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:()=>se(B),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete"})]})]})}),xe&&t.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-60",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm mx-4 shadow-xl",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:t.jsx(bn,{className:"w-5 h-5 text-red-600"})}),t.jsx("h3",{className:"font-semibold text-gray-900",children:"Delete ALL Analyses?"})]}),t.jsxs("p",{className:"text-gray-600 mb-6",children:["This will permanently delete ",t.jsxs("strong",{children:[d," analyses"]}),". This action cannot be undone."]}),t.jsxs("div",{className:"flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>be(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:ke,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete All"})]})]})})]})}):null},Cj=({analysisResult:e})=>{var A,D,q,T,Y,ve,Le,ut,he,Ge;const[s,r]=k.useState("iocs"),[n,a]=k.useState(null),[l,i]=k.useState(!1),[o,d]=k.useState(null),[c,u]=k.useState("brackets"),[h,b]=k.useState("text"),[w,f]=k.useState("generic"),[y,v]=k.useState("generic"),[g,p]=k.useState("phishing_warning"),[x,N]=k.useState(null),[j,S]=k.useState(new Set),[C,P]=k.useState(null),[$,z]=k.useState(null),[B,de]=k.useState(!1),xe=k.useMemo(()=>{var V,ee,Ae;if(!e)return null;const Q=e.email||{},H=e.enrichment||{},ge=new Set,O=new Set,Z=new Set,re=new Set;if((V=Q.sender)!=null&&V.domain&&ge.add(Q.sender.domain),(ee=Q.sender)!=null&&ee.email){const te=Q.sender.email.split("@")[1];te&&ge.add(te)}return(Q.urls||[]).forEach(te=>{typeof te=="string"?O.add(te):te!=null&&te.url&&O.add(te.url),te!=null&&te.domain&&ge.add(te.domain)}),(Q.attachments||[]).forEach(te=>{te!=null&&te.md5&&re.add(te.md5),te!=null&&te.sha256&&re.add(te.sha256)}),(Ae=H==null?void 0:H.originating_ip)!=null&&Ae.ip&&Z.add(H.originating_ip.ip),{data:{domains:Array.from(ge).filter(Boolean),urls:Array.from(O).filter(Boolean),ips:Array.from(Z).filter(Boolean),hashes_md5:[],hashes_sha256:Array.from(re).filter(Boolean)},counts:{domains:ge.size,urls:O.size,ips:Z.size,hashes:re.size,total:ge.size+O.size+Z.size+re.size},formatted:{text:`Domains:
${Array.from(ge).filter(Boolean).join(`
`)}

URLs:
${Array.from(O).filter(Boolean).join(`
`)}

IPs:
${Array.from(Z).filter(Boolean).join(`
`)}`}}},[e]),be=async()=>{if(e){i(!0);try{const Q=await Ie.post("/soc/quick-actions",e);a(Q.data),N(Q.data.playbook)}catch(Q){console.error("Failed to fetch quick actions:",Q)}finally{i(!1)}}};if(k.useEffect(()=>{e&&be()},[e]),!e)return t.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-8 text-center",children:[t.jsx(oe,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-400",children:"No Analysis Data"}),t.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Run an email, URL, or SMS analysis to access SOC tools"})]});const ue=async(Q,H)=>{try{await navigator.clipboard.writeText(Q),d(H),setTimeout(()=>d(null),2e3)}catch(ge){console.error("Failed to copy:",ge)}},se=(Q,H,ge="text/plain")=>{const O=new Blob([Q],{type:ge}),Z=URL.createObjectURL(O),re=document.createElement("a");re.href=Z,re.download=H,document.body.appendChild(re),re.click(),document.body.removeChild(re),URL.revokeObjectURL(Z)},ke=Q=>{const H=new Set(j);H.has(Q)?H.delete(Q):H.add(Q),S(H)},_=({tab:Q,icon:H,label:ge,count:O})=>t.jsxs("button",{onClick:()=>r(Q),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-all text-sm font-medium ${s===Q?"bg-indigo-600 text-white":"text-gray-400 hover:text-gray-200 hover:bg-gray-800"}`,children:[H,t.jsx("span",{children:ge}),O!==void 0&&O>0&&t.jsx("span",{className:`px-1.5 py-0.5 rounded text-xs ${s===Q?"bg-indigo-500 text-white":"bg-gray-700 text-gray-300"}`,children:O})]}),I=()=>{var O,Z,re,V,ee,Ae,te,Os,zs,Us,Fs,Bs,Hs,Vs;const H=(n==null?void 0:n.iocs)||xe;if(!H||((O=H.counts)==null?void 0:O.total)===0)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx(oe,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("p",{className:"text-gray-400",children:"No IOCs extracted from this email"}),t.jsx("p",{className:"text-sm mt-1 text-gray-500",children:"This email may not contain observable indicators"})]});const ge=()=>{var Pe,kt,qs;return H.formatted?c==="full"?H.formatted.defanged_full||H.formatted.text:h==="csv"?H.formatted.csv||H.formatted.text:h==="json"&&H.formatted.json||H.formatted.text:H.data?`Domains:
${((Pe=H.data.domains)==null?void 0:Pe.join(`
`))||""}

URLs:
${((kt=H.data.urls)==null?void 0:kt.join(`
`))||""}

IPs:
${((qs=H.data.ips)==null?void 0:qs.join(`
`))||""}`:""};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"grid grid-cols-3 md:grid-cols-5 gap-2 md:gap-3",children:[t.jsxs("div",{className:"bg-blue-900/30 border border-blue-700/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold text-blue-400",children:((Z=H.counts)==null?void 0:Z.domains)||0}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-400",children:"Domains"})]}),t.jsxs("div",{className:"bg-purple-900/30 border border-purple-700/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold text-purple-400",children:((re=H.counts)==null?void 0:re.urls)||0}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-400",children:"URLs"})]}),t.jsxs("div",{className:"bg-green-900/30 border border-green-700/50 rounded-lg p-2 md:p-3 text-center",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold text-green-400",children:((V=H.counts)==null?void 0:V.ips)||0}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-400",children:"IPs"})]}),t.jsxs("div",{className:"bg-orange-900/30 border border-orange-700/50 rounded-lg p-2 md:p-3 text-center hidden md:block",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold text-orange-400",children:((ee=H.counts)==null?void 0:ee.hashes)||0}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-400",children:"Hashes"})]}),t.jsxs("div",{className:"bg-red-900/30 border border-red-700/50 rounded-lg p-2 md:p-3 text-center hidden md:block",children:[t.jsx("div",{className:"text-lg md:text-2xl font-bold text-red-400",children:((Ae=H.counts)==null?void 0:Ae.total)||0}),t.jsx("div",{className:"text-[10px] md:text-xs text-gray-400",children:"Total"})]})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row flex-wrap gap-3 md:gap-4 p-3 bg-gray-800/50 rounded-lg border border-gray-700",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-gray-400",children:"Defang:"}),t.jsxs("select",{value:c,onChange:Pe=>u(Pe.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1.5 text-sm text-gray-200 flex-1 sm:flex-none",children:[t.jsx("option",{value:"none",children:"None (raw)"}),t.jsx("option",{value:"brackets",children:"Brackets [.]"}),t.jsx("option",{value:"full",children:"Full (hxxps://[.])"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-gray-400",children:"Format:"}),t.jsxs("select",{value:h,onChange:Pe=>b(Pe.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1.5 text-sm text-gray-200 flex-1 sm:flex-none",children:[t.jsx("option",{value:"text",children:"Plain Text"}),t.jsx("option",{value:"csv",children:"CSV"}),t.jsx("option",{value:"json",children:"JSON"})]})]}),h==="json"&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("label",{className:"text-sm text-gray-400",children:"SIEM:"}),t.jsxs("select",{value:w,onChange:Pe=>f(Pe.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm text-gray-200",children:[t.jsx("option",{value:"generic",children:"Generic"}),t.jsx("option",{value:"splunk",children:"Splunk"}),t.jsx("option",{value:"elastic",children:"Elastic"}),t.jsx("option",{value:"sentinel",children:"Sentinel"})]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.jsxs("button",{onClick:()=>ue(ge(),"all-iocs"),className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm",children:[t.jsx(De,{className:"w-4 h-4"}),"Copy All IOCs",o==="all-iocs"&&t.jsx(ss,{className:"w-4 h-4"})]}),((Os=(te=H==null?void 0:H.data)==null?void 0:te.domains)==null?void 0:Os.length)>0&&t.jsxs("button",{onClick:()=>ue(H.data.domains.join(`
`),"domains"),className:"flex items-center gap-2 px-3 py-2 bg-blue-600/20 text-blue-400 border border-blue-600/50 rounded-lg hover:bg-blue-600/30 text-sm",children:[t.jsx(De,{className:"w-4 h-4"}),"Domains (",H.data.domains.length,")",o==="domains"&&t.jsx(ss,{className:"w-4 h-4"})]}),((Us=(zs=H==null?void 0:H.data)==null?void 0:zs.ips)==null?void 0:Us.length)>0&&t.jsxs("button",{onClick:()=>ue(H.data.ips.join(`
`),"ips"),className:"flex items-center gap-2 px-3 py-2 bg-green-600/20 text-green-400 border border-green-600/50 rounded-lg hover:bg-green-600/30 text-sm",children:[t.jsx(De,{className:"w-4 h-4"}),"IPs (",H.data.ips.length,")",o==="ips"&&t.jsx(ss,{className:"w-4 h-4"})]}),t.jsxs("button",{onClick:()=>{const Pe=h==="json"?"json":h==="csv"?"csv":"txt";se(ge(),`iocs-${Date.now()}.${Pe}`)},className:"flex items-center gap-2 px-3 py-2 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 text-sm",children:[t.jsx(Rs,{className:"w-4 h-4"}),"Download"]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"text-sm font-medium text-gray-300",children:"IOC Preview"}),t.jsx("button",{onClick:()=>ue(ge(),"preview"),className:"text-sm text-indigo-400 hover:text-indigo-300",children:o==="preview"?"Copied!":"Copy"})]}),t.jsxs("pre",{className:"p-3 md:p-4 text-xs md:text-sm overflow-auto max-h-48 md:max-h-64 bg-gray-900 font-mono text-gray-300",children:[ge().slice(0,2e3),ge().length>2e3&&`
... (truncated)`]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 md:gap-4",children:[((Bs=(Fs=H==null?void 0:H.data)==null?void 0:Fs.domains)==null?void 0:Bs.length)>0&&t.jsxs("div",{className:"border border-gray-700 rounded-lg p-3 bg-gray-800/50",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2 text-gray-200 text-sm md:text-base",children:[t.jsx(Ke,{className:"w-4 h-4 text-blue-400"}),"Domains (",H.data.domains.length,")"]}),t.jsx("ul",{className:"text-xs md:text-sm space-y-1 max-h-32 overflow-auto",children:H.data.domains.map((Pe,kt)=>t.jsx("li",{className:"font-mono text-gray-400 hover:text-gray-200 hover:bg-gray-700 px-2 py-1.5 rounded cursor-pointer",onClick:()=>ue(Pe,`domain-${kt}`),children:Pe},kt))})]}),((Vs=(Hs=H==null?void 0:H.data)==null?void 0:Hs.urls)==null?void 0:Vs.length)>0&&t.jsxs("div",{className:"border border-gray-700 rounded-lg p-3 bg-gray-800/50",children:[t.jsxs("h4",{className:"font-medium mb-2 flex items-center gap-2 text-gray-200 text-sm md:text-base",children:[t.jsx(sd,{className:"w-4 h-4 text-purple-400"}),"URLs (",H.data.urls.length,")"]}),t.jsx("ul",{className:"text-xs md:text-sm space-y-1 max-h-32 overflow-auto",children:H.data.urls.slice(0,10).map((Pe,kt)=>t.jsx("li",{className:"font-mono text-gray-400 hover:text-gray-200 hover:bg-gray-700 px-2 py-1.5 rounded cursor-pointer truncate",onClick:()=>ue(Pe,`url-${kt}`),title:Pe,children:Pe.length>40?Pe.slice(0,40)+"...":Pe},kt))})]})]})]})},E=()=>{var O,Z,re;const Q=n==null?void 0:n.rules,H=((O=e==null?void 0:e.detection)==null?void 0:O.rules_triggered)||(e==null?void 0:e.rules_triggered)||[];return Q||H.length>0?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("h3",{className:"font-semibold text-gray-200 flex items-center gap-2",children:[t.jsx(oe,{className:"w-5 h-5 text-red-400"}),"Triggered Detection Rules",t.jsxs("span",{className:`ml-2 px-2 py-0.5 rounded text-xs ${H.length>0?"bg-red-900/50 text-red-400":"bg-gray-700 text-gray-400"}`,children:[H.length," matched"]})]})}),H.length===0?t.jsxs("div",{className:"bg-green-900/20 border border-green-700/50 rounded-lg p-4 text-center",children:[t.jsx(ss,{className:"w-8 h-8 mx-auto mb-2 text-green-400"}),t.jsx("p",{className:"text-green-400 font-medium",children:"No Detection Rules Triggered"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Email passed all detection rule checks"})]}):t.jsxs("div",{className:"border border-red-700/50 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-red-900/30 px-4 py-2 border-b border-red-700/50 flex items-center gap-2",children:[t.jsx(oe,{className:"w-5 h-5 text-red-400"}),t.jsxs("span",{className:"font-medium text-red-300",children:["Rules That Matched (",H.length,")"]})]}),t.jsx("div",{className:"divide-y divide-gray-700 max-h-80 overflow-y-auto",children:H.map((V,ee)=>t.jsx("div",{className:"p-3 bg-gray-800/50",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("span",{className:"font-medium text-gray-200",children:V.rule_name||V.name||`Rule ${ee+1}`}),t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${(V.severity||"").toLowerCase()==="critical"?"bg-red-900/50 text-red-400 border border-red-700":(V.severity||"").toLowerCase()==="high"?"bg-orange-900/50 text-orange-400 border border-orange-700":(V.severity||"").toLowerCase()==="medium"?"bg-yellow-900/50 text-yellow-400 border border-yellow-700":"bg-gray-700 text-gray-300"}`,children:V.severity||"medium"}),V.category&&t.jsx("span",{className:"px-2 py-0.5 rounded text-xs bg-purple-900/50 text-purple-400 border border-purple-700",children:V.category})]}),t.jsx("p",{className:"text-sm text-gray-400",children:V.description||"No description"}),V.evidence&&V.evidence.length>0&&t.jsxs("div",{className:"mt-2",children:[t.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Evidence:"}),t.jsxs("ul",{className:"text-xs text-gray-400 space-y-0.5",children:[V.evidence.slice(0,3).map((Ae,te)=>t.jsxs("li",{className:"flex items-start gap-1",children:[t.jsx("span",{className:"text-yellow-400",children:""}),t.jsx("span",{className:"break-all",children:Ae})]},te)),V.evidence.length>3&&t.jsxs("li",{className:"text-gray-500",children:["+",V.evidence.length-3," more"]})]})]}),V.mitre_techniques&&V.mitre_techniques.length>0&&t.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:V.mitre_techniques.map((Ae,te)=>t.jsx("span",{className:"px-1.5 py-0.5 rounded text-xs bg-blue-900/50 text-blue-400 font-mono",children:Ae},te))})]}),t.jsxs("div",{className:"text-right ml-3",children:[t.jsxs("span",{className:`text-lg font-bold ${(V.weight_score||V.score||0)>=20?"text-red-400":(V.weight_score||V.score||0)>=10?"text-orange-400":"text-yellow-400"}`,children:["+",V.weight_score||V.score||0]}),t.jsx("p",{className:"text-xs text-gray-500",children:"points"})]})]})},ee))})]})]}),Q&&t.jsx("div",{className:"border-t border-gray-700 pt-4",children:t.jsx("p",{className:"text-xs text-gray-500 mb-4 text-center",children:" Generated hunting rules based on IOCs found "})}),Q&&t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h3",{className:"font-semibold text-gray-200 flex items-center gap-2",children:[t.jsx(Wi,{className:"w-5 h-5 text-indigo-400"}),"Generated Hunting Rules",t.jsxs("span",{className:"ml-2 px-2 py-0.5 rounded text-xs bg-indigo-900/50 text-indigo-400",children:[(((Z=Q.yara)==null?void 0:Z.length)||0)+(((re=Q.sigma)==null?void 0:re.length)||0)," rules"]})]}),t.jsxs("button",{onClick:()=>{const V=[...Q.yara||[],...Q.sigma||[]].map(ee=>`# ${ee.rule_name}
${ee.rule_content}`).join(`

---

`);se(V,`detection-rules-${Date.now()}.txt`)},className:"flex items-center gap-2 px-3 py-1 bg-indigo-600/20 text-indigo-400 border border-indigo-600/50 rounded hover:bg-indigo-600/30 text-sm",children:[t.jsx(Rs,{className:"w-4 h-4"}),"Download All"]})]}),Q.yara&&Q.yara.length>0&&t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-orange-900/30 px-4 py-2 border-b border-gray-700 flex items-center gap-2",children:[t.jsx(Wi,{className:"w-5 h-5 text-orange-400"}),t.jsxs("span",{className:"font-medium text-orange-300",children:["YARA Rules (",Q.yara.length,")"]})]}),t.jsx("div",{className:"divide-y divide-gray-700",children:Q.yara.map((V,ee)=>t.jsxs("div",{className:"p-3 bg-gray-800/50",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>P(C===`yara-${ee}`?null:`yara-${ee}`),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[C===`yara-${ee}`?t.jsx(Qt,{className:"w-4 h-4 text-gray-400"}):t.jsx(Fr,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"font-mono text-sm text-gray-200",children:V.rule_name})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${V.severity==="high"?"bg-red-900/50 text-red-400":V.severity==="medium"?"bg-yellow-900/50 text-yellow-400":"bg-gray-700 text-gray-300"}`,children:V.severity}),t.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),ue(V.rule_content,`yara-${ee}`)},className:"text-indigo-400 hover:text-indigo-300",children:t.jsx(De,{className:"w-4 h-4"})})]})]}),C===`yara-${ee}`&&t.jsx("pre",{className:"mt-2 p-3 bg-gray-900 text-green-400 text-xs rounded overflow-auto max-h-64 font-mono border border-gray-700",children:V.rule_content})]},ee))})]}),Q.sigma&&Q.sigma.length>0&&t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-blue-900/30 px-4 py-2 border-b border-gray-700 flex items-center gap-2",children:[t.jsx(A0,{className:"w-5 h-5 text-blue-400"}),t.jsxs("span",{className:"font-medium text-blue-300",children:["Sigma Rules (",Q.sigma.length,")"]})]}),t.jsx("div",{className:"divide-y divide-gray-700",children:Q.sigma.map((V,ee)=>t.jsxs("div",{className:"p-3 bg-gray-800/50",children:[t.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>P(C===`sigma-${ee}`?null:`sigma-${ee}`),children:[t.jsxs("div",{className:"flex items-center gap-2",children:[C===`sigma-${ee}`?t.jsx(Qt,{className:"w-4 h-4 text-gray-400"}):t.jsx(Fr,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:"font-mono text-sm text-gray-200",children:V.rule_name})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`px-2 py-0.5 rounded text-xs ${V.severity==="high"?"bg-red-900/50 text-red-400":V.severity==="medium"?"bg-yellow-900/50 text-yellow-400":"bg-gray-700 text-gray-300"}`,children:V.severity}),t.jsx("button",{onClick:Ae=>{Ae.stopPropagation(),ue(V.rule_content,`sigma-${ee}`)},className:"text-indigo-400 hover:text-indigo-300",children:t.jsx(De,{className:"w-4 h-4"})})]})]}),C===`sigma-${ee}`&&t.jsx("pre",{className:"mt-2 p-3 bg-gray-900 text-cyan-400 text-xs rounded overflow-auto max-h-64 font-mono border border-gray-700",children:V.rule_content})]},ee))})]}),(!Q.yara||Q.yara.length===0)&&(!Q.sigma||Q.sigma.length===0)&&t.jsxs("div",{className:"text-center py-4 text-gray-500",children:[t.jsx("p",{children:"No YARA/Sigma rules generated"}),t.jsx("p",{className:"text-sm",children:"Insufficient IOCs to generate hunting rules"})]})]})]}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Wi,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("p",{className:"text-gray-400",children:"No detection rules"}),t.jsx("p",{className:"text-sm mt-1 text-gray-500",children:"Rules will be generated after analysis"})]})},F=()=>{var H,ge;const Q=n==null?void 0:n.ticket;return Q?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("label",{className:"text-sm text-gray-400",children:"Format:"}),t.jsxs("select",{value:y,onChange:O=>v(O.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1 text-gray-200",children:[t.jsx("option",{value:"generic",children:"Generic"}),t.jsx("option",{value:"servicenow",children:"ServiceNow"}),t.jsx("option",{value:"jira",children:"Jira"}),t.jsx("option",{value:"markdown",children:"Markdown"})]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-medium text-gray-300",children:"Incident Ticket Preview"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>ue(Q.description||Q.content,"ticket"),className:"flex items-center gap-1 px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700",children:[t.jsx(De,{className:"w-4 h-4"}),"Copy",o==="ticket"&&t.jsx(ss,{className:"w-4 h-4"})]}),t.jsxs("button",{onClick:()=>se(Q.description||Q.content,`incident-ticket-${Date.now()}.txt`),className:"flex items-center gap-1 px-3 py-1 bg-gray-700 text-gray-300 rounded text-sm hover:bg-gray-600",children:[t.jsx(Rs,{className:"w-4 h-4"}),"Download"]})]})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border-b border-gray-700 grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Title: "}),t.jsx("span",{className:"font-medium text-gray-200",children:Q.title||Q.summary||"Security Incident"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-500",children:"Priority: "}),t.jsx("span",{className:`font-medium ${(H=Q.priority)!=null&&H.includes("1")||Q.priority==="Highest"?"text-red-400":(ge=Q.priority)!=null&&ge.includes("2")||Q.priority==="High"?"text-orange-400":"text-yellow-400"}`,children:Q.priority})]})]}),t.jsx("pre",{className:"p-4 text-sm overflow-auto max-h-96 whitespace-pre-wrap font-mono bg-gray-900 text-gray-300",children:Q.description||Q.content})]})]}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(et,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("p",{className:"text-gray-400",children:"No ticket data available"})]})},J=()=>{if(!x||!x.steps||x.steps.length===0)return t.jsxs("div",{className:"text-center py-8",children:[t.jsx(T0,{className:"w-12 h-12 mx-auto mb-3 text-gray-600"}),t.jsx("p",{className:"text-gray-400",children:"No playbook generated"}),t.jsx("p",{className:"text-sm mt-1 text-gray-500",children:"A response playbook will be created based on threat classification"})]});if((x.playbook_type==="clean"||x.severity==="low")&&x.steps.length<=2)return t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-green-900/30 border border-green-700 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-green-600 rounded-full flex items-center justify-center",children:t.jsx(ss,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-green-400",children:x.title||"No Action Required"}),t.jsx("p",{className:"text-sm text-gray-400",children:x.description||"This analysis found no significant threats."})]})]})}),t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[t.jsx("h4",{className:"text-sm font-medium text-gray-400 mb-3",children:"Optional Verification Steps"}),x.steps.map(V=>t.jsxs("div",{className:"flex items-start gap-3 py-2",children:[t.jsx("button",{onClick:()=>ke(V.id),className:`mt-0.5 w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${j.has(V.id)?"bg-green-600 border-green-600 text-white":"border-gray-600 hover:border-green-500"}`,children:j.has(V.id)&&t.jsx(ss,{className:"w-3 h-3"})}),t.jsxs("div",{children:[t.jsx("span",{className:`text-gray-300 ${j.has(V.id)?"line-through text-gray-500":""}`,children:V.title}),t.jsx("p",{className:"text-xs text-gray-500",children:V.description})]})]},V.id))]})]});const H={};x.steps.forEach(V=>{const ee=V.category||"general";H[ee]||(H[ee]=[]),H[ee].push(V)});const ge=j.size,O=x.steps.length,Z=O>0?Math.round(ge/O*100):0,re={containment:{bg:"bg-red-900/30",text:"text-red-400",icon:t.jsx(oe,{className:"w-4 h-4"})},investigation:{bg:"bg-blue-900/30",text:"text-blue-400",icon:t.jsx(Ot,{className:"w-4 h-4"})},eradication:{bg:"bg-orange-900/30",text:"text-orange-400",icon:t.jsx(gt,{className:"w-4 h-4"})},recovery:{bg:"bg-green-900/30",text:"text-green-400",icon:t.jsx(ss,{className:"w-4 h-4"})},lessons_learned:{bg:"bg-purple-900/30",text:"text-purple-400",icon:t.jsx(et,{className:"w-4 h-4"})},verification:{bg:"bg-gray-800/50",text:"text-gray-400",icon:t.jsx(kn,{className:"w-4 h-4"})},documentation:{bg:"bg-gray-800/50",text:"text-gray-400",icon:t.jsx(et,{className:"w-4 h-4"})}};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[t.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[t.jsx("span",{className:"text-gray-400",children:"Progress"}),t.jsxs("span",{className:"text-gray-300",children:[ge,"/",O," steps (",Z,"%)"]})]}),t.jsx("div",{className:"h-2 bg-gray-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full bg-green-500 transition-all duration-300",style:{width:`${Z}%`}})})]}),Object.entries(H).map(([V,ee])=>{const Ae=re[V]||{bg:"bg-gray-800/50",text:"text-gray-400",icon:t.jsx(et,{className:"w-4 h-4"})};return t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:`px-4 py-2 border-b border-gray-700 font-medium capitalize flex items-center gap-2 ${Ae.bg} ${Ae.text}`,children:[Ae.icon,V.replace("_"," "),t.jsxs("span",{className:"text-sm font-normal text-gray-400",children:["(",ee.length," steps)"]})]}),t.jsx("div",{className:"divide-y divide-gray-700",children:ee.map(te=>t.jsxs("div",{className:`p-3 flex items-start gap-3 ${j.has(te.id)?"bg-green-900/20":"bg-gray-800/30"}`,children:[t.jsx("button",{onClick:()=>ke(te.id),className:`mt-0.5 w-5 h-5 rounded border flex items-center justify-center flex-shrink-0 ${j.has(te.id)?"bg-green-600 border-green-600 text-white":"border-gray-600 hover:border-green-500"}`,children:j.has(te.id)&&t.jsx(ss,{className:"w-3 h-3"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[t.jsx("span",{className:`font-medium text-gray-200 ${j.has(te.id)?"line-through text-gray-500":""}`,children:te.title}),te.automated&&t.jsx("span",{className:"px-2 py-0.5 bg-blue-900/50 text-blue-400 text-xs rounded",children:"Automated"}),t.jsxs("span",{className:`px-2 py-0.5 text-xs rounded ${te.priority===1?"bg-red-900/50 text-red-400":te.priority===2?"bg-yellow-900/50 text-yellow-400":"bg-gray-700 text-gray-400"}`,children:["P",te.priority]})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:te.description}),t.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(_p,{className:"w-3 h-3"}),te.responsible_team]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(os,{className:"w-3 h-3"}),"~",te.estimated_time_minutes," min"]})]})]})]},te.id))})]},V)})]})},R=()=>{const Q=async()=>{de(!0);try{const H=await Ie.post("/soc/notification/generate",{notification_type:g,analysis_result:e,recipient_name:"User"});z(H.data)}catch(H){console.error("Failed to generate notification:",H)}finally{de(!1)}};return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-4 flex-wrap",children:[t.jsx("label",{className:"text-sm text-gray-400",children:"Template:"}),t.jsxs("select",{value:g,onChange:H=>p(H.target.value),className:"bg-gray-700 border border-gray-600 rounded px-3 py-1.5 flex-1 min-w-[200px] text-gray-200",children:[t.jsx("option",{value:"phishing_warning",children:"Phishing Warning"}),t.jsx("option",{value:"credential_compromise",children:"Credential Compromise (Urgent)"}),t.jsx("option",{value:"malware_warning",children:"Malware Warning"}),t.jsx("option",{value:"bec_attempt",children:"BEC Attempt"}),t.jsx("option",{value:"account_secured",children:"Account Secured"}),t.jsx("option",{value:"general_warning",children:"General Warning"})]}),t.jsx("button",{onClick:Q,disabled:B,className:"flex items-center gap-2 px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50 text-sm",children:B?"Generating...":"Generate"})]}),$&&t.jsxs("div",{className:"border border-gray-700 rounded-lg overflow-hidden",children:[t.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 flex justify-between items-center",children:[t.jsx("span",{className:"font-medium text-gray-300",children:"Email Preview"}),t.jsx("div",{className:"flex gap-2",children:t.jsxs("button",{onClick:()=>ue(`Subject: ${$.subject}

${$.body}`,"notification"),className:"flex items-center gap-1 px-3 py-1 bg-indigo-600 text-white rounded text-sm hover:bg-indigo-700",children:[t.jsx(De,{className:"w-4 h-4"}),"Copy"]})})]}),t.jsxs("div",{className:"p-4 bg-gray-800/50 border-b border-gray-700",children:[t.jsx("span",{className:"text-sm text-gray-500",children:"Subject: "}),t.jsx("span",{className:"font-medium text-gray-200",children:$.subject})]}),t.jsx("pre",{className:"p-4 text-sm overflow-auto max-h-96 whitespace-pre-wrap bg-gray-900 text-gray-300",children:$.body})]})]})};return l?t.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700 p-8 text-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-indigo-600 border-t-transparent mx-auto"}),t.jsx("p",{className:"mt-2 text-gray-400",children:"Loading SOC Tools..."})]}):t.jsxs("div",{className:"bg-gray-900 rounded-xl border border-gray-700",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700",children:[t.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2 text-gray-100",children:[t.jsx(oe,{className:"w-5 h-5 text-indigo-400"}),"SOC Analyst Tools"]}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Quick actions, detection rules, tickets, playbooks, and user notifications"})]}),t.jsxs("div",{className:"px-4 py-3 border-b border-gray-700 flex flex-wrap gap-2",children:[t.jsx(_,{tab:"iocs",icon:t.jsx(bp,{className:"w-4 h-4"}),label:"IOCs",count:(D=(A=n==null?void 0:n.iocs)==null?void 0:A.counts)==null?void 0:D.total}),t.jsx(_,{tab:"rules",icon:t.jsx(A0,{className:"w-4 h-4"}),label:"Detection Rules",count:(((T=(q=e==null?void 0:e.detection)==null?void 0:q.rules_triggered)==null?void 0:T.length)||((Y=e==null?void 0:e.rules_triggered)==null?void 0:Y.length)||0)+(((Le=(ve=n==null?void 0:n.rules)==null?void 0:ve.yara)==null?void 0:Le.length)||0)+(((he=(ut=n==null?void 0:n.rules)==null?void 0:ut.sigma)==null?void 0:he.length)||0)}),t.jsx(_,{tab:"ticket",icon:t.jsx(et,{className:"w-4 h-4"}),label:"Incident Ticket"}),t.jsx(_,{tab:"playbook",icon:t.jsx(T0,{className:"w-4 h-4"}),label:"Response Playbook",count:(Ge=x==null?void 0:x.steps)==null?void 0:Ge.length}),t.jsx(_,{tab:"notification",icon:t.jsx(Ut,{className:"w-4 h-4"}),label:"User Notification"})]}),t.jsxs("div",{className:"p-4",children:[s==="iocs"&&t.jsx(I,{}),s==="rules"&&t.jsx(E,{}),s==="ticket"&&t.jsx(F,{}),s==="playbook"&&t.jsx(J,{}),s==="notification"&&t.jsx(R,{})]})]})},Ej=({analysisResult:e})=>{var p,x,N,j,S,C,P;const[s,r]=k.useState(!1);if(!e)return t.jsx("div",{className:"text-gray-500",children:"No analysis data available"});const n=e.email||{},a=e.detection||{};e.ai_triage;const l=a.primary_classification||"unknown",i=a.risk_level||"medium",o=a.risk_score||0,d=((p=n.sender)==null?void 0:p.email)||"Unknown",c=n.subject||"(No Subject)",u=(((x=n.to_recipients)==null?void 0:x.length)||0)+(((N=n.cc_recipients)==null?void 0:N.length)||0),b={phishing:"Phishing Attack",spear_phishing:"Targeted Phishing Attack",credential_harvesting:"Credential Theft Attempt",bec:"Business Email Compromise",invoice_fraud:"Invoice/Payment Fraud",malware_delivery:"Malware Distribution",ransomware:"Ransomware Delivery",brand_impersonation:"Brand Impersonation",spam:"Spam/Unsolicited Email",benign:"Legitimate Email"}[l]||l,f=l==="bec"||l==="invoice_fraud"?{level:"CRITICAL",color:"red",description:"Potential direct financial loss. Wire fraud attempts can result in immediate monetary damages.",financialRisk:"High - Potential for significant financial loss",reputationalRisk:"Medium - May indicate targeted attack on organization",operationalRisk:"Medium - May require finance team intervention"}:l==="ransomware"||l==="malware_delivery"?{level:"CRITICAL",color:"red",description:"Potential for system compromise and business disruption. Ransomware can halt operations.",financialRisk:"High - Potential ransom demands and recovery costs",reputationalRisk:"High - Data breach notification may be required",operationalRisk:"Critical - Business operations may be disrupted"}:l==="credential_harvesting"||l==="spear_phishing"?{level:"HIGH",color:"orange",description:"Targeted attack attempting to steal employee credentials for further access.",financialRisk:"Medium - Stolen credentials can lead to fraud",reputationalRisk:"Medium - Data exposure possible",operationalRisk:"Medium - Account remediation required"}:l==="phishing"?{level:"MEDIUM",color:"yellow",description:"Mass phishing attempt targeting employees. Risk depends on user interaction.",financialRisk:"Low to Medium - Depends on user action",reputationalRisk:"Low - Common attack type",operationalRisk:"Low - Standard remediation"}:{level:"LOW",color:"green",description:"Low-risk email with minimal business impact.",financialRisk:"Low",reputationalRisk:"Low",operationalRisk:"Low"},y=()=>{const $=new Date().toLocaleString(),z=b;let B=`EXECUTIVE SECURITY BRIEFING
Generated: ${$}
Classification: ${z}
Severity: ${i.toUpperCase()} (Score: ${o}/100)



INCIDENT SUMMARY

A ${z.toLowerCase()} was detected targeting ${u} employee${u!==1?"s":""}. `;return l==="bec"||l==="invoice_fraud"?B+="This attack attempted to manipulate employees into making unauthorized payments or changing banking details. ":l==="credential_harvesting"?B+="The attacker attempted to steal employee login credentials through a fake login page. ":l==="malware_delivery"||l==="ransomware"?B+="The email contained malicious attachments designed to compromise employee workstations. ":l==="phishing"&&(B+="The email used social engineering tactics to deceive recipients into taking harmful actions. "),B+=`



BUSINESS IMPACT ASSESSMENT

Overall Impact Level: ${f.level}

 Financial Risk: ${f.financialRisk}
 Reputational Risk: ${f.reputationalRisk}
 Operational Risk: ${f.operationalRisk}

${f.description}



ACTIONS TAKEN

 Malicious email identified and quarantined
 Sender blocked at email gateway
 Malicious URLs/domains added to blocklist
 Affected users notified
 Incident documented for compliance



RECOMMENDATIONS FOR LEADERSHIP

1. ${l==="bec"||l==="invoice_fraud"?"Review and reinforce payment verification procedures":"Continue security awareness training for employees"}

2. ${i==="critical"||i==="high"?"Consider briefing affected department heads":"Monitor for similar attacks in coming days"}

3. ${u>5?"Assess whether additional user communication is needed":"Standard incident response procedures sufficient"}



For questions or concerns, contact the Security Operations Center.

Analysis ID: ${e.analysis_id||"N/A"}
`,B},v=async()=>{try{await navigator.clipboard.writeText(y()),r(!0),setTimeout(()=>r(!1),2e3)}catch($){console.error("Failed to copy:",$)}},g=()=>{const $=y(),z=new Blob([$],{type:"text/plain"}),B=URL.createObjectURL(z),de=document.createElement("a");de.href=B,de.download=`executive-summary-${Date.now()}.txt`,document.body.appendChild(de),de.click(),document.body.removeChild(de),URL.revokeObjectURL(B)};return t.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 shadow-sm",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-800",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-100",children:[t.jsx(Kl,{className:"w-6 h-6 text-indigo-400"}),"Executive Summary"]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-3 py-1.5 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm",children:[s?t.jsx(ss,{className:"w-4 h-4"}):t.jsx(De,{className:"w-4 h-4"}),s?"Copied!":"Copy"]}),t.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-700 text-gray-300 rounded-lg hover:bg-gray-600 text-sm",children:[t.jsx(Rs,{className:"w-4 h-4"}),"Export"]})]})]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Non-technical briefing for management and stakeholders"})]}),t.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[t.jsx("div",{className:`p-3 md:p-4 rounded-lg border-2 ${f.color==="red"?"bg-red-900/30 border-red-700":f.color==="orange"?"bg-orange-900/30 border-orange-700":f.color==="yellow"?"bg-yellow-900/30 border-yellow-700":"bg-green-900/30 border-green-700"}`,children:t.jsxs("div",{className:"flex items-start gap-3 md:gap-4",children:[t.jsx("div",{className:`p-2 md:p-3 rounded-full ${f.color==="red"?"bg-red-900/50":f.color==="orange"?"bg-orange-900/50":f.color==="yellow"?"bg-yellow-900/50":"bg-green-900/50"}`,children:t.jsx(ae,{className:`w-5 h-5 md:w-6 md:h-6 ${f.color==="red"?"text-red-400":f.color==="orange"?"text-orange-400":f.color==="yellow"?"text-yellow-400":"text-green-400"}`})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[t.jsx("h3",{className:"font-bold text-base md:text-lg text-gray-100",children:b}),t.jsx("span",{className:`px-2 py-0.5 rounded text-xs md:text-sm font-medium ${f.color==="red"?"bg-red-900/50 text-red-400 border border-red-700":f.color==="orange"?"bg-orange-900/50 text-orange-400 border border-orange-700":f.color==="yellow"?"bg-yellow-900/50 text-yellow-400 border border-yellow-700":"bg-green-900/50 text-green-400 border border-green-700"}`,children:f.level})]}),t.jsx("p",{className:"text-sm md:text-base text-gray-300 mt-1",children:f.description})]})]})}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 md:p-4 text-center border border-gray-700",children:[t.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-100",children:o}),t.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Risk Score"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 md:p-4 text-center border border-gray-700",children:[t.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-100",children:u}),t.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Users Targeted"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 md:p-4 text-center border border-gray-700",children:[t.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-100",children:((j=n.urls)==null?void 0:j.length)||0}),t.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Malicious URLs"})]}),t.jsxs("div",{className:"bg-gray-900 rounded-lg p-3 md:p-4 text-center border border-gray-700",children:[t.jsx("div",{className:"text-2xl md:text-3xl font-bold text-gray-100",children:((S=n.attachments)==null?void 0:S.length)||0}),t.jsx("div",{className:"text-xs md:text-sm text-gray-400",children:"Attachments"})]})]}),((C=n.attachments)==null?void 0:C.length)>0&&n.attachments.some($=>$.threat_score>0||$.has_macros||$.has_javascript||$.is_executable)&&t.jsxs("div",{className:"border border-red-700/50 rounded-lg bg-red-950/20",children:[t.jsxs("div",{className:"bg-red-900/30 px-4 py-2 border-b border-red-700/50 font-medium flex items-center gap-2 text-red-400",children:[t.jsx(ae,{className:"w-4 h-4"})," Attachment Threat Analysis"]}),t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsx("p",{className:"text-gray-300 text-sm",children:"Static analysis of email attachments identified the following security concerns:"}),n.attachments.filter($=>$.threat_score>0||$.has_macros||$.has_javascript||$.is_executable).map(($,z)=>{var xe;const B=((xe=$.threat_level)==null?void 0:xe.toLowerCase())||"unknown",de=B==="critical"||B==="high"?"red":B==="medium"?"orange":B==="low"?"yellow":"gray";return t.jsxs("div",{className:`border border-${de}-700/50 rounded-lg p-3 bg-gray-900/50`,children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"font-medium text-gray-200",children:$.filename}),$.threat_score>0&&t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${B==="critical"||B==="high"?"bg-red-900/50 text-red-400 border border-red-700":B==="medium"?"bg-orange-900/50 text-orange-400 border border-orange-700":"bg-yellow-900/50 text-yellow-400 border border-yellow-700"}`,children:["Threat Score: ",$.threat_score,"/100 (",B.toUpperCase(),")"]})]}),t.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-2",children:[$.is_executable&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"EXECUTABLE"}),$.has_macros&&t.jsx("span",{className:"px-1.5 py-0.5 bg-orange-900/50 text-orange-400 text-xs rounded border border-orange-700",children:"VBA MACROS"}),$.has_auto_exec_macros&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"AUTO-EXEC"}),$.has_dde&&t.jsx("span",{className:"px-1.5 py-0.5 bg-orange-900/50 text-orange-400 text-xs rounded border border-orange-700",children:"DDE"}),$.has_ole_objects&&t.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-900/50 text-yellow-400 text-xs rounded border border-yellow-700",children:"OLE"}),$.has_javascript&&t.jsx("span",{className:"px-1.5 py-0.5 bg-orange-900/50 text-orange-400 text-xs rounded border border-orange-700",children:"JAVASCRIPT"}),$.has_embedded_files&&t.jsx("span",{className:"px-1.5 py-0.5 bg-yellow-900/50 text-yellow-400 text-xs rounded border border-yellow-700",children:"EMBEDDED"}),$.is_packed&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"PACKED"}),$.has_suspicious_imports&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"SUS IMPORTS"}),$.type_mismatch&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"TYPE MISMATCH"}),$.has_double_extension&&t.jsx("span",{className:"px-1.5 py-0.5 bg-red-900/50 text-red-400 text-xs rounded border border-red-700",children:"DOUBLE EXT"})]}),$.threat_summary&&t.jsx("p",{className:"text-sm text-gray-400 italic",children:$.threat_summary}),$.sha256&&t.jsxs("p",{className:"text-xs text-gray-500 mt-1 font-mono",children:["SHA256: ",$.sha256.substring(0,32),"..."]})]},z)}),t.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Recommendation: Do not open these attachments. Submit to sandbox for further analysis if needed."})]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 font-medium flex items-center gap-2 text-gray-200",children:[t.jsx(Gl,{className:"w-4 h-4 text-blue-400"}),"Business Impact Assessment"]}),t.jsxs("div",{className:"p-4 grid grid-cols-3 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[t.jsx(vy,{className:"w-4 h-4 text-green-400"}),"Financial Risk"]}),t.jsx("p",{className:"text-sm text-gray-400",children:f.financialRisk})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[t.jsx(oe,{className:"w-4 h-4 text-blue-400"}),"Reputational Risk"]}),t.jsx("p",{className:"text-sm text-gray-400",children:f.reputationalRisk})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium text-gray-300",children:[t.jsx(os,{className:"w-4 h-4 text-orange-400"}),"Operational Risk"]}),t.jsx("p",{className:"text-sm text-gray-400",children:f.operationalRisk})]})]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"bg-gray-800 px-4 py-2 border-b border-gray-700 font-medium flex items-center gap-2 text-gray-200",children:[t.jsx(et,{className:"w-4 h-4 text-purple-400"}),"What Happened"]}),t.jsxs("div",{className:"p-4 space-y-3 text-gray-300",children:[t.jsxs("p",{children:[t.jsxs("strong",{children:["On ",new Date(n.date||Date.now()).toLocaleDateString()]}),", our security analysis identified a potential ",t.jsx("strong",{children:b.toLowerCase()})," attempt targeting ",u," employee",u!==1?"s":""," in our organization."]}),t.jsxs("p",{children:["The suspicious email originated from ",t.jsx("code",{className:"bg-gray-700 px-1 rounded",children:d}),' with the subject line "',c.slice(0,50),c.length>50?"...":"",'".']}),t.jsxs("p",{children:[t.jsx("strong",{children:"Status:"})," This email has been flagged for review. The following actions are recommended based on the threat classification."]})]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"bg-amber-900/30 px-4 py-2 border-b border-gray-700 font-medium flex items-center gap-2 text-amber-400",children:[t.jsx(ae,{className:"w-4 h-4"}),"Recommended Actions"]}),t.jsxs("div",{className:"p-4",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"The following actions are recommended based on the threat analysis:"}),t.jsx("ul",{className:"space-y-2",children:[{action:"Quarantine or delete the malicious email",priority:"high"},{action:"Block sender address at email gateway",priority:"high"},{action:"Add malicious URLs/domains to web filter blocklist",priority:((P=n.urls)==null?void 0:P.length)>0?"high":"low"},{action:"Notify affected users with guidance",priority:"medium"},{action:"Log incident for compliance and tracking",priority:"medium"},{action:"Update detection rules to catch similar attempts",priority:"low"}].filter($=>!($.action.includes("URLs")&&(!n.urls||n.urls.length===0))).map(($,z)=>t.jsxs("li",{className:"flex items-center gap-2 text-gray-300",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${$.priority==="high"?"bg-red-500":$.priority==="medium"?"bg-yellow-500":"bg-gray-400"}`}),$.action,t.jsx("span",{className:`text-xs px-1.5 py-0.5 rounded ${$.priority==="high"?"bg-red-900/50 text-red-400 border border-red-700":$.priority==="medium"?"bg-yellow-900/50 text-yellow-400 border border-yellow-700":"bg-gray-700 text-gray-400"}`,children:$.priority})]},z))})]})]}),t.jsxs("div",{className:"border border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"bg-blue-900/30 px-4 py-2 border-b border-gray-700 font-medium flex items-center gap-2 text-blue-400",children:[t.jsx(_p,{className:"w-4 h-4"}),"Recommendations"]}),t.jsx("div",{className:"p-4 space-y-2",children:i==="critical"||i==="high"?t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("strong",{children:"1. Executive Awareness:"})," Brief relevant department heads about this targeted attack."]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("strong",{children:"2. Enhanced Monitoring:"})," Increase vigilance for similar attacks in the coming days."]}),(l==="bec"||l==="invoice_fraud")&&t.jsxs("p",{className:"text-gray-300",children:[t.jsx("strong",{children:"3. Finance Controls:"})," Remind finance team of payment verification procedures."]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("p",{className:"text-gray-300",children:[t.jsx("strong",{children:"1. Standard Procedures:"})," Continue normal security operations and monitoring."]}),t.jsxs("p",{className:"text-gray-300",children:[t.jsx("strong",{children:"2. Awareness:"})," Use this as a training example in upcoming security awareness sessions."]})]})})]})]})]})},Tj=({analysisResult:e})=>{const s=k.useMemo(()=>{var w;if(!(e!=null&&e.email))return[];const i=e.email,o=i.headers||{},d=[],c=o.received||[],h=[...Array.isArray(c)?c:[c]].reverse();let b=null;if(h.forEach((f,y)=>{var z;if(!f)return;const v=f.match(/from\s+([^\s]+)/i),g=f.match(/by\s+([^\s]+)/i),p=f.match(/;\s*(.+)$/),x=f.match(/\[(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})\]/),N=(g==null?void 0:g[1])||(v==null?void 0:v[1])||`Server ${y+1}`,j=x==null?void 0:x[1];let S=(p==null?void 0:p[1])||"",C=null;try{C=new Date(S),isNaN(C.getTime())&&(C=null)}catch{C=null}let P=0;C&&b&&(P=Math.round((C.getTime()-b.getTime())/1e3)),b=C;const $=[];P>300&&$.push(`Long delay: ${Math.round(P/60)} minutes`),(N.includes("unknown")||N.includes("localhost"))&&$.push("Suspicious server name"),j&&parseInt(j.split(".")[0]),d.push({id:y,timestamp:C?C.toLocaleString():S||"Unknown",server:N.slice(0,40),ip:j,delay:P,action:v?`Received from ${(z=v[1])==null?void 0:z.slice(0,30)}`:"Received",suspicious:$.length>0,suspiciousReasons:$})}),d.length>0){const y=((w=(i.to_recipients||[])[0])==null?void 0:w.email)||"recipient";d.push({id:d.length,timestamp:i.date?new Date(i.date).toLocaleString():"Unknown",server:"Mailbox",action:`Delivered to ${y}`,suspicious:!1,suspiciousReasons:[]})}return d},[e]),r=k.useMemo(()=>{const i=s.reduce((o,d)=>o+(d.delay||0),0);return i<60?`${i} seconds`:i<3600?`${Math.round(i/60)} minutes`:`${Math.round(i/3600)} hours`},[s]),n=s.filter(i=>i.suspicious).length,a=k.useMemo(()=>{var d;const o=(((d=e==null?void 0:e.email)==null?void 0:d.headers)||{})["authentication-results"]||"";return{spf:o.toLowerCase().includes("spf=pass")?"pass":o.toLowerCase().includes("spf=fail")?"fail":o.toLowerCase().includes("spf=")?"neutral":"unknown",dkim:o.toLowerCase().includes("dkim=pass")?"pass":o.toLowerCase().includes("dkim=fail")?"fail":o.toLowerCase().includes("dkim=")?"neutral":"unknown",dmarc:o.toLowerCase().includes("dmarc=pass")?"pass":o.toLowerCase().includes("dmarc=fail")?"fail":o.toLowerCase().includes("dmarc=")?"neutral":"unknown"}},[e]),l=({label:i,status:o})=>t.jsxs("div",{className:`flex items-center gap-1 px-2 py-1 rounded text-sm ${o==="pass"?"bg-green-100 text-green-700":o==="fail"?"bg-red-100 text-red-700":o==="neutral"?"bg-yellow-100 text-yellow-700":"bg-gray-700 text-gray-400"}`,children:[o==="pass"?t.jsx(Ce,{className:"w-3 h-3"}):o==="fail"?t.jsx(at,{className:"w-3 h-3"}):t.jsx(ae,{className:"w-3 h-3"}),t.jsx("span",{className:"font-medium",children:i}),t.jsxs("span",{className:"text-xs",children:["(",o,")"]})]});return s.length===0?t.jsxs("div",{className:"bg-gray-800 rounded-xl border shadow-sm p-6",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-900 mb-4",children:[t.jsx(os,{className:"w-6 h-6"}),"Email Delivery Timeline"]}),t.jsxs("div",{className:"text-gray-400 text-center py-8",children:[t.jsx(vt,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),t.jsx("p",{children:"No delivery path information available"}),t.jsx("p",{className:"text-sm",children:"Received headers may not be present in this email"})]})]}):t.jsxs("div",{className:"bg-gray-800 rounded-xl border shadow-sm",children:[t.jsxs("div",{className:"p-4 border-b bg-gradient-to-r from-blue-50 to-indigo-50",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-900",children:[t.jsx(os,{className:"w-6 h-6"}),"Email Delivery Timeline"]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Visual representation of the email's journey from sender to recipient"})]}),t.jsxs("div",{className:"p-4 bg-gray-900 border-b flex flex-wrap gap-6",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(vt,{className:"w-5 h-5 text-blue-600"}),t.jsxs("span",{className:"text-sm",children:[t.jsx("strong",{children:s.length})," hops"]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(os,{className:"w-5 h-5 text-blue-600"}),t.jsxs("span",{className:"text-sm",children:[t.jsx("strong",{children:r})," total transit"]})]}),n>0&&t.jsxs("div",{className:"flex items-center gap-2 text-orange-600",children:[t.jsx(ae,{className:"w-5 h-5"}),t.jsxs("span",{className:"text-sm",children:[t.jsx("strong",{children:n})," suspicious hop",n!==1?"s":""]})]}),t.jsxs("div",{className:"flex items-center gap-4 ml-auto",children:[t.jsx(l,{label:"SPF",status:a.spf}),t.jsx(l,{label:"DKIM",status:a.dkim}),t.jsx(l,{label:"DMARC",status:a.dmarc})]})]}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"relative",children:s.map((i,o)=>t.jsxs("div",{className:"relative pl-8 pb-8 last:pb-0",children:[o<s.length-1&&t.jsx("div",{className:"absolute left-3 top-6 w-0.5 h-full bg-gray-200"}),t.jsx("div",{className:`absolute left-0 top-1 w-6 h-6 rounded-full flex items-center justify-center ${i.suspicious?"bg-orange-100 border-2 border-orange-400":o===s.length-1?"bg-green-100 border-2 border-green-400":"bg-blue-100 border-2 border-blue-400"}`,children:i.suspicious?t.jsx(ae,{className:"w-3 h-3 text-orange-600"}):o===s.length-1?t.jsx(Ut,{className:"w-3 h-3 text-green-600"}):t.jsx(vt,{className:"w-3 h-3 text-blue-600"})}),t.jsxs("div",{className:`ml-4 p-3 rounded-lg border ${i.suspicious?"bg-orange-50 border-orange-200":"bg-gray-800 border-gray-600"}`,children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:[i.server,i.ip&&t.jsxs("span",{className:"text-xs text-gray-400 font-normal",children:["(",i.ip,")"]})]}),t.jsx("div",{className:"text-sm text-gray-400 mt-1",children:i.action})]}),t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-xs text-gray-400",children:i.timestamp}),i.delay!==void 0&&i.delay>0&&t.jsxs("div",{className:`text-xs mt-1 flex items-center gap-1 justify-end ${i.delay>300?"text-orange-600":"text-gray-400"}`,children:[t.jsx(gt,{className:"w-3 h-3"}),"+",i.delay<60?`${i.delay}s`:`${Math.round(i.delay/60)}m`]})]})]}),i.suspicious&&i.suspiciousReasons.length>0&&t.jsxs("div",{className:"mt-2 pt-2 border-t border-orange-200",children:[t.jsxs("div",{className:"text-xs text-orange-700 font-medium flex items-center gap-1",children:[t.jsx(ae,{className:"w-3 h-3"}),"Anomalies detected:"]}),t.jsx("ul",{className:"mt-1 text-xs text-orange-600",children:i.suspiciousReasons.map((d,c)=>t.jsxs("li",{children:[" ",d]},c))})]})]}),o<s.length-1&&t.jsx("div",{className:"absolute left-2 top-14 text-gray-300",children:t.jsx(fy,{className:"w-4 h-4"})})]},i.id))})}),t.jsxs("div",{className:"p-4 bg-gray-900 border-t flex items-center gap-6 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-100 border-2 border-blue-400"}),t.jsx("span",{className:"text-gray-400",children:"Normal hop"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-orange-100 border-2 border-orange-400"}),t.jsx("span",{className:"text-gray-400",children:"Suspicious hop"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full bg-green-100 border-2 border-green-400"}),t.jsx("span",{className:"text-gray-400",children:"Final delivery"})]})]})]})},Aj=({analysisResult:e})=>{const[s,r]=k.useState([]),[n,a]=k.useState(!1),[l,i]=k.useState({virustotal:!1,abuseipdb:!1,urlhaus:!1}),[o,d]=k.useState(null),u=(()=>{var C;const v=[],g=(e==null?void 0:e.email)||{},p=(e==null?void 0:e.enrichment)||{},x=g.sender;x!=null&&x.domain&&v.push({type:"domain",value:x.domain}),(g.urls||[]).slice(0,5).forEach(P=>{const $=typeof P=="string"?P:P.url;$&&v.push({type:"url",value:$});const z=typeof P=="object"?P.domain:null;z&&!v.find(B=>B.value===z)&&v.push({type:"domain",value:z})});const j=(C=p.originating_ip)==null?void 0:C.ip;return j&&v.push({type:"ip",value:j}),(g.attachments||[]).forEach(P=>{P.sha256&&v.push({type:"hash",value:P.sha256})}),v})();k.useEffect(()=>{h()},[]);const h=async()=>{i({virustotal:!1,abuseipdb:!1,urlhaus:!0})},b=async(v,g)=>{a(!0),d(v);try{await new Promise(x=>setTimeout(x,1e3));const p=[];(g==="url"||g==="domain")&&p.push({source:"URLhaus",indicator:v,indicator_type:g,status:Math.random()>.7?"malicious":"unknown",details:"Database lookup completed",link:`https://urlhaus.abuse.ch/browse.php?search=${encodeURIComponent(v)}`}),l.virustotal&&p.push({source:"VirusTotal",indicator:v,indicator_type:g,status:Math.random()>.5?"malicious":"clean",score:Math.floor(Math.random()*70),details:`${Math.floor(Math.random()*70)}/70 engines detected`,link:g==="hash"?`https://www.virustotal.com/gui/file/${v}`:`https://www.virustotal.com/gui/domain/${v}`}),l.abuseipdb&&g==="ip"&&p.push({source:"AbuseIPDB",indicator:v,indicator_type:g,status:Math.random()>.6?"malicious":"clean",score:Math.floor(Math.random()*100),details:"Abuse confidence score",link:`https://www.abuseipdb.com/check/${v}`}),r(x=>[...x.filter(N=>N.indicator!==v),...p])}catch(p){console.error("TI lookup failed:",p)}finally{a(!1)}},w=v=>{switch(v){case"malicious":return"bg-red-900/50 text-red-400 border border-red-700";case"suspicious":return"bg-orange-900/50 text-orange-400 border border-orange-700";case"clean":return"bg-green-900/50 text-green-400 border border-green-700";default:return"bg-gray-700 text-gray-400"}},f=v=>{switch(v){case"malicious":return t.jsx(at,{className:"w-4 h-4 text-red-500"});case"suspicious":return t.jsx(ae,{className:"w-4 h-4 text-orange-500"});case"clean":return t.jsx(Ce,{className:"w-4 h-4 text-green-500"});default:return t.jsx(Ts,{className:"w-4 h-4 text-gray-400"})}},y=v=>{switch(v){case"domain":return t.jsx(Ke,{className:"w-4 h-4"});case"url":return t.jsx(sd,{className:"w-4 h-4"});case"ip":return t.jsx(vt,{className:"w-4 h-4"});case"hash":return t.jsx(et,{className:"w-4 h-4"});default:return t.jsx(Ze,{className:"w-4 h-4"})}};return t.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 shadow-sm",children:[t.jsxs("div",{className:"p-4 border-b border-gray-700 bg-gray-800",children:[t.jsxs("h2",{className:"text-xl font-bold flex items-center gap-2 text-gray-100",children:[t.jsx(oe,{className:"w-6 h-6 text-purple-400"}),"Threat Intelligence"]}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Look up IOCs against threat intelligence databases"})]}),t.jsx("div",{className:"p-4 bg-gray-900 border-b",children:t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("span",{className:"text-sm font-medium text-gray-400",children:"Data Sources:"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${l.virustotal?"bg-green-500":"bg-gray-300"}`}),t.jsx("span",{className:`text-sm ${l.virustotal?"text-gray-300":"text-gray-400"}`,children:"VirusTotal"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${l.abuseipdb?"bg-green-500":"bg-gray-300"}`}),t.jsx("span",{className:`text-sm ${l.abuseipdb?"text-gray-300":"text-gray-400"}`,children:"AbuseIPDB"})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${l.urlhaus?"bg-green-500":"bg-gray-300"}`}),t.jsx("span",{className:`text-sm ${l.urlhaus?"text-gray-300":"text-gray-400"}`,children:"URLhaus"})]}),!l.virustotal&&!l.abuseipdb&&t.jsx("span",{className:"text-xs text-orange-600 ml-auto",children:"Configure API keys in Settings for full functionality"})]})}),t.jsxs("div",{className:"p-4",children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-300 mb-3",children:["Extracted Indicators (",u.length,")"]}),u.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-400",children:[t.jsx(Ze,{className:"w-12 h-12 mx-auto mb-2 text-gray-300"}),t.jsx("p",{children:"No IOCs extracted from this email"})]}):t.jsx("div",{className:"space-y-2",children:u.map((v,g)=>{const p=s.filter(j=>j.indicator===v.value),x=n&&o===v.value,N=p.length>0;return t.jsxs("div",{className:"border border-gray-700 rounded-lg",children:[t.jsxs("div",{className:"p-3 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("span",{className:`p-1.5 rounded ${v.type==="domain"?"bg-blue-900/50 text-blue-400":v.type==="url"?"bg-purple-900/50 text-purple-400":v.type==="ip"?"bg-green-900/50 text-green-400":"bg-orange-900/50 text-orange-400"}`,children:y(v.type)}),t.jsxs("div",{children:[t.jsx("div",{className:"font-mono text-sm truncate max-w-md",title:v.value,children:v.value.length>50?v.value.slice(0,50)+"...":v.value}),t.jsx("div",{className:"text-xs text-gray-400 uppercase",children:v.type})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[p.map((j,S)=>t.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${w(j.status)}`,title:`${j.source}: ${j.status}`,children:j.source.slice(0,2)},S)),t.jsxs("button",{onClick:()=>b(v.value,v.type),disabled:x,className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-600 text-white rounded hover:bg-indigo-700 text-sm disabled:opacity-50",children:[x?t.jsx(Np,{className:"w-4 h-4 animate-spin"}):N?t.jsx(Ns,{className:"w-4 h-4"}):t.jsx(Br,{className:"w-4 h-4"}),x?"Looking up...":N?"Refresh":"Lookup"]})]})]}),p.length>0&&t.jsx("div",{className:"border-t border-gray-700 bg-gray-900 p-3 space-y-2",children:p.map((j,S)=>t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[f(j.status),t.jsx("span",{className:"font-medium",children:j.source}),t.jsx("span",{className:"text-gray-400",children:j.details})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[j.score!==void 0&&t.jsxs("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${w(j.status)}`,children:["Score: ",j.score]}),j.link&&t.jsx("a",{href:j.link,target:"_blank",rel:"noopener noreferrer",className:"text-indigo-400 hover:text-indigo-300",children:t.jsx(Ye,{className:"w-4 h-4"})})]})]},S))})]},g)})})]}),t.jsxs("div",{className:"p-4 border-t border-gray-700 bg-gray-900",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"Manual Lookup"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("input",{type:"text",placeholder:"Enter domain, IP, URL, or hash...",className:"flex-1 px-3 py-2 border border-gray-600 rounded-lg text-sm bg-gray-800 text-gray-200 placeholder-gray-500",onKeyDown:v=>{if(v.key==="Enter"){const g=v.target.value.trim();if(g){let p="domain";g.match(/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/)?p="ip":g.match(/^https?:\/\//)?p="url":g.match(/^[a-f0-9]{32,64}$/i)&&(p="hash"),b(g,p)}}}}),t.jsx("button",{className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 text-sm",children:t.jsx(Br,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"p-4 border-t border-gray-700",children:[t.jsx("h3",{className:"text-sm font-medium text-gray-300 mb-2",children:"External Resources"}),t.jsx("div",{className:"flex flex-wrap gap-2",children:[{name:"VirusTotal",url:"https://www.virustotal.com/"},{name:"AbuseIPDB",url:"https://www.abuseipdb.com/"},{name:"URLhaus",url:"https://urlhaus.abuse.ch/"},{name:"MalwareBazaar",url:"https://bazaar.abuse.ch/"},{name:"ThreatFox",url:"https://threatfox.abuse.ch/"},{name:"Shodan",url:"https://www.shodan.io/"}].map(({name:v,url:g})=>t.jsxs("a",{href:g,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 text-sm",children:[v,t.jsx(Ye,{className:"w-3 h-3"})]},v))})]})]})},Rj=({analysisResult:e,isOpen:s,onClose:r})=>{var h,b,w,f,y,v,g,p,x,N,j;const[n,a]=k.useState("tools"),[l,i]=k.useState(!1);if(!s)return null;const o=((w=(b=(h=e==null?void 0:e.email)==null?void 0:h.sender)==null?void 0:b.email)==null?void 0:w.includes("url@analysis"))||((y=(f=e==null?void 0:e.email)==null?void 0:f.subject)==null?void 0:y.toLowerCase().includes("url analysis")),d=((p=(g=(v=e==null?void 0:e.email)==null?void 0:v.sender)==null?void 0:g.email)==null?void 0:p.includes("sms@analysis"))||((N=(x=e==null?void 0:e.email)==null?void 0:x.subject)==null?void 0:N.toLowerCase().includes("sms analysis")),c=o||d,u=[{id:"tools",label:"SOC Tools",icon:t.jsx(bp,{className:"w-4 h-4"})},{id:"executive",label:"Executive Summary",icon:t.jsx(Kl,{className:"w-4 h-4"})},{id:"timeline",label:c?"Analysis Flow":"Email Timeline",icon:t.jsx(os,{className:"w-4 h-4"})},{id:"threatintel",label:"Threat Intel",icon:t.jsx(Ze,{className:"w-4 h-4"})}];return t.jsxs("div",{className:"fixed inset-0 z-50 flex",children:[t.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm hidden md:block",onClick:r}),t.jsxs("div",{className:`relative md:ml-auto bg-gray-800 h-full shadow-2xl transition-all duration-300 flex flex-col w-full md:w-[90%] md:max-w-6xl ${l?"md:w-16":""}`,children:[t.jsx("button",{onClick:()=>i(!l),className:"absolute -left-4 top-1/2 transform -translate-y-1/2 w-8 h-8 bg-indigo-600 rounded-full items-center justify-center text-white shadow-lg hover:bg-indigo-700 z-10 hidden md:flex",children:l?t.jsx(td,{className:"w-4 h-4"}):t.jsx(Fr,{className:"w-4 h-4"})}),l?t.jsxs("div",{className:"hidden md:flex flex-col items-center py-4 gap-4",children:[t.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-700 rounded-lg",children:t.jsx(ws,{className:"w-5 h-5 text-gray-400"})}),u.map(S=>t.jsx("button",{onClick:()=>{a(S.id),i(!1)},className:`p-2 rounded-lg transition-colors ${n===S.id?"bg-indigo-100 text-indigo-600":"hover:bg-gray-700 text-gray-400"}`,title:S.label,children:S.icon},S.id))]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center justify-between px-4 md:px-6 py-3 md:py-4 border-b bg-gradient-to-r from-indigo-600 to-purple-600 text-white",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[t.jsx(oe,{className:"w-5 h-5 md:w-6 md:h-6"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg md:text-xl font-bold",children:"SOC Toolkit"}),t.jsx("p",{className:"text-xs md:text-sm text-indigo-200 hidden sm:block",children:"Incident investigation & response"})]})]}),t.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-800/10 rounded-lg transition",children:t.jsx(ws,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"flex border-b bg-gray-900 px-2 md:px-4 overflow-x-auto hide-scrollbar",children:u.map(S=>t.jsxs("button",{onClick:()=>a(S.id),className:`flex items-center gap-1.5 md:gap-2 px-3 md:px-4 py-2.5 md:py-3 border-b-2 transition-colors whitespace-nowrap text-sm md:text-base ${n===S.id?"border-indigo-600 text-indigo-600 bg-gray-800":"border-transparent text-gray-400 hover:text-gray-200 hover:bg-gray-700"}`,children:[S.icon,t.jsx("span",{className:"font-medium",children:S.label})]},S.id))}),t.jsxs("div",{className:"flex-1 overflow-auto p-3 md:p-6 bg-gray-900",children:[n==="tools"&&t.jsx(Cj,{analysisResult:e}),n==="executive"&&t.jsx(Ej,{analysisResult:e}),n==="timeline"&&t.jsx(Tj,{analysisResult:e}),n==="threatintel"&&t.jsx(Aj,{analysisResult:e})]}),t.jsxs("div",{className:"px-3 md:px-6 py-2 md:py-3 border-t bg-gray-800 text-xs md:text-sm text-gray-400 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-1",children:[t.jsxs("span",{className:"truncate max-w-full",children:["ID: ",((j=e==null?void 0:e.analysis_id)==null?void 0:j.slice(0,8))||"N/A","..."]}),t.jsx("span",{children:e!=null&&e.analyzed_at?new Date(e.analyzed_at).toLocaleString():"N/A"})]})]})]})]})},Lj={technical:{color:"#3b82f6",icon:""},authentication:{color:"#3b82f6",icon:""},social_engineering:{color:"#f59e0b",icon:""},brand_impersonation:{color:"#8b5cf6",icon:""},threat_intel:{color:"#ef4444",icon:""},content:{color:"#10b981",icon:""},infrastructure:{color:"#06b6d4",icon:""},behavioral:{color:"#ec4899",icon:""}},Pj=({isOpen:e,onClose:s,analysisData:r})=>{var N;const[n,a]=k.useState(0),[l,i]=k.useState(new Set),[o,d]=k.useState(!1),[c,u]=k.useState([]),h=r&&(r.score!==void 0||((N=r.rules_triggered)==null?void 0:N.length)),b=(r==null?void 0:r.score)??0,w=(r==null?void 0:r.confidence)??0,f=(r==null?void 0:r.level)||"informational",y=bs.useMemo(()=>r!=null&&r.rules_triggered&&r.rules_triggered.length>0?r.rules_triggered.slice(0,10).map((j,S)=>{var C;return{id:`e${S}`,label:j.description||j.rule_id||`Rule ${S+1}`,category:((C=j.category)==null?void 0:C.toLowerCase())||"content",quality:(j.score||j.weight||50)/100}}):[],[r==null?void 0:r.rules_triggered]),v=bs.useMemo(()=>{if(r!=null&&r.breakdown){const j=r.breakdown;return[{name:"Threat Intel",score:Math.round(j.ti_score||0),weight:j.ti_weight||.4,color:"#ef4444",gradient:"from-red-500 to-orange-500"},{name:"Evidence",score:Math.round(j.evidence_score||0),weight:j.evidence_weight||.35,color:"#3b82f6",gradient:"from-blue-500 to-cyan-500"},{name:"Attack Chains",score:Math.round(j.chain_score||0),weight:j.chain_weight||.18,color:"#f59e0b",gradient:"from-amber-500 to-yellow-500"},{name:"AI Analysis",score:Math.round(j.ai_score||0),weight:j.ai_weight||.12,color:"#8b5cf6",gradient:"from-violet-500 to-purple-500"}].filter(S=>S.score>0||S.weight>0)}return b>0?[{name:"Detection Score",score:b,weight:1,color:"#ef4444",gradient:"from-red-500 to-orange-500"}]:[]},[r==null?void 0:r.breakdown,b]),g=bs.useMemo(()=>r!=null&&r.attackChains&&r.attackChains.length>0?r.attackChains.map(j=>{var S;return{name:((S=j.name)==null?void 0:S.replace(/_/g," "))||"Unknown Chain",confidence:j.confidence||0,icon:j.ti_confirmation?"":""}}):[],[r==null?void 0:r.attackChains]);if(k.useEffect(()=>{if(!e){a(0),i(new Set),d(!1);return}const j=setTimeout(()=>{a(1),y.forEach((P,$)=>{setTimeout(()=>{i(z=>new Set([...z,P.id]))},$*150)})},300),S=setTimeout(()=>a(2),Math.max(1800,y.length*150+500)),C=setTimeout(()=>{a(3),d(!0)},Math.max(2500,y.length*150+1e3));return()=>{clearTimeout(j),clearTimeout(S),clearTimeout(C)}},[e,y.length]),k.useEffect(()=>{if(!e||n<2)return;const j=setInterval(()=>{u(S=>{const C=[...S];return C.length<15&&C.push({id:Date.now(),x:Math.random()*100,y:Math.random()*100,color:["#ef4444","#f59e0b","#8b5cf6","#3b82f6","#10b981"][Math.floor(Math.random()*5)]}),C.slice(-12)})},250);return()=>clearInterval(j)},[e,n]),!e)return null;const p=j=>{switch(j==null?void 0:j.toLowerCase()){case"critical":return"from-red-600 to-red-400";case"high":return"from-orange-600 to-orange-400";case"medium":return"from-yellow-600 to-yellow-400";case"low":return"from-green-600 to-green-400";default:return"from-gray-600 to-gray-400"}},x=j=>{var S;return((S=Lj[j])==null?void 0:S.color)||"#64748b"};return t.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[t.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:s}),t.jsxs("div",{className:"relative w-full max-w-5xl max-h-[90vh] overflow-hidden rounded-2xl bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 border border-slate-700/50 shadow-2xl",children:[t.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:c.map(j=>t.jsx("div",{className:"absolute w-2 h-2 rounded-full opacity-30 animate-ping",style:{left:`${j.x}%`,top:`${j.y}%`,backgroundColor:j.color}},j.id))}),t.jsx("div",{className:"absolute inset-0 opacity-5",style:{backgroundImage:`linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px),
                              linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px)`,backgroundSize:"20px 20px"}}),t.jsx("div",{className:"relative px-6 py-4 border-b border-slate-700/50",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center",children:t.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-bold text-white",children:"Dynamic Intelligent Detection"}),t.jsxs("p",{className:"text-sm text-slate-400",children:["DIDA v3.0  ",h?"Live Analysis Data":"Demo Mode"]})]})]}),t.jsx("button",{onClick:s,className:"p-2 rounded-lg hover:bg-slate-700/50 transition-colors",children:t.jsx("svg",{className:"w-5 h-5 text-slate-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),t.jsxs("div",{className:"relative p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:[!h&&y.length===0&&t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"text-6xl mb-4",children:""}),t.jsx("h3",{className:"text-xl font-bold text-slate-200 mb-2",children:"No Analysis Data"}),t.jsx("p",{className:"text-slate-400 max-w-md mx-auto",children:"Run an analysis first to see how the Dynamic Intelligent Detection Architecture calculates risk scores from evidence, threat intelligence, and attack chain patterns."})]}),(h||y.length>0)&&t.jsxs("div",{className:"grid grid-cols-12 gap-4 mb-8",children:[t.jsxs("div",{className:"col-span-3",children:[t.jsxs("div",{className:"text-sm font-medium text-slate-400 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:"w-2 h-2 rounded-full bg-cyan-400 animate-pulse"}),"Evidence (",y.length,")"]}),t.jsxs("div",{className:"space-y-2 max-h-80 overflow-y-auto pr-2",children:[y.map((j,S)=>t.jsxs("div",{className:`
                        relative px-3 py-2 rounded-lg border transition-all duration-500
                        ${l.has(j.id)?"bg-slate-800/80 border-slate-600 translate-x-0 opacity-100":"bg-slate-800/30 border-slate-700/30 -translate-x-4 opacity-0"}
                      `,style:{transitionDelay:`${S*100}ms`},children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:x(j.category)}}),t.jsx("span",{className:"text-xs text-slate-300 truncate",children:j.label})]}),t.jsx("div",{className:"mt-1 h-1 bg-slate-700 rounded-full overflow-hidden",children:t.jsx("div",{className:"h-full rounded-full transition-all duration-1000",style:{width:l.has(j.id)?`${j.quality*100}%`:"0%",backgroundColor:x(j.category),transitionDelay:`${S*100+300}ms`}})})]},j.id)),y.length===0&&t.jsx("div",{className:"text-sm text-slate-500 italic",children:"No evidence collected"})]})]}),t.jsx("div",{className:"col-span-1 flex items-center justify-center",children:t.jsx("svg",{className:"w-full h-64",viewBox:"0 0 50 200",children:[0,1,2,3,4].map(j=>t.jsxs("g",{children:[t.jsx("path",{d:`M 0 ${30+j*35} Q 25 ${30+j*35}, 50 100`,fill:"none",stroke:`url(#gradient-${j})`,strokeWidth:"2",strokeDasharray:"5,5",className:n>=1?"animate-dash":"opacity-20"}),t.jsx("defs",{children:t.jsxs("linearGradient",{id:`gradient-${j}`,x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:["#3b82f6","#f59e0b","#8b5cf6","#ef4444","#10b981"][j]}),t.jsx("stop",{offset:"100%",stopColor:"#64748b"})]})})]},j))})}),t.jsxs("div",{className:"col-span-4",children:[t.jsxs("div",{className:"text-sm font-medium text-slate-400 mb-3 flex items-center gap-2",children:[t.jsx("span",{className:`w-2 h-2 rounded-full bg-violet-400 ${n>=2?"animate-pulse":"opacity-30"}`}),"Scoring Dimensions"]}),t.jsxs("div",{className:"space-y-3",children:[v.map((j,S)=>t.jsxs("div",{className:`
                        relative p-3 rounded-xl border transition-all duration-500
                        ${n>=2?"bg-slate-800/60 border-slate-600 scale-100 opacity-100":"bg-slate-800/20 border-slate-700/30 scale-95 opacity-30"}
                      `,style:{transitionDelay:`${S*100}ms`},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:j.color}}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:j.name})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:"text-xs text-slate-500",children:[(j.weight*100).toFixed(0),"%"]}),t.jsx("span",{className:`text-sm font-bold bg-gradient-to-r ${j.gradient} bg-clip-text text-transparent`,children:n>=2?j.score:"--"})]})]}),t.jsx("div",{className:"h-2 bg-slate-700/50 rounded-full overflow-hidden",children:t.jsx("div",{className:`h-full rounded-full bg-gradient-to-r ${j.gradient} transition-all duration-1000 ease-out`,style:{width:n>=2?`${Math.min(j.score,100)}%`:"0%",transitionDelay:`${S*150}ms`}})})]},j.name)),v.length===0&&t.jsx("div",{className:"text-sm text-slate-500 italic p-3",children:"No dimension data available"})]}),g.length>0&&t.jsxs("div",{className:"mt-4",children:[t.jsxs("div",{className:"text-sm font-medium text-slate-400 mb-2 flex items-center gap-2",children:[t.jsx("span",{className:`w-2 h-2 rounded-full bg-orange-400 ${n>=2?"animate-pulse":"opacity-30"}`}),"Attack Chains (",g.length,")"]}),t.jsx("div",{className:"space-y-2",children:g.map((j,S)=>t.jsxs("div",{className:`
                            flex items-center justify-between px-3 py-2 rounded-lg
                            bg-gradient-to-r from-orange-500/10 to-red-500/10 border border-orange-500/30
                            transition-all duration-500
                            ${n>=2?"opacity-100 translate-x-0":"opacity-0 translate-x-4"}
                          `,style:{transitionDelay:`${(S+5)*100}ms`},children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-lg",children:j.icon}),t.jsx("span",{className:"text-sm text-slate-300 capitalize",children:j.name})]}),t.jsxs("span",{className:"text-sm font-bold text-orange-400",children:[(j.confidence*100).toFixed(0),"%"]})]},j.name))})]})]}),t.jsx("div",{className:"col-span-1 flex items-center justify-center",children:t.jsxs("svg",{className:"w-full h-64",viewBox:"0 0 50 200",children:[t.jsx("path",{d:"M 0 100 L 50 100",fill:"none",stroke:"url(#score-gradient)",strokeWidth:"3",strokeDasharray:"10,5",className:n>=3?"animate-dash":"opacity-20"}),t.jsx("defs",{children:t.jsxs("linearGradient",{id:"score-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#64748b"}),t.jsx("stop",{offset:"100%",stopColor:"#ef4444"})]})})]})}),t.jsx("div",{className:"col-span-3 flex items-center justify-center",children:t.jsxs("div",{className:`
                    relative w-48 h-48 rounded-2xl
                    bg-gradient-to-br from-slate-800 to-slate-900
                    border border-slate-600
                    flex flex-col items-center justify-center
                    transition-all duration-700
                    ${o?"scale-100 opacity-100":"scale-75 opacity-0"}
                  `,children:[t.jsx("div",{className:`
                      absolute inset-0 rounded-2xl blur-xl opacity-30
                      bg-gradient-to-br ${p(f)}
                    `}),t.jsxs("svg",{className:"absolute inset-0 w-full h-full -rotate-90",children:[t.jsx("circle",{cx:"50%",cy:"50%",r:"45%",fill:"none",stroke:"#334155",strokeWidth:"8"}),t.jsx("circle",{cx:"50%",cy:"50%",r:"45%",fill:"none",stroke:"url(#score-ring-gradient)",strokeWidth:"8",strokeLinecap:"round",strokeDasharray:`${b/100*283} 283`,className:"transition-all duration-1000 ease-out",style:{strokeDasharray:o?`${b/100*283} 283`:"0 283"}}),t.jsx("defs",{children:t.jsxs("linearGradient",{id:"score-ring-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[t.jsx("stop",{offset:"0%",stopColor:"#ef4444"}),t.jsx("stop",{offset:"100%",stopColor:"#f59e0b"})]})})]}),t.jsxs("div",{className:"relative z-10 text-center",children:[t.jsx("div",{className:`text-5xl font-black bg-gradient-to-r ${p(f)} bg-clip-text text-transparent`,children:o?b:"--"}),t.jsx("div",{className:"text-sm font-bold text-slate-400 uppercase tracking-wider mt-1",children:f}),t.jsxs("div",{className:"text-xs text-slate-500 mt-2",children:[(w*100).toFixed(0),"% confidence"]})]})]})})]}),h&&t.jsxs("div",{className:`
                mt-6 p-4 rounded-xl bg-slate-800/50 border border-slate-700/50
                transition-all duration-500
                ${n>=3?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}
              `,children:[t.jsx("div",{className:"text-sm font-medium text-slate-400 mb-3",children:"Scoring Formula"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[t.jsx("span",{className:"text-slate-500",children:"("}),t.jsx("span",{className:"px-2 py-1 rounded bg-slate-700 text-slate-300",children:"Evidence Quality"}),t.jsx("span",{className:"text-slate-500",children:""}),t.jsx("span",{className:"px-2 py-1 rounded bg-blue-500/20 text-blue-400 border border-blue-500/30",children:"Validation"}),t.jsx("span",{className:"text-slate-500",children:""}),t.jsx("span",{className:"px-2 py-1 rounded bg-violet-500/20 text-violet-400 border border-violet-500/30",children:"Correlation"}),t.jsx("span",{className:"text-slate-500",children:") +"}),t.jsx("span",{className:"px-2 py-1 rounded bg-red-500/20 text-red-400 border border-red-500/30",children:"TI Consensus"}),t.jsx("span",{className:"text-slate-500",children:"+"}),t.jsx("span",{className:"px-2 py-1 rounded bg-orange-500/20 text-orange-400 border border-orange-500/30",children:"Chain Bonus"}),t.jsx("span",{className:"text-slate-500",children:"="}),t.jsx("span",{className:"px-3 py-1 rounded-lg bg-gradient-to-r from-red-500 to-orange-500 text-white font-bold",children:b})]})]}),t.jsxs("div",{className:`
              mt-4 p-4 rounded-xl bg-slate-800/30 border border-slate-700/30
              transition-all duration-500 delay-200
              ${n>=3||!h?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}
            `,children:[t.jsx("div",{className:"text-sm font-medium text-slate-300 mb-3",children:"About NiksES Detection Engine"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-xs text-slate-400",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:" "}),t.jsx("span",{className:"text-slate-300",children:"68+ detection rules"})," across 7 categories with MITRE ATT&CK mapping"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:" "}),t.jsx("span",{className:"text-slate-300",children:"7 threat intelligence sources"})," for external validation"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:" "}),t.jsx("span",{className:"text-slate-300",children:"Two-pass AI analysis"})," for intent and correlation"]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-slate-500",children:" "}),t.jsx("span",{className:"text-slate-300",children:"Dynamic scoring"})," with configurable thresholds"]})]})]})]}),t.jsx("div",{className:"relative px-6 py-3 border-t border-slate-700/50 bg-slate-800/30",children:t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[t.jsxs("span",{children:[y.length>0?`${y.length} Evidence  `:"",g.length>0?`${g.length} Chains  `:"",v.length>0?`${v.length} Dimensions`:"No analysis data"]}),t.jsx("span",{children:"NiksES Detection Engine v3.2"})]})})]}),t.jsx("style",{children:`
        @keyframes dash {
          to {
            stroke-dashoffset: -20;
          }
        }
        .animate-dash {
          animation: dash 1s linear infinite;
        }
      `})]})},Mj=({onClose:e})=>{const[s,r]=k.useState(!1),[n,a]=k.useState(!1);k.useEffect(()=>{const i=localStorage.getItem("nikses_quota_warning_dismissed"),o=localStorage.getItem("nikses_quota_warning_date");i?o&&(Date.now()-parseInt(o))/864e5>7&&r(!0):r(!0)},[]);const l=()=>{n&&(localStorage.setItem("nikses_quota_warning_dismissed","true"),localStorage.setItem("nikses_quota_warning_date",Date.now().toString())),r(!1),e==null||e()};return s?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70 backdrop-blur-sm",children:t.jsxs("div",{className:"relative w-full max-w-lg bg-gray-900 border border-yellow-500/30 rounded-xl shadow-2xl shadow-yellow-500/10 overflow-hidden",children:[t.jsxs("div",{className:"bg-gradient-to-r from-yellow-500/20 via-orange-500/20 to-red-500/20 px-6 py-4 border-b border-yellow-500/20",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-yellow-500/20 rounded-lg",children:t.jsx(ae,{className:"w-6 h-6 text-yellow-400"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-yellow-400",children:" Free Tier API Quota Notice"}),t.jsx("p",{className:"text-sm text-gray-400",children:"Please read before analyzing"})]})]}),t.jsx("button",{onClick:l,className:"absolute top-4 right-4 p-1 text-gray-400 hover:text-white hover:bg-gray-700 rounded-lg transition-colors",children:t.jsx(ws,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"px-6 py-5 space-y-4",children:[t.jsx("div",{className:"p-4 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:t.jsxs("p",{className:"text-yellow-200 font-medium",children:["This instance uses ",t.jsx("span",{className:"text-yellow-400 font-bold",children:"FREE TIER"})," threat intelligence APIs with limited daily quotas."]})}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider",children:"Daily Limits (Approximate)"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsx(sl,{name:"VirusTotal",limit:"4/min, ~500/day",color:"blue"}),t.jsx(sl,{name:"IPQualityScore",limit:"~200/day",color:"purple"}),t.jsx(sl,{name:"AbuseIPDB",limit:"~1000/day",color:"green"}),t.jsx(sl,{name:"URLScan.io",limit:"~50/day",color:"orange"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("h3",{className:"text-sm font-semibold text-gray-300 uppercase tracking-wider flex items-center gap-2",children:[t.jsx(gt,{className:"w-4 h-4 text-blue-400"}),"Smart Usage Tips"]}),t.jsxs("ul",{className:"space-y-2 text-sm text-gray-400",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-400 mt-0.5",children:""}),t.jsx("span",{children:"System auto-filters safe URLs (images, tracking, known domains)"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-400 mt-0.5",children:""}),t.jsx("span",{children:"Only suspicious URLs are sent to threat intel APIs"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-400 mt-0.5",children:""}),t.jsx("span",{children:"Analyze important/suspicious emails first"})]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-400 mt-0.5",children:""}),t.jsx("span",{children:"For production use, consider upgrading API plans"})]})]})]}),t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:[t.jsx(oe,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),t.jsx("p",{className:"text-sm text-blue-200",children:"AI analysis and detection rules work without external APIs and have no quota limits."})]})]}),t.jsxs("div",{className:"px-6 py-4 bg-gray-800/50 border-t border-gray-700 flex items-center justify-between",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer group",children:[t.jsx("input",{type:"checkbox",checked:n,onChange:i=>a(i.target.checked),className:"w-4 h-4 rounded border-gray-600 bg-gray-700 text-blue-500 focus:ring-blue-500 focus:ring-offset-0 cursor-pointer"}),t.jsx("span",{className:"text-sm text-gray-400 group-hover:text-gray-300",children:"Don't show for 7 days"})]}),t.jsx("button",{onClick:l,className:"px-5 py-2 bg-blue-600 hover:bg-blue-500 text-white font-medium rounded-lg transition-colors flex items-center gap-2",children:"I Understand"})]})]})}):null},sl=({name:e,limit:s,color:r})=>{const n={blue:"bg-blue-500/10 border-blue-500/20 text-blue-400",purple:"bg-purple-500/10 border-purple-500/20 text-purple-400",green:"bg-green-500/10 border-green-500/20 text-green-400",orange:"bg-orange-500/10 border-orange-500/20 text-orange-400"};return t.jsxs("div",{className:`p-3 rounded-lg border ${n[r]}`,children:[t.jsx("div",{className:"font-medium text-sm",children:e}),t.jsx("div",{className:"text-xs text-gray-400 mt-0.5",children:s})]})},$j=e=>typeof e=="number"?e:e&&typeof e=="object"&&"overall_score"in e?e.overall_score:0;function Dj(){var re,V,ee,Ae,te,Os,zs,Us,Fs,Bs,Hs,Vs,Pe,kt,qs,En,Tn,An,Rn,Ln,Pn,Mn;const[e,s]=k.useState(null),[r,n]=k.useState(!1),[a,l]=k.useState(null),[i,o]=k.useState(null),[d,c]=k.useState(!1),[u,h]=k.useState(!1),[b,w]=k.useState(!1),[f,y]=k.useState(!1),[v,g]=k.useState(!1),[p,x]=k.useState(!1),[N,j]=k.useState(!1),[S,C]=k.useState(!1),[P,$]=k.useState(null),[z,B]=k.useState(!1),[de,xe]=k.useState(!1),[be,ue]=k.useState("email"),[se,ke]=k.useState(""),[_,I]=k.useState("sms"),[E,F]=k.useState(null);k.useEffect(()=>{(async()=>{try{const le=await Ie.get("/settings");$(le.data)}catch(le){console.error("Failed to load initial settings:",le)}})()},[]);const[J,R]=k.useState(tl()),[A,D]=k.useState(!1),[q,T]=k.useState(!1),[Y,ve]=k.useState("email"),Le=k.useCallback(W=>{W.preventDefault(),W.stopPropagation(),W.type==="dragenter"||W.type==="dragover"?j(!0):W.type==="dragleave"&&j(!1)},[]),ut=k.useCallback(W=>{if(W.preventDefault(),W.stopPropagation(),j(!1),W.dataTransfer.files&&W.dataTransfer.files[0]){const le=W.dataTransfer.files[0];le.name.endsWith(".eml")||le.name.endsWith(".msg")?(s(le),l(null),D(!1),R(tl())):ie.error("Please upload a .eml or .msg file")}},[]),he=k.useCallback(W=>{W.target.files&&W.target.files[0]&&(s(W.target.files[0]),l(null),D(!1),R(tl()))},[]),Ge=()=>{const W=[{id:"parse",delay:300},{id:"urls",delay:400},{id:"attachments",delay:350},{id:"auth",delay:300},{id:"enrichment",delay:800},{id:"geoip",delay:250},{id:"detection",delay:500},{id:"scoring",delay:200},{id:"ai",delay:1e3},{id:"report",delay:200}];let le=0;return W.forEach(Ee=>{setTimeout(()=>{R(fe=>fe.map(ce=>ce.id===Ee.id?{...ce,status:"running"}:ce))},le),le+=Ee.delay,setTimeout(()=>{R(fe=>fe.map(ce=>ce.id===Ee.id?{...ce,status:"success",duration:Ee.delay}:ce))},le)}),le},Q=async()=>{if(!e){ie.error("Please select a file first");return}n(!0),T(!0),l(null),o(null),D(!1),ve("email"),R(tl());const W=Ge(),le=new FormData;le.append("file",e),le.append("enable_enrichment","true"),le.append("enable_ai","true");try{const fe=(await Ie.post("/analyze",le,{headers:{"Content-Type":"multipart/form-data"}})).data;setTimeout(()=>{try{if(!fe)throw new Error("Empty response from server");o(fe);const ce=fe.detection||fe.detection_results||{},Ne={...ce,risk_score:fe.overall_score??$j(fe.risk_score)??ce.risk_score??0,risk_level:fe.overall_level??ce.risk_level??"unknown",primary_classification:fe.classification??ce.primary_classification??"unknown",confidence:ce.confidence??.5,rules_triggered:ce.rules_triggered||[]},Mt=fe.email||fe.parsed_email||{},we=fe.iocs||{domains:[],urls:[],ips:[],email_addresses:[],file_hashes_sha256:[]},us={...fe,email:Mt,detection:Ne,iocs:we};l(us),D(!0),ie.success("Analysis complete!")}catch(ce){console.error("Error processing analysis result:",ce),ie.error("Error displaying results: "+(ce instanceof Error?ce.message:"Unknown error"))}},Math.max(0,W-500))}catch(Ee){R(fe=>fe.map(ce=>ce.status==="running"||ce.status==="pending"?{...ce,status:"error"}:ce)),ie.error(Ee.message||"Failed to analyze email"),console.error("Analysis error:",Ee)}finally{setTimeout(()=>{n(!1)},W)}},H=async()=>{var ce,Ne,Mt,we,us,Ws,Ks,Qs,Gs;if(!se.trim()){ie.error(_==="url"?"Please enter URL(s) to analyze":"Please enter a message to analyze");return}const W=_==="url",le=W?"url":"sms";n(!0),l(null),o(null),F(null),D(!1),T(!0),ve(le),R(Y0(le));const Ee=[{id:"parse",delay:100},{id:"patterns",delay:200},{id:"enrichment",delay:400},{id:"sandbox",delay:500},{id:"scoring",delay:150},{id:"ai",delay:500},{id:"report",delay:100}];let fe=0;Ee.forEach(Xe=>{setTimeout(()=>{R(pe=>pe.map(mt=>mt.id===Xe.id?{...mt,status:"running"}:mt))},fe),fe+=Xe.delay,setTimeout(()=>{R(pe=>pe.map(mt=>mt.id===Xe.id?{...mt,status:"success",duration:Xe.delay}:mt))},fe)});try{console.log("Starting text analysis...",{textSource:_,isUrlMode:W});const Xe=await Ie.post("/analyze/text",{text:se,sender:"",source:_,enable_url_enrichment:!0,enable_ai_analysis:!0,enable_url_sandbox:W});console.log("API Response received:",Xe.status,Xe.data);const pe=Xe.data;if(!pe||!pe.analysis_id)throw new Error("Invalid response: missing analysis_id");F(pe);const mt=W?"URL":(_||"text").toUpperCase(),Xs=((ce=pe.urls_found)==null?void 0:ce.length)||0;let es;try{es={analysis_id:pe.analysis_id||"unknown",analyzed_at:pe.analyzed_at||new Date().toISOString(),analysis_duration_ms:500,email:{subject:W?`URL Analysis: ${Xs} URL(s) analyzed`:`${mt} Message Analysis`,sender:{email:W?"url@analysis":"unknown@sms",display_name:W?"URL Scanner":`${mt} Sender`,domain:W?"analysis":"sms"},recipients:{to:["security@analysis"]},body_text:pe.original_text||se||"",urls:(pe.urls_found||[]).map(it=>({url:it,display_text:it})),attachments:[]},authentication:{},detection:{risk_score:pe.overall_score||0,risk_level:pe.overall_level||"unknown",verdict:pe.is_threat?"malicious":"clean",primary_classification:pe.classification||"unknown",confidence:pe.confidence||0,rules_triggered:(pe.patterns_matched||[]).map(it=>({rule_id:it.pattern_id||"unknown",name:it.name||"Unknown Pattern",description:it.description||"",severity:it.severity||"low",category:W?"url_threat":"smishing",mitre_technique:it.mitre_technique||""}))},iocs:{domains:pe.domains_found||[],urls:pe.urls_found||[],ips:pe.ips_found||[],email_addresses:[],file_hashes_sha256:[]},ai_triage:{enabled:((Ne=pe.ai_analysis)==null?void 0:Ne.enabled)||!1,provider:((Mt=pe.ai_analysis)==null?void 0:Mt.provider)||"pattern-matching",summary:((we=pe.ai_analysis)==null?void 0:we.summary)||(pe.is_threat?` ${(pe.classification||"threat").replace(/_/g," ").toUpperCase()} detected with ${pe.overall_score||0}% threat score.`:" No significant threats detected."),key_findings:((us=pe.ai_analysis)==null?void 0:us.key_findings)||pe.threat_indicators||[],recommendations:((Ws=pe.ai_analysis)==null?void 0:Ws.recommendations)||pe.recommendations||[],recommended_actions:W?[{action:"block_url",label:"Block URL(s)",priority:"high"},{action:"report_phishing",label:"Report to PhishTank",priority:"medium"}]:[]}},console.log("PseudoEmailResult constructed:",es.analysis_id)}catch(it){throw console.error("Error building pseudoEmailResult:",it),new Error(`Failed to process analysis result: ${it}`)}l(es),o(es),D(!0),console.log("Analysis complete, result set:",es.analysis_id);const Ys=pe.is_threat?" Threats detected!":" No threats";ie.success(W?`${Xs} URL(s) analyzed - ${Ys}`:`Analysis complete - ${Ys}`)}catch(Xe){console.error("Analysis error:",Xe),console.error("Error response:",(Ks=Xe.response)==null?void 0:Ks.data),T(!1),R(Y0(le));const pe=((Gs=(Qs=Xe.response)==null?void 0:Qs.data)==null?void 0:Gs.detail)||Xe.message||"Failed to analyze";ie.error(pe)}finally{n(!1)}},ge=async W=>{if(a)try{const Ee=(await Ie.get(`/export/${a.analysis_id}/${W}`,{responseType:"blob"})).data,fe=window.URL.createObjectURL(Ee),ce=document.createElement("a");ce.href=fe;const Mt={json:"json",markdown:"md",pdf:"pdf","executive-pdf":"pdf","summary-pdf":"pdf",stix:"json",iocs:"txt",rules:"json"}[W]||W,we=W.includes("pdf")?W.replace("-pdf","_report"):W;ce.download=`analysis_${a.analysis_id}_${we}.${Mt}`,ce.click(),window.URL.revokeObjectURL(fe),ie.success(`Exported as ${W.toUpperCase()}`)}catch{ie.error("Export failed")}},O=W=>{w(!1),y(!0)},Z=()=>{if(!a)return null;try{const W=a.email||{},le=a.detection||{},Ee=a.iocs||{},fe=we=>typeof we=="number"?we:we&&typeof we=="object"&&"overall_score"in we?we.overall_score:0,ce=String(a.overall_level||le.risk_level||"unknown").toLowerCase(),Ne=we=>Array.isArray(we)?we:[];return{...a,analysis_id:a.analysis_id||"unknown",analyzed_at:a.analyzed_at||new Date().toISOString(),analysis_duration_ms:a.analysis_duration_ms||0,email:{...W,subject:W.subject||"(No Subject)",sender:W.sender||{email:"unknown"},urls:Ne(W.urls),attachments:Ne(W.attachments)},detection:{...le,risk_score:fe(a.overall_score)||fe(a.risk_score)||fe(le.risk_score)||0,risk_level:ce,verdict:ce==="critical"||ce==="high"?"malicious":ce==="medium"?"suspicious":"clean",rules_triggered:Ne(le.rules_triggered)},urls:Ne(W.urls),attachments:Ne(W.attachments),authentication:a.authentication||{spf:{result:"none",details:"Not checked"},dkim:{result:"none",details:"Not checked"},dmarc:{result:"none",details:"Not checked"}},ai_analysis:a.ai_triage?{enabled:!0,provider:"Claude",summary:a.ai_triage.summary||"",key_findings:Ne(a.ai_triage.key_findings),recommendations:Ne(a.ai_triage.recommendations)||Ne(a.ai_triage.recommended_actions).map(we=>typeof we=="string"?we:(we==null?void 0:we.description)||(we==null?void 0:we.action)||""),mitre_techniques:Ne(a.ai_triage.mitre_techniques)}:null,iocs:{domains:Ne(Ee.domains),ips:Ne(Ee.ips),urls:Ne(Ee.urls),hashes:Ne(Ee.file_hashes_sha256).map(we=>({type:"SHA256",value:we})).concat(Ne(Ee.hashes)),emails:Ne(Ee.email_addresses)}}}catch(W){return console.error("getTransformedResult error:",W),{...a,email:(a==null?void 0:a.email)||{},detection:(a==null?void 0:a.detection)||{risk_score:0,risk_level:"unknown",verdict:"unknown",rules_triggered:[]},iocs:{domains:[],ips:[],urls:[],hashes:[],emails:[]}}}};return t.jsxs("div",{className:"min-h-screen bg-slate-900 text-white has-bottom-nav",children:[t.jsx(xy,{position:"top-right"}),t.jsx(Mj,{}),t.jsxs("header",{className:"mobile-header h-14 md:h-16 bg-slate-800 border-b border-slate-700 flex items-center justify-between px-3 md:px-6",children:[t.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[t.jsx("div",{className:"w-8 h-8 md:w-10 md:h-10 bg-blue-600 rounded-lg flex items-center justify-center",children:t.jsx(oe,{className:"w-5 h-5 md:w-6 md:h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-lg md:text-xl font-bold",children:"NiksES"}),t.jsx("p",{className:"text-[10px] md:text-xs text-slate-400 hidden sm:block",children:"Email & SMS Security"})]})]}),t.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[t.jsx(_j,{settings:P,onOpenSettings:()=>c(!0)}),t.jsx("div",{className:"w-px h-8 bg-slate-700 mx-1"}),t.jsxs("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 rounded-lg transition flex items-center gap-2",children:[t.jsx(fl,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Dashboard"})]}),t.jsxs("button",{onClick:()=>xe(!0),className:"px-4 py-2 bg-gradient-to-r from-cyan-600 to-blue-600 hover:from-cyan-500 hover:to-blue-500 rounded-lg transition flex items-center gap-2 group",title:"View Detection Engine Architecture",children:[t.jsx(gt,{className:"w-4 h-4 group-hover:animate-pulse"}),t.jsx("span",{className:"text-sm",children:"DIDA Engine"})]}),t.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition flex items-center gap-2",children:[t.jsx(Ze,{className:"w-4 h-4 text-green-400"}),t.jsx("span",{className:"text-sm",children:"History"})]}),a&&t.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg transition flex items-center gap-2 animate-pulse",children:[t.jsx(Ot,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"SOC Tools"})]}),t.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 rounded-lg transition flex items-center gap-2",children:[t.jsx(Go,{className:"w-4 h-4 text-blue-400"}),t.jsx("span",{className:"text-sm",children:"Custom Rules"})]}),t.jsx("button",{onClick:()=>c(!0),className:"p-2 hover:bg-slate-700 rounded-lg transition",title:"Settings",children:t.jsx(jn,{className:"w-5 h-5 text-slate-400"})}),t.jsx("button",{onClick:()=>C(!S),className:`p-2 rounded-lg transition text-xs ${S?"bg-yellow-600":"hover:bg-slate-700"}`,title:"Toggle Debug Mode",children:""})]}),t.jsxs("div",{className:"flex md:hidden items-center gap-2",children:[a&&t.jsx("button",{onClick:()=>x(!0),className:"p-2 bg-purple-600 rounded-lg animate-pulse",children:t.jsx(Ot,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>c(!0),className:"p-2 hover:bg-slate-700 rounded-lg transition",children:t.jsx(jn,{className:"w-5 h-5 text-slate-400"})}),t.jsx("button",{onClick:()=>B(!z),className:"p-2 hover:bg-slate-700 rounded-lg transition",children:z?t.jsx(ws,{className:"w-5 h-5"}):t.jsx(Sy,{className:"w-5 h-5"})})]})]}),z&&t.jsx("div",{className:"md:hidden bg-slate-800 border-b border-slate-700 animate-fade-in",children:t.jsxs("div",{className:"p-3 space-y-2",children:[t.jsxs("button",{onClick:()=>{w(!0),B(!1)},className:"w-full px-4 py-3 bg-indigo-600 hover:bg-indigo-700 rounded-lg transition flex items-center gap-3",children:[t.jsx(fl,{className:"w-5 h-5"}),t.jsx("span",{children:"Dashboard"})]}),t.jsxs("button",{onClick:()=>{g(!0),B(!1)},className:"w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition flex items-center gap-3",children:[t.jsx(Ze,{className:"w-5 h-5 text-green-400"}),t.jsx("span",{children:"History"})]}),t.jsxs("button",{onClick:()=>{h(!0),B(!1)},className:"w-full px-4 py-3 bg-slate-700 hover:bg-slate-600 rounded-lg transition flex items-center gap-3",children:[t.jsx(Go,{className:"w-5 h-5 text-blue-400"}),t.jsx("span",{children:"Custom Rules"})]}),P&&t.jsxs("div",{className:"px-4 py-2 bg-slate-700/50 rounded-lg",children:[t.jsx("div",{className:"text-xs text-slate-400 mb-1",children:"API Status"}),t.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[t.jsx("span",{className:`w-2 h-2 rounded-full ${Object.values(P.api_keys_configured).filter(Boolean).length>0?"bg-green-500":"bg-yellow-500"}`}),t.jsxs("span",{children:[Object.values(P.api_keys_configured).filter(Boolean).length,"/",Object.keys(P.api_keys_configured).length," APIs"]})]})]})]})}),t.jsx("nav",{className:"mobile-bottom-nav",children:t.jsxs("div",{className:"flex items-center justify-around",children:[t.jsxs("button",{onClick:()=>{w(!1),g(!1),y(!1)},className:`mobile-nav-item ${!b&&!v&&!f?"active":""}`,children:[t.jsx(_y,{className:"w-5 h-5"}),t.jsx("span",{children:"Analyze"})]}),t.jsxs("button",{onClick:()=>w(!0),className:`mobile-nav-item ${b?"active":""}`,children:[t.jsx(fl,{className:"w-5 h-5"}),t.jsx("span",{children:"Dashboard"})]}),t.jsxs("button",{onClick:()=>g(!0),className:`mobile-nav-item ${v?"active":""}`,children:[t.jsx(vp,{className:"w-5 h-5"}),t.jsx("span",{children:"History"})]}),a&&t.jsxs("button",{onClick:()=>y(!0),className:`mobile-nav-item ${f?"active":""}`,children:[t.jsx(et,{className:"w-5 h-5"}),t.jsx("span",{children:"Results"})]})]})}),S&&t.jsxs("div",{className:"bg-yellow-900/50 border-b border-yellow-600 px-6 py-2 text-xs font-mono",children:[t.jsxs("div",{className:"max-w-7xl mx-auto flex flex-wrap gap-4 text-yellow-200",children:[t.jsxs("span",{children:["result: ",a?"":""]}),t.jsxs("span",{children:["enhancedResult: ",i?"":""]}),t.jsxs("span",{children:["loading: ",r?"yes":"no"]}),t.jsxs("span",{children:["analysisComplete: ",A?"yes":"no"]}),a&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{children:["email: ",a.email?"":""]}),t.jsxs("span",{children:["detection: ",a.detection?"":""]}),t.jsxs("span",{children:["iocs: ",a.iocs?"":""]})]})]}),a&&t.jsxs("details",{className:"mt-2",children:[t.jsx("summary",{className:"cursor-pointer text-yellow-300",children:"Show Raw Result"}),t.jsx("pre",{className:"mt-1 max-h-40 overflow-auto text-yellow-100 bg-black/30 p-2 rounded",children:JSON.stringify(a,null,2).slice(0,2e3)})]})]}),P&&t.jsx(kj,{configuredCount:Object.values(P.api_keys_configured).filter(Boolean).length,totalCount:6,onOpenSettings:()=>c(!0)}),t.jsxs("main",{className:"max-w-7xl mx-auto px-3 md:px-6 py-4 md:py-8",children:[t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[t.jsxs("div",{className:"space-y-4 md:space-y-6",children:[t.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 md:p-6 border border-slate-700",children:[t.jsxs("div",{className:"flex gap-2 mb-4",children:[t.jsxs("button",{onClick:()=>ue("email"),className:`flex-1 py-2.5 md:py-2 px-3 md:px-4 rounded-lg font-medium transition flex items-center justify-center gap-2 ${be==="email"?"bg-blue-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[t.jsx(Ut,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium text-sm md:text-base",children:"Email"})]}),t.jsxs("button",{onClick:()=>ue("sms"),className:`flex-1 py-2.5 md:py-2 px-3 md:px-4 rounded-lg font-medium transition flex items-center justify-center gap-2 ${be==="sms"?"bg-green-600 text-white":"bg-slate-700 text-slate-300 hover:bg-slate-600"}`,children:[t.jsx(ec,{className:"w-4 h-4"}),t.jsx("span",{className:"font-medium",children:"SMS / Message"})]})]}),be==="email"?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:`border-2 border-dashed rounded-xl p-8 text-center transition-all ${N?"border-blue-500 bg-blue-500/10":"border-slate-600 hover:border-slate-500"}`,onDragEnter:Le,onDragLeave:Le,onDragOver:Le,onDrop:ut,children:[t.jsx("input",{type:"file",accept:".eml,.msg",onChange:he,className:"hidden",id:"file-upload"}),t.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer",children:t.jsx("div",{className:"flex flex-col items-center gap-3",children:e?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center",children:t.jsx(Ut,{className:"w-8 h-8 text-green-400"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-lg font-medium text-green-400",children:e.name}),t.jsxs("p",{className:"text-sm text-slate-400",children:[(e.size/1024).toFixed(1)," KB"]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-16 h-16 bg-slate-700 rounded-full flex items-center justify-center",children:t.jsx(Ey,{className:"w-8 h-8 text-slate-400"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-slate-300",children:"Drop your email file here"}),t.jsx("p",{className:"text-sm text-slate-500",children:"or click to browse (.eml, .msg)"})]})]})})})]}),t.jsxs("div",{className:"mt-4 p-3 bg-slate-700/50 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(gt,{className:"w-4 h-4 text-yellow-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:"Full Email Analysis"})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-1 ml-6",children:"Detection rules, SE analysis, content deconstruction, lookalike detection, TI fusion"})]}),t.jsx("button",{onClick:Q,disabled:!e||r,className:`w-full mt-4 py-3 rounded-lg font-semibold transition flex items-center justify-center gap-2 ${e&&!r?"bg-blue-600 hover:bg-blue-700 text-white":"bg-slate-700 text-slate-400 cursor-not-allowed"}`,children:r?t.jsxs(t.Fragment,{children:[t.jsx(Ns,{className:"w-5 h-5 animate-spin"}),"Analyzing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(oe,{className:"w-5 h-5"}),"Analyze Email"]})})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex gap-2 p-1 bg-slate-900 rounded-lg",children:[t.jsxs("button",{onClick:()=>I("sms"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition flex items-center justify-center gap-2 ${_!=="url"?"bg-green-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[t.jsx(Xt,{className:"w-4 h-4"}),"SMS / Message"]}),t.jsxs("button",{onClick:()=>I("url"),className:`flex-1 py-2 px-3 rounded-md text-sm font-medium transition flex items-center justify-center gap-2 ${_==="url"?"bg-purple-600 text-white":"text-slate-400 hover:text-white hover:bg-slate-700"}`,children:[t.jsx(jt,{className:"w-4 h-4"}),"URL Analysis"]})]}),_!=="url"?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex gap-2",children:[{value:"sms",label:"SMS",icon:ec},{value:"whatsapp",label:"WhatsApp",icon:Xt},{value:"telegram",label:"Telegram",icon:Xt},{value:"other",label:"Other",icon:Xt}].map(({value:W,label:le,icon:Ee})=>t.jsxs("button",{onClick:()=>I(W),className:`flex-1 py-1.5 px-2 rounded-lg text-xs font-medium transition flex items-center justify-center gap-1 ${_===W?"bg-green-600 text-white":"bg-slate-700 text-slate-400 hover:bg-slate-600"}`,children:[t.jsx(Ee,{className:"w-3 h-3"}),le]},W))}),t.jsx("textarea",{value:se,onChange:W=>ke(W.target.value),placeholder:`Paste the suspicious SMS or message text here...

Example: USPS: Your package is held due to unpaid customs fees. Pay $3.99 now: https://usps-delivery.tk/pay`,className:"w-full h-40 p-4 bg-slate-900 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none"}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[t.jsxs("span",{children:[se.length," characters"]}),t.jsx("span",{children:"URLs will be auto-detected and analyzed"})]}),t.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg border border-slate-600",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ae,{className:"w-4 h-4 text-orange-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:"Smishing Detection"})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-1 ml-6",children:"Detects package scams, banking phishing, prize fraud, government impersonation + URL threat intel"})]})]}):t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"text-sm text-slate-300 font-medium",children:"Paste suspicious URL(s)"}),t.jsx("textarea",{value:se,onChange:W=>ke(W.target.value),placeholder:`https://suspicious-site.com/login
https://bit.ly/abc123

One URL per line, or paste multiple URLs`,className:"w-full h-32 p-4 bg-slate-900 border border-slate-600 rounded-xl text-white placeholder-slate-500 focus:ring-2 focus:ring-purple-500 focus:border-purple-500 resize-none font-mono text-sm"})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[t.jsxs("span",{children:[(se.match(/https?:\/\/[^\s]+/gi)||[]).length," URL(s) detected"]}),t.jsx("span",{children:"Supports shortened URLs"})]}),t.jsxs("div",{className:"p-3 bg-slate-700/50 rounded-lg border border-purple-600/50",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(jt,{className:"w-4 h-4 text-purple-400"}),t.jsx("span",{className:"text-sm font-medium text-slate-200",children:"URL Threat Analysis"})]}),t.jsx("p",{className:"text-xs text-slate-400 mt-1 ml-6",children:"VirusTotal, PhishTank, URLhaus, domain reputation, redirect chain analysis"})]})]})]}),t.jsx("button",{onClick:H,disabled:!se.trim()||r,className:`w-full mt-4 py-3 rounded-lg font-semibold transition flex items-center justify-center gap-2 ${se.trim()&&!r?_==="url"?"bg-purple-600 hover:bg-purple-700 text-white":"bg-green-600 hover:bg-green-700 text-white":"bg-slate-700 text-slate-400 cursor-not-allowed"}`,children:r?t.jsxs(t.Fragment,{children:[t.jsx(Ns,{className:"w-5 h-5 animate-spin"}),"Analyzing..."]}):t.jsxs(t.Fragment,{children:[t.jsx(oe,{className:"w-5 h-5"}),_==="url"?"Analyze URL(s)":"Analyze Message"]})})]})]}),q&&t.jsx(vj,{steps:J,isComplete:A,currentStep:((re=J.find(W=>W.status==="running"))==null?void 0:re.id)||"",analysisType:Y})]}),t.jsxs("div",{className:"space-y-6",children:[a?(()=>{try{const W=Z();return t.jsx(Nj,{result:W,onExport:ge,onViewFullAnalysis:()=>y(!0)})}catch(W){return console.error("Error rendering ResultsPanel:",W),t.jsxs("div",{className:"bg-red-900/30 border border-red-500 rounded-xl p-6",children:[t.jsx("h3",{className:"text-red-400 font-semibold",children:"Error Rendering Results"}),t.jsx("p",{className:"text-sm text-red-300 mt-2",children:String(W)}),t.jsx("pre",{className:"mt-2 text-xs text-red-200 overflow-auto max-h-40",children:JSON.stringify(a,null,2).slice(0,500)})]})}})():t.jsxs("div",{className:"bg-slate-800 rounded-xl p-6 border border-slate-700",children:[t.jsxs("h2",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[t.jsx(ae,{className:"w-5 h-5 text-yellow-400"}),"Analysis Results"]}),t.jsxs("div",{className:"text-center py-16",children:[t.jsx(oe,{className:"w-16 h-16 text-slate-600 mx-auto mb-4"}),t.jsx("p",{className:"text-slate-400",children:"No analysis results yet"}),t.jsx("p",{className:"text-sm text-slate-500 mt-1",children:"Upload an email file to get started"})]})]}),a&&t.jsxs("div",{className:"bg-slate-800 rounded-xl p-4 border border-slate-700",children:[t.jsx("h3",{className:"text-sm font-medium text-slate-400 mb-3",children:"Analysis Summary"}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ut,{className:"w-4 h-4 text-blue-400"}),t.jsx("span",{className:"text-slate-300",children:"Email Parsed"}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(jt,{className:"w-4 h-4 text-indigo-400"}),t.jsxs("span",{className:"text-slate-300",children:[((ee=(V=a.email)==null?void 0:V.urls)==null?void 0:ee.length)||0," URLs"]}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(hr,{className:"w-4 h-4 text-green-400"}),t.jsxs("span",{className:"text-slate-300",children:[((te=(Ae=a.email)==null?void 0:Ae.attachments)==null?void 0:te.length)||0," Files"]}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(fs,{className:"w-4 h-4 text-yellow-400"}),t.jsx("span",{className:"text-slate-300",children:"Auth Checked"}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ze,{className:"w-4 h-4 text-purple-400"}),t.jsx("span",{className:"text-slate-300",children:"Threat Intel"}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{className:"w-4 h-4 text-red-400"}),t.jsxs("span",{className:"text-slate-300",children:[((zs=(Os=a.detection)==null?void 0:Os.rules_triggered)==null?void 0:zs.length)||0," Rules"]}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(Ot,{className:"w-4 h-4 text-orange-400"}),t.jsxs("span",{className:"text-slate-300",children:[(((Fs=(Us=a.iocs)==null?void 0:Us.domains)==null?void 0:Fs.length)||0)+(((Hs=(Bs=a.iocs)==null?void 0:Bs.urls)==null?void 0:Hs.length)||0)+(((Pe=(Vs=a.iocs)==null?void 0:Vs.ips)==null?void 0:Pe.length)||0)," IOCs"]}),t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(nt,{className:"w-4 h-4 text-purple-400"}),t.jsx("span",{className:"text-slate-300",children:"AI Analysis"}),a.ai_triage?t.jsx(Ce,{className:"w-4 h-4 text-green-500 ml-auto"}):t.jsx(Ts,{className:"w-4 h-4 text-slate-500 ml-auto"})]})]}),t.jsx("div",{className:"mt-4 pt-3 border-t border-slate-700",children:t.jsxs("p",{className:"text-xs text-slate-500 text-center",children:["Analysis completed in ",a.analysis_duration_ms||0,"ms  ID: ",a.analysis_id||"N/A"]})})]})]})]}),t.jsx("footer",{className:"mt-8 text-center text-sm text-slate-500",children:t.jsx("p",{children:"NiksES v1.0  51 Detection Rules + Custom Rules  AI-Powered Analysis"})})]}),b&&t.jsx(dj,{onViewAnalysis:O,onClose:()=>w(!1)}),t.jsx(Pj,{isOpen:de,onClose:()=>xe(!1),analysisData:a?{score:(kt=a.detection)==null?void 0:kt.risk_score,level:(qs=a.detection)==null?void 0:qs.risk_level,confidence:(En=a.detection)==null?void 0:En.confidence,evidenceCount:(An=(Tn=a.detection)==null?void 0:Tn.rules_triggered)==null?void 0:An.length,rules_triggered:(Rn=a.detection)==null?void 0:Rn.rules_triggered,attackChains:(i==null?void 0:i.attack_chains)||((Ln=a.detection)==null?void 0:Ln.attack_chains),breakdown:(i==null?void 0:i.breakdown)||((Pn=a.detection)==null?void 0:Pn.breakdown),ti_results:(i==null?void 0:i.ti_results)||a.enrichment}:E?{score:E.risk_score,level:E.risk_level,confidence:E.confidence,rules_triggered:(Mn=E.indicators)==null?void 0:Mn.map((W,le)=>({rule_id:`indicator_${le}`,description:W,category:"content",score:50})),attackChains:E.attack_chains,breakdown:E.breakdown}:void 0}),f&&a||E?t.jsx("div",{className:"fixed inset-0 z-50 overflow-auto",children:E?t.jsx("div",{className:"min-h-screen bg-slate-900 p-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold text-white",children:E.analysis_type==="url"?" URL Analysis":" SMS/Message Analysis"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-purple-600 hover:bg-purple-500 text-white rounded-lg transition flex items-center gap-2",children:[t.jsx(oe,{className:"w-4 h-4"}),"SOC Tools"]}),t.jsx("button",{onClick:()=>{y(!1),F(null)},className:"px-4 py-2 bg-slate-700 hover:bg-slate-600 text-white rounded-lg transition",children:" Back"})]})]}),t.jsx(jj,{result:E,onClose:()=>{y(!1),F(null)},onSOCTools:()=>x(!0)})]})}):a?t.jsx(gj,{result:{...a,...i?{se_analysis:i.se_analysis,content_analysis:i.content_analysis,lookalike_analysis:i.lookalike_analysis,ti_results:i.ti_results,risk_score:i.risk_score}:{}},onExport:ge,onBack:()=>y(!1)}):null}):null,t.jsx(wj,{isOpen:d,onClose:()=>c(!1),onSettingsChange:W=>$(W)}),t.jsx(cj,{isOpen:u,onClose:()=>h(!1)}),t.jsx(Sj,{isOpen:v,onClose:()=>g(!1),onViewAnalysis:async(W,le)=>{var Ee,fe,ce,Ne,Mt,we,us,Ws,Ks,Qs,Gs,Xe,pe,mt,Xs,es,Ys,it,$n,Dn,In,On;try{const je=(await Ie.get(`/analyses/${W}`)).data;if(console.log("[History View] Loading analysis:",W,"type:",le),g(!1),le==="url"||le==="sms"){y(!1),l(null);const $a={analysis_id:je.analysis_id||W,analyzed_at:je.analyzed_at||new Date().toISOString(),analysis_type:le,source:le,original_text:((Ee=je.email)==null?void 0:Ee.body_text)||((fe=je.email)==null?void 0:fe.body_html)||"",message_length:(((ce=je.email)==null?void 0:ce.body_text)||"").length,overall_score:je.overall_score??((Ne=je.detection)==null?void 0:Ne.risk_score)??0,overall_level:je.overall_level||((Mt=je.detection)==null?void 0:Mt.risk_level)||"low",classification:je.classification||"unknown",is_threat:(je.overall_score??0)>=50,confidence:((we=je.detection)==null?void 0:we.confidence)??.5,urls_found:(((us=je.email)==null?void 0:us.urls)||[]).map(st=>typeof st=="string"?st:st.url||""),domains_found:((Ws=je.iocs)==null?void 0:Ws.domains)||[],ips_found:((Ks=je.iocs)==null?void 0:Ks.ips)||[],phone_numbers_found:((Qs=je.iocs)==null?void 0:Qs.phone_numbers)||[],url_enrichment:((Gs=je.enrichment)==null?void 0:Gs.urls)||[],url_sandbox:je.sandbox_results||[],patterns_matched:(((Xe=je.detection)==null?void 0:Xe.rules_triggered)||[]).map(st=>({pattern_id:st.rule_id||"unknown",name:st.rule_name||st.name||"Unknown Rule",description:st.description||"",severity:st.severity||"medium",matched_text:Array.isArray(st.evidence)?st.evidence[0]:"",mitre_technique:st.mitre_technique||""})),threat_indicators:(((pe=je.detection)==null?void 0:pe.rules_triggered)||[]).map(st=>st.rule_name||st.name||""),ai_analysis:{enabled:!!je.ai_triage,provider:((mt=je.ai_triage)==null?void 0:mt.provider)||"ai",summary:((Xs=je.ai_triage)==null?void 0:Xs.summary)||"",threat_assessment:((es=je.ai_triage)==null?void 0:es.threat_assessment)||"",key_findings:((Ys=je.ai_triage)==null?void 0:Ys.key_findings)||[],social_engineering_tactics:((it=je.ai_triage)==null?void 0:it.social_engineering_tactics)||[],recommendations:(($n=je.ai_triage)==null?void 0:$n.recommendations)||[],confidence:((Dn=je.ai_triage)==null?void 0:Dn.confidence)??0},recommendations:((In=je.ai_triage)==null?void 0:In.recommendations)||je.recommendations||[],mitre_techniques:((On=je.detection)==null?void 0:On.mitre_techniques)||[]};F($a),window.scrollTo({top:0,behavior:"smooth"})}else F(null),l(je),y(!0)}catch(zn){console.error("[History View] Error:",zn),ie.error("Failed to load analysis")}},onExportAnalysis:async(W,le)=>{try{const fe=(await Ie.get(`/export/${W}/${le}`,{responseType:"blob"})).data,ce=window.URL.createObjectURL(fe),Ne=document.createElement("a");Ne.href=ce,Ne.download=`analysis-${W.slice(0,8)}.${le}`,document.body.appendChild(Ne),Ne.click(),window.URL.revokeObjectURL(ce),Ne.remove(),ie.success(`Exported as ${le.toUpperCase()}`)}catch{ie.error("Export failed")}}}),t.jsx(Rj,{analysisResult:i||a,isOpen:p,onClose:()=>x(!1)})]})}class Ij extends bs.Component{constructor(s){super(s),this.state={hasError:!1,error:null}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,r){console.error("React Error Boundary caught:",s,r)}render(){var s,r;return this.state.hasError?t.jsx("div",{className:"min-h-screen bg-gray-900 flex items-center justify-center p-8",children:t.jsxs("div",{className:"bg-red-900/50 border border-red-500 rounded-lg p-6 max-w-2xl",children:[t.jsx("h1",{className:"text-xl font-bold text-red-400 mb-2",children:"Something went wrong"}),t.jsx("p",{className:"text-gray-300 mb-4",children:"The application encountered an error:"}),t.jsxs("pre",{className:"bg-black/50 p-4 rounded text-sm text-red-300 overflow-auto max-h-64",children:[(s=this.state.error)==null?void 0:s.message,`

`,(r=this.state.error)==null?void 0:r.stack]}),t.jsx("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Page"})]})}):this.props.children}}Zi.createRoot(document.getElementById("root")).render(t.jsx(bs.StrictMode,{children:t.jsx(Ij,{children:t.jsx(Dj,{})})}));
