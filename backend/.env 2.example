# ============================================================================
# NiksES - Complete Environment Configuration
# ============================================================================
# Copy this file to .env and fill in your API keys
# 
# Required: OPENAI_API_KEY (for AI-powered analysis)
# Recommended: VIRUSTOTAL_API_KEY, ABUSEIPDB_API_KEY
# Optional: Others enhance functionality but aren't required
# ============================================================================

# ============================================================================
# AI CONFIGURATION (Required for Enhanced Analysis)
# ============================================================================

# OpenAI API Key - REQUIRED for SE analysis & content deconstruction
# Get from: https://platform.openai.com/api-keys
# Cost: ~$0.001-0.01 per email analysis (using gpt-4o-mini)
OPENAI_API_KEY=sk-your-openai-api-key-here

# AI Settings
AI_ENABLED=true
AI_PROVIDER=openai
AI_MODEL=gpt-4o-mini
AI_MAX_TOKENS=1000
AI_TEMPERATURE=0.3

# Alternative: Anthropic Claude (if you prefer)
# ANTHROPIC_API_KEY=sk-ant-your-anthropic-key-here

# ============================================================================
# THREAT INTELLIGENCE APIs (Recommended)
# ============================================================================

# VirusTotal - URL/Domain/IP/Hash reputation
# Get from: https://www.virustotal.com/gui/my-apikey
# Free tier: 4 requests/minute, 500/day
VIRUSTOTAL_API_KEY=your-virustotal-api-key-here

# AbuseIPDB - IP reputation & abuse reports
# Get from: https://www.abuseipdb.com/account/api
# Free tier: 1,000 checks/day
ABUSEIPDB_API_KEY=your-abuseipdb-api-key-here

# URLhaus - Malware URL database (FREE - NO KEY NEEDED)
# Automatically enabled, no configuration required
# API: https://urlhaus-api.abuse.ch/

# ============================================================================
# OPTIONAL THREAT INTELLIGENCE APIs
# ============================================================================

# PhishTank - Phishing URL database
# Get from: https://phishtank.org/api_info.php
# Free tier: Requires registration
PHISHTANK_API_KEY=

# MXToolbox - Email/DNS diagnostics
# Get from: https://mxtoolbox.com/User/Api/Usage.aspx
# Free tier: Limited requests
MXTOOLBOX_API_KEY=

# Shodan - Internet-connected device search
# Get from: https://account.shodan.io/
# Free tier: Limited API access
SHODAN_API_KEY=

# GreyNoise - Internet scanner/noise detection
# Get from: https://viz.greynoise.io/account/api-key
# Free tier: 50 queries/day
GREYNOISE_API_KEY=

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Secret key for encryption (generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-generate-with-openssl-rand-hex-32

# Debug mode (set to false in production)
DEBUG=true

# Log level: DEBUG, INFO, WARNING, ERROR
LOG_LEVEL=INFO

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# SQLite (default) - no configuration needed
DATABASE_URL=sqlite:///./data/nikses.db

# PostgreSQL (optional, for production)
# DATABASE_URL=postgresql://user:password@localhost:5432/nikses

# ============================================================================
# SERVER CONFIGURATION
# ============================================================================

# API Host & Port
API_HOST=0.0.0.0
API_PORT=8000

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173,http://127.0.0.1:5173

# ============================================================================
# RATE LIMITING & TIMEOUTS
# ============================================================================

# API timeout for enrichment calls (seconds)
API_TIMEOUT_ENRICHMENT=15

# Max retries for failed API calls
API_MAX_RETRIES=4

# Rate limits (requests per minute)
VIRUSTOTAL_RATE_LIMIT=4
ABUSEIPDB_RATE_LIMIT=60

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/disable specific features
ENABLE_TI_ENRICHMENT=true
ENABLE_AI_ANALYSIS=true
ENABLE_LOOKALIKE_DETECTION=true
ENABLE_BRAND_IMPERSONATION=true

# ============================================================================
# FILE UPLOAD SETTINGS
# ============================================================================

# Maximum upload size (bytes) - 25MB default
MAX_UPLOAD_SIZE=26214400

# Allowed file extensions
ALLOWED_EXTENSIONS=.eml,.msg,.txt

# ============================================================================
# EXPORT SETTINGS
# ============================================================================

# Default export format: json, csv, pdf, stix
DEFAULT_EXPORT_FORMAT=json

# Include raw headers in exports
EXPORT_INCLUDE_RAW_HEADERS=true
